ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 1


   1              		.cpu cortex-m3
   2              		.arch armv7-m
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"sd.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.Error,"ax",%progbits
  18              		.align	1
  19              		.syntax unified
  20              		.thumb
  21              		.thumb_func
  23              	Error:
  24              	.LFB65:
  25              		.file 1 "Core/Src/sd.c"
   1:Core/Src/sd.c **** /* --COPYRIGHT--,
   2:Core/Src/sd.c ****  * Copyright (c) 2018, TAPIT Co., Ltd.
   3:Core/Src/sd.c ****  * http://tapit.vn
   4:Core/Src/sd.c ****  *
   5:Core/Src/sd.c ****  ********************************Edit SD library**********************************
   6:Core/Src/sd.c ****  *  Description: Add some functions:
   7:Core/Src/sd.c ****  *  void SD_creatSubDir(char* filename);
   8:Core/Src/sd.c **** 		void SD_deleteFile(char* filename);
   9:Core/Src/sd.c **** 		void SD_deleteFolder(char* foldername);
  10:Core/Src/sd.c **** 		void SD_deleteAllFile(void);
  11:Core/Src/sd.c **** 		int32_t getFileSize(char* filename);
  12:Core/Src/sd.c ****  *  Version:  	1.0
  13:Core/Src/sd.c ****  *  Author: 	Tran Thuy Ngoc Hang
  14:Core/Src/sd.c ****  *  Release: 	November 15, 2018
  15:Core/Src/sd.c ****  *  Built with CubeMX Version 4.23.0 and Keil uVision5
  16:Core/Src/sd.c ****  *********************************************************************************
  17:Core/Src/sd.c ****  */
  18:Core/Src/sd.c **** #include "sd.h"
  19:Core/Src/sd.c **** #include "string.h"
  20:Core/Src/sd.c **** //--------------------------------------------------
  21:Core/Src/sd.c **** // Definitions for MMC/SDC command
  22:Core/Src/sd.c **** #define CMD0 (0x40+0) // GO_IDLE_STATE
  23:Core/Src/sd.c **** #define CMD1 (0x40+1) // SEND_OP_COND (MMC)
  24:Core/Src/sd.c **** #define ACMD41 (0xC0+41) // SEND_OP_COND (SDC)
  25:Core/Src/sd.c **** #define CMD8 (0x40+8) // SEND_IF_COND
  26:Core/Src/sd.c **** #define CMD9 (0x40+9) // SEND_CSD
  27:Core/Src/sd.c **** #define CMD16 (0x40+16) // SET_BLOCKLEN
  28:Core/Src/sd.c **** #define CMD17 (0x40+17) // READ_SINGLE_BLOCK
  29:Core/Src/sd.c **** #define CMD24 (0x40+24) // WRITE_BLOCK
  30:Core/Src/sd.c **** #define CMD55 (0x40+55) // APP_CMD
  31:Core/Src/sd.c **** #define CMD58 (0x40+58) // READ_OCR
  32:Core/Src/sd.c **** //--------------------------------------------------
  33:Core/Src/sd.c **** extern SPI_HandleTypeDef hspi1;
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 2


  34:Core/Src/sd.c **** extern UART_HandleTypeDef huart2;
  35:Core/Src/sd.c **** extern volatile uint16_t Timer1;
  36:Core/Src/sd.c **** sd_info_ptr sdinfo;
  37:Core/Src/sd.c **** //-------------------------------------------------- Delecrare variable
  38:Core/Src/sd.c **** 
  39:Core/Src/sd.c **** extern char USER_Path[4]; /* logical drive path */
  40:Core/Src/sd.c **** extern struct sd_data SD;
  41:Core/Src/sd.c **** FATFS SDFatFs; //File system object structure (FATFS)
  42:Core/Src/sd.c **** FATFS *fs;		 //File system object structure (FATFS)
  43:Core/Src/sd.c **** FIL MyFile;    //File object structure (FIL)
  44:Core/Src/sd.c **** FIL MyFile;    //File object structure (FIL)
  45:Core/Src/sd.c **** //-------------------------------------------------- main
  46:Core/Src/sd.c **** 	char str1[60]={0};
  47:Core/Src/sd.c **** 	//Mang read long file
  48:Core/Src/sd.c **** 	uint8_t sect[512];
  49:Core/Src/sd.c **** 	uint32_t byteswritten, bytesread;; //byte doc va ghi
  50:Core/Src/sd.c **** 	uint8_t result;
  51:Core/Src/sd.c **** 	uint16_t i;
  52:Core/Src/sd.c **** 	//------------------------------------------------------List file
  53:Core/Src/sd.c **** 	FRESULT res; //result
  54:Core/Src/sd.c **** 	FILINFO fileInfo;	/* File information structure (FILINFO) */
  55:Core/Src/sd.c **** 	char *fn;
  56:Core/Src/sd.c **** 	DIR dir;  /* Directory object structure (DIR) */
  57:Core/Src/sd.c **** 	//Kiem tra dung luong cua the
  58:Core/Src/sd.c **** 	DWORD fre_clust, fre_sect, tot_sect;
  59:Core/Src/sd.c **** //-------------------------------------------------- 
  60:Core/Src/sd.c **** static void Error (void)
  61:Core/Src/sd.c **** {
  26              		.loc 1 61 1 view -0
  27              		.cfi_startproc
  28              		@ args = 0, pretend = 0, frame = 0
  29              		@ frame_needed = 0, uses_anonymous_args = 0
  30 0000 08B5     		push	{r3, lr}
  31              	.LCFI0:
  32              		.cfi_def_cfa_offset 8
  33              		.cfi_offset 3, -8
  34              		.cfi_offset 14, -4
  62:Core/Src/sd.c ****   LD_ON;
  35              		.loc 1 62 3 view .LVU1
  36 0002 0022     		movs	r2, #0
  37 0004 4FF40051 		mov	r1, #8192
  38 0008 0148     		ldr	r0, .L3
  39 000a FFF7FEFF 		bl	HAL_GPIO_WritePin
  40              	.LVL0:
  41              		.loc 1 62 8 view .LVU2
  63:Core/Src/sd.c **** }
  42              		.loc 1 63 1 is_stmt 0 view .LVU3
  43 000e 08BD     		pop	{r3, pc}
  44              	.L4:
  45              		.align	2
  46              	.L3:
  47 0010 00100140 		.word	1073811456
  48              		.cfi_endproc
  49              	.LFE65:
  51              		.section	.text.SPIx_WriteRead,"ax",%progbits
  52              		.align	1
  53              		.global	SPIx_WriteRead
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 3


  54              		.syntax unified
  55              		.thumb
  56              		.thumb_func
  58              	SPIx_WriteRead:
  59              	.LVL1:
  60              	.LFB66:
  64:Core/Src/sd.c **** //----------------------------------------------- Ham ghi, doc du lieu tren bus SPI
  65:Core/Src/sd.c **** uint8_t SPIx_WriteRead(uint8_t Byte)
  66:Core/Src/sd.c **** {
  61              		.loc 1 66 1 is_stmt 1 view -0
  62              		.cfi_startproc
  63              		@ args = 0, pretend = 0, frame = 16
  64              		@ frame_needed = 0, uses_anonymous_args = 0
  65              		.loc 1 66 1 is_stmt 0 view .LVU5
  66 0000 00B5     		push	{lr}
  67              	.LCFI1:
  68              		.cfi_def_cfa_offset 4
  69              		.cfi_offset 14, -4
  70 0002 87B0     		sub	sp, sp, #28
  71              	.LCFI2:
  72              		.cfi_def_cfa_offset 32
  73 0004 8DF80F00 		strb	r0, [sp, #15]
  67:Core/Src/sd.c ****   uint8_t receivedbyte = 0;
  74              		.loc 1 67 3 is_stmt 1 view .LVU6
  75              		.loc 1 67 11 is_stmt 0 view .LVU7
  76 0008 0023     		movs	r3, #0
  77 000a 8DF81730 		strb	r3, [sp, #23]
  68:Core/Src/sd.c ****   if(HAL_SPI_TransmitReceive(&hspi1,(uint8_t*) &Byte,(uint8_t*) &receivedbyte,1,0x1000)!=HAL_OK)
  78              		.loc 1 68 3 is_stmt 1 view .LVU8
  79              		.loc 1 68 6 is_stmt 0 view .LVU9
  80 000e 4FF48053 		mov	r3, #4096
  81 0012 0093     		str	r3, [sp]
  82 0014 0123     		movs	r3, #1
  83 0016 0DF11702 		add	r2, sp, #23
  84 001a 0DF10F01 		add	r1, sp, #15
  85 001e 0648     		ldr	r0, .L9
  86              	.LVL2:
  87              		.loc 1 68 6 view .LVU10
  88 0020 FFF7FEFF 		bl	HAL_SPI_TransmitReceive
  89              	.LVL3:
  90              		.loc 1 68 5 view .LVU11
  91 0024 20B9     		cbnz	r0, .L8
  92              	.L6:
  69:Core/Src/sd.c ****   {
  70:Core/Src/sd.c ****     Error();
  71:Core/Src/sd.c ****   }
  72:Core/Src/sd.c ****   return receivedbyte;
  93              		.loc 1 72 3 is_stmt 1 view .LVU12
  73:Core/Src/sd.c **** }
  94              		.loc 1 73 1 is_stmt 0 view .LVU13
  95 0026 9DF81700 		ldrb	r0, [sp, #23]	@ zero_extendqisi2
  96 002a 07B0     		add	sp, sp, #28
  97              	.LCFI3:
  98              		.cfi_remember_state
  99              		.cfi_def_cfa_offset 4
 100              		@ sp needed
 101 002c 5DF804FB 		ldr	pc, [sp], #4
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 4


 102              	.L8:
 103              	.LCFI4:
 104              		.cfi_restore_state
  70:Core/Src/sd.c ****   }
 105              		.loc 1 70 5 is_stmt 1 view .LVU14
 106 0030 FFF7FEFF 		bl	Error
 107              	.LVL4:
 108 0034 F7E7     		b	.L6
 109              	.L10:
 110 0036 00BF     		.align	2
 111              	.L9:
 112 0038 00000000 		.word	hspi1
 113              		.cfi_endproc
 114              	.LFE66:
 116              		.section	.text.SPI_SendByte,"ax",%progbits
 117              		.align	1
 118              		.global	SPI_SendByte
 119              		.syntax unified
 120              		.thumb
 121              		.thumb_func
 123              	SPI_SendByte:
 124              	.LVL5:
 125              	.LFB67:
  74:Core/Src/sd.c **** //----------------------------------------------- Ham truyen 1byte du lieu tren bus SPI
  75:Core/Src/sd.c **** void SPI_SendByte(uint8_t bt)
  76:Core/Src/sd.c **** {
 126              		.loc 1 76 1 view -0
 127              		.cfi_startproc
 128              		@ args = 0, pretend = 0, frame = 0
 129              		@ frame_needed = 0, uses_anonymous_args = 0
 130              		.loc 1 76 1 is_stmt 0 view .LVU16
 131 0000 08B5     		push	{r3, lr}
 132              	.LCFI5:
 133              		.cfi_def_cfa_offset 8
 134              		.cfi_offset 3, -8
 135              		.cfi_offset 14, -4
  77:Core/Src/sd.c ****   SPIx_WriteRead(bt);
 136              		.loc 1 77 3 is_stmt 1 view .LVU17
 137 0002 FFF7FEFF 		bl	SPIx_WriteRead
 138              	.LVL6:
  78:Core/Src/sd.c **** }
 139              		.loc 1 78 1 is_stmt 0 view .LVU18
 140 0006 08BD     		pop	{r3, pc}
 141              		.cfi_endproc
 142              	.LFE67:
 144              		.section	.text.SPI_ReceiveByte,"ax",%progbits
 145              		.align	1
 146              		.global	SPI_ReceiveByte
 147              		.syntax unified
 148              		.thumb
 149              		.thumb_func
 151              	SPI_ReceiveByte:
 152              	.LFB68:
  79:Core/Src/sd.c **** //----------------------------------------------- Ham nhan 1byte du lieu tren bus SPI
  80:Core/Src/sd.c **** uint8_t SPI_ReceiveByte(void)
  81:Core/Src/sd.c **** {
 153              		.loc 1 81 1 is_stmt 1 view -0
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 5


 154              		.cfi_startproc
 155              		@ args = 0, pretend = 0, frame = 0
 156              		@ frame_needed = 0, uses_anonymous_args = 0
 157 0000 08B5     		push	{r3, lr}
 158              	.LCFI6:
 159              		.cfi_def_cfa_offset 8
 160              		.cfi_offset 3, -8
 161              		.cfi_offset 14, -4
  82:Core/Src/sd.c ****   uint8_t bt = SPIx_WriteRead(0xFF);
 162              		.loc 1 82 3 view .LVU20
 163              		.loc 1 82 16 is_stmt 0 view .LVU21
 164 0002 FF20     		movs	r0, #255
 165 0004 FFF7FEFF 		bl	SPIx_WriteRead
 166              	.LVL7:
  83:Core/Src/sd.c ****   return bt;
 167              		.loc 1 83 3 is_stmt 1 view .LVU22
  84:Core/Src/sd.c **** }
 168              		.loc 1 84 1 is_stmt 0 view .LVU23
 169 0008 08BD     		pop	{r3, pc}
 170              		.cfi_endproc
 171              	.LFE68:
 173              		.section	.text.SD_cmd,"ax",%progbits
 174              		.align	1
 175              		.syntax unified
 176              		.thumb
 177              		.thumb_func
 179              	SD_cmd:
 180              	.LVL8:
 181              	.LFB71:
  85:Core/Src/sd.c **** //-----------------------------------------------
  86:Core/Src/sd.c **** void SPI_Release(void)
  87:Core/Src/sd.c **** {
  88:Core/Src/sd.c ****   SPIx_WriteRead(0xFF);
  89:Core/Src/sd.c **** }
  90:Core/Src/sd.c **** //-----------------------------------------------
  91:Core/Src/sd.c **** uint8_t SPI_wait_ready(void)
  92:Core/Src/sd.c **** {
  93:Core/Src/sd.c ****   uint8_t res;
  94:Core/Src/sd.c ****   uint16_t cnt;
  95:Core/Src/sd.c ****   cnt=0;
  96:Core/Src/sd.c ****   do {
  97:Core/Src/sd.c ****     res=SPI_ReceiveByte();
  98:Core/Src/sd.c ****     cnt++;
  99:Core/Src/sd.c ****   } while ( (res!=0xFF)&&(cnt<0xFFFF) );
 100:Core/Src/sd.c ****   if (cnt>=0xFFFF) return 1;
 101:Core/Src/sd.c ****   return res;
 102:Core/Src/sd.c **** }
 103:Core/Src/sd.c **** /*
 104:Core/Src/sd.c **** 	Cau lenh goi theo format of CMD8 - 48bit - 6bytes
 105:Core/Src/sd.c **** */
 106:Core/Src/sd.c **** //----------------------------------------------- Goi 1 lenh den 
 107:Core/Src/sd.c **** static uint8_t SD_cmd (uint8_t cmd, uint32_t arg)
 108:Core/Src/sd.c **** {
 182              		.loc 1 108 1 is_stmt 1 view -0
 183              		.cfi_startproc
 184              		@ args = 0, pretend = 0, frame = 0
 185              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 6


 186              		.loc 1 108 1 is_stmt 0 view .LVU25
 187 0000 70B5     		push	{r4, r5, r6, lr}
 188              	.LCFI7:
 189              		.cfi_def_cfa_offset 16
 190              		.cfi_offset 4, -16
 191              		.cfi_offset 5, -12
 192              		.cfi_offset 6, -8
 193              		.cfi_offset 14, -4
 194 0002 0446     		mov	r4, r0
 195 0004 0D46     		mov	r5, r1
 109:Core/Src/sd.c ****   uint8_t n, res;
 196              		.loc 1 109 3 is_stmt 1 view .LVU26
 110:Core/Src/sd.c **** 	//Phan biet lenh ACMD hay lenh CMD
 111:Core/Src/sd.c **** 	// ACMD<n> is the command sequense of CMD55-CMD<n>
 112:Core/Src/sd.c **** 	if (cmd & 0x80)
 197              		.loc 1 112 2 view .LVU27
 198              		.loc 1 112 5 is_stmt 0 view .LVU28
 199 0006 10F0800F 		tst	r0, #128
 200 000a 31D1     		bne	.L24
 201              	.LVL9:
 202              	.L16:
 113:Core/Src/sd.c **** 	{
 114:Core/Src/sd.c **** 		cmd &= 0x7F;
 115:Core/Src/sd.c **** 		res = SD_cmd(CMD55, 0);
 116:Core/Src/sd.c **** 		if (res > 1) return res;
 117:Core/Src/sd.c **** 	}
 118:Core/Src/sd.c **** 	// Select the card
 119:Core/Src/sd.c **** 	SS_SD_DESELECT();
 203              		.loc 1 119 2 is_stmt 1 view .LVU29
 204 000c 1F4E     		ldr	r6, .L26
 205 000e 0122     		movs	r2, #1
 206 0010 0821     		movs	r1, #8
 207 0012 3046     		mov	r0, r6
 208 0014 FFF7FEFF 		bl	HAL_GPIO_WritePin
 209              	.LVL10:
 120:Core/Src/sd.c **** 	SPI_ReceiveByte();
 210              		.loc 1 120 2 view .LVU30
 211 0018 FFF7FEFF 		bl	SPI_ReceiveByte
 212              	.LVL11:
 121:Core/Src/sd.c **** 	SS_SD_SELECT();
 213              		.loc 1 121 2 view .LVU31
 214 001c 0022     		movs	r2, #0
 215 001e 0821     		movs	r1, #8
 216 0020 3046     		mov	r0, r6
 217 0022 FFF7FEFF 		bl	HAL_GPIO_WritePin
 218              	.LVL12:
 122:Core/Src/sd.c **** 	SPI_ReceiveByte();
 219              		.loc 1 122 2 view .LVU32
 220 0026 FFF7FEFF 		bl	SPI_ReceiveByte
 221              	.LVL13:
 123:Core/Src/sd.c **** 	// Send a command packet
 124:Core/Src/sd.c **** 	SPI_SendByte(cmd); // Start + Command index
 222              		.loc 1 124 2 view .LVU33
 223 002a 2046     		mov	r0, r4
 224 002c FFF7FEFF 		bl	SPI_SendByte
 225              	.LVL14:
 125:Core/Src/sd.c **** 	SPI_SendByte((uint8_t)(arg >> 24)); // Argument[31..24]
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 7


 226              		.loc 1 125 2 view .LVU34
 227 0030 280E     		lsrs	r0, r5, #24
 228 0032 FFF7FEFF 		bl	SPI_SendByte
 229              	.LVL15:
 126:Core/Src/sd.c **** 	SPI_SendByte((uint8_t)(arg >> 16)); // Argument[23..16]
 230              		.loc 1 126 2 view .LVU35
 231 0036 C5F30740 		ubfx	r0, r5, #16, #8
 232 003a FFF7FEFF 		bl	SPI_SendByte
 233              	.LVL16:
 127:Core/Src/sd.c **** 	SPI_SendByte((uint8_t)(arg >> 8)); // Argument[15..8]
 234              		.loc 1 127 2 view .LVU36
 235 003e C5F30720 		ubfx	r0, r5, #8, #8
 236 0042 FFF7FEFF 		bl	SPI_SendByte
 237              	.LVL17:
 128:Core/Src/sd.c **** 	SPI_SendByte((uint8_t)arg); // Argument[7..0]
 238              		.loc 1 128 2 view .LVU37
 239 0046 E8B2     		uxtb	r0, r5
 240 0048 FFF7FEFF 		bl	SPI_SendByte
 241              	.LVL18:
 129:Core/Src/sd.c **** 	n = 0x01; // Dummy CRC + Stop
 242              		.loc 1 129 2 view .LVU38
 130:Core/Src/sd.c **** 	//Cyclic Redundancy Check: Ham bam phat sinh kiem thu cho chuoi bit
 131:Core/Src/sd.c **** 	if (cmd == CMD0) {n = 0x95;} // Valid CRC for CMD0(0)
 243              		.loc 1 131 2 view .LVU39
 244              		.loc 1 131 5 is_stmt 0 view .LVU40
 245 004c 402C     		cmp	r4, #64
 246 004e 18D0     		beq	.L21
 129:Core/Src/sd.c **** 	n = 0x01; // Dummy CRC + Stop
 247              		.loc 1 129 4 view .LVU41
 248 0050 0120     		movs	r0, #1
 249              	.L18:
 250              	.LVL19:
 132:Core/Src/sd.c **** 	if (cmd == CMD8) {n = 0x87;} // Valid CRC for CMD8(0x1AA)
 251              		.loc 1 132 2 is_stmt 1 view .LVU42
 252              		.loc 1 132 5 is_stmt 0 view .LVU43
 253 0052 482C     		cmp	r4, #72
 254 0054 17D0     		beq	.L25
 255              	.LVL20:
 256              	.L19:
 133:Core/Src/sd.c **** 	SPI_SendByte(n);	
 257              		.loc 1 133 2 is_stmt 1 view .LVU44
 258 0056 FFF7FEFF 		bl	SPI_SendByte
 259              	.LVL21:
 134:Core/Src/sd.c ****   // Receive a command response
 135:Core/Src/sd.c ****   n = 10; // Wait for a valid response in timeout of 10 attempts
 260              		.loc 1 135 3 view .LVU45
 261              		.loc 1 135 5 is_stmt 0 view .LVU46
 262 005a 0A24     		movs	r4, #10
 263              	.LVL22:
 264              	.L20:
 136:Core/Src/sd.c ****   do {
 265              		.loc 1 136 3 is_stmt 1 discriminator 2 view .LVU47
 137:Core/Src/sd.c ****     res = SPI_ReceiveByte();
 266              		.loc 1 137 5 discriminator 2 view .LVU48
 267              		.loc 1 137 11 is_stmt 0 discriminator 2 view .LVU49
 268 005c FFF7FEFF 		bl	SPI_ReceiveByte
 269              	.LVL23:
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 8


 138:Core/Src/sd.c ****   } while ((res & 0x80) && --n);
 270              		.loc 1 138 11 is_stmt 1 discriminator 2 view .LVU50
 271              		.loc 1 138 3 is_stmt 0 discriminator 2 view .LVU51
 272 0060 10F0800F 		tst	r0, #128
 273 0064 03D0     		beq	.L17
 274              		.loc 1 138 25 discriminator 1 view .LVU52
 275 0066 631E     		subs	r3, r4, #1
 276              	.LVL24:
 277              		.loc 1 138 25 discriminator 1 view .LVU53
 278 0068 13F0FF04 		ands	r4, r3, #255
 279 006c F6D1     		bne	.L20
 280              	.LVL25:
 281              	.L17:
 139:Core/Src/sd.c ****   return res;
 140:Core/Src/sd.c **** }
 282              		.loc 1 140 1 view .LVU54
 283 006e 70BD     		pop	{r4, r5, r6, pc}
 284              	.LVL26:
 285              	.L24:
 114:Core/Src/sd.c **** 		res = SD_cmd(CMD55, 0);
 286              		.loc 1 114 3 is_stmt 1 view .LVU55
 114:Core/Src/sd.c **** 		res = SD_cmd(CMD55, 0);
 287              		.loc 1 114 7 is_stmt 0 view .LVU56
 288 0070 00F07F04 		and	r4, r0, #127
 289              	.LVL27:
 115:Core/Src/sd.c **** 		if (res > 1) return res;
 290              		.loc 1 115 3 is_stmt 1 view .LVU57
 115:Core/Src/sd.c **** 		if (res > 1) return res;
 291              		.loc 1 115 9 is_stmt 0 view .LVU58
 292 0074 0021     		movs	r1, #0
 293              	.LVL28:
 115:Core/Src/sd.c **** 		if (res > 1) return res;
 294              		.loc 1 115 9 view .LVU59
 295 0076 7720     		movs	r0, #119
 296 0078 FFF7C2FF 		bl	SD_cmd
 297              	.LVL29:
 116:Core/Src/sd.c **** 	}
 298              		.loc 1 116 3 is_stmt 1 view .LVU60
 116:Core/Src/sd.c **** 	}
 299              		.loc 1 116 6 is_stmt 0 view .LVU61
 300 007c 0128     		cmp	r0, #1
 301 007e C5D9     		bls	.L16
 302 0080 F5E7     		b	.L17
 303              	.LVL30:
 304              	.L21:
 131:Core/Src/sd.c **** 	if (cmd == CMD8) {n = 0x87;} // Valid CRC for CMD8(0x1AA)
 305              		.loc 1 131 22 view .LVU62
 306 0082 9520     		movs	r0, #149
 307 0084 E5E7     		b	.L18
 308              	.LVL31:
 309              	.L25:
 132:Core/Src/sd.c **** 	SPI_SendByte(n);	
 310              		.loc 1 132 22 view .LVU63
 311 0086 8720     		movs	r0, #135
 312              	.LVL32:
 132:Core/Src/sd.c **** 	SPI_SendByte(n);	
 313              		.loc 1 132 22 view .LVU64
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 9


 314 0088 E5E7     		b	.L19
 315              	.L27:
 316 008a 00BF     		.align	2
 317              	.L26:
 318 008c 00080140 		.word	1073809408
 319              		.cfi_endproc
 320              	.LFE71:
 322              		.section	.text.SPI_Release,"ax",%progbits
 323              		.align	1
 324              		.global	SPI_Release
 325              		.syntax unified
 326              		.thumb
 327              		.thumb_func
 329              	SPI_Release:
 330              	.LFB69:
  87:Core/Src/sd.c ****   SPIx_WriteRead(0xFF);
 331              		.loc 1 87 1 is_stmt 1 view -0
 332              		.cfi_startproc
 333              		@ args = 0, pretend = 0, frame = 0
 334              		@ frame_needed = 0, uses_anonymous_args = 0
 335 0000 08B5     		push	{r3, lr}
 336              	.LCFI8:
 337              		.cfi_def_cfa_offset 8
 338              		.cfi_offset 3, -8
 339              		.cfi_offset 14, -4
  88:Core/Src/sd.c **** }
 340              		.loc 1 88 3 view .LVU66
 341 0002 FF20     		movs	r0, #255
 342 0004 FFF7FEFF 		bl	SPIx_WriteRead
 343              	.LVL33:
  89:Core/Src/sd.c **** //-----------------------------------------------
 344              		.loc 1 89 1 is_stmt 0 view .LVU67
 345 0008 08BD     		pop	{r3, pc}
 346              		.cfi_endproc
 347              	.LFE69:
 349              		.section	.text.SPI_wait_ready,"ax",%progbits
 350              		.align	1
 351              		.global	SPI_wait_ready
 352              		.syntax unified
 353              		.thumb
 354              		.thumb_func
 356              	SPI_wait_ready:
 357              	.LFB70:
  92:Core/Src/sd.c ****   uint8_t res;
 358              		.loc 1 92 1 is_stmt 1 view -0
 359              		.cfi_startproc
 360              		@ args = 0, pretend = 0, frame = 0
 361              		@ frame_needed = 0, uses_anonymous_args = 0
 362 0000 10B5     		push	{r4, lr}
 363              	.LCFI9:
 364              		.cfi_def_cfa_offset 8
 365              		.cfi_offset 4, -8
 366              		.cfi_offset 14, -4
  93:Core/Src/sd.c ****   uint16_t cnt;
 367              		.loc 1 93 3 view .LVU69
  94:Core/Src/sd.c ****   cnt=0;
 368              		.loc 1 94 3 view .LVU70
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 10


  95:Core/Src/sd.c ****   do {
 369              		.loc 1 95 3 view .LVU71
 370              	.LVL34:
  95:Core/Src/sd.c ****   do {
 371              		.loc 1 95 6 is_stmt 0 view .LVU72
 372 0002 0024     		movs	r4, #0
 373              	.LVL35:
 374              	.L32:
  96:Core/Src/sd.c ****     res=SPI_ReceiveByte();
 375              		.loc 1 96 3 is_stmt 1 discriminator 2 view .LVU73
  97:Core/Src/sd.c ****     cnt++;
 376              		.loc 1 97 5 discriminator 2 view .LVU74
  97:Core/Src/sd.c ****     cnt++;
 377              		.loc 1 97 9 is_stmt 0 discriminator 2 view .LVU75
 378 0004 FFF7FEFF 		bl	SPI_ReceiveByte
 379              	.LVL36:
  98:Core/Src/sd.c ****   } while ( (res!=0xFF)&&(cnt<0xFFFF) );
 380              		.loc 1 98 5 is_stmt 1 discriminator 2 view .LVU76
  98:Core/Src/sd.c ****   } while ( (res!=0xFF)&&(cnt<0xFFFF) );
 381              		.loc 1 98 8 is_stmt 0 discriminator 2 view .LVU77
 382 0008 0134     		adds	r4, r4, #1
 383              	.LVL37:
  98:Core/Src/sd.c ****   } while ( (res!=0xFF)&&(cnt<0xFFFF) );
 384              		.loc 1 98 8 discriminator 2 view .LVU78
 385 000a A4B2     		uxth	r4, r4
 386              	.LVL38:
  99:Core/Src/sd.c ****   if (cnt>=0xFFFF) return 1;
 387              		.loc 1 99 11 is_stmt 1 discriminator 2 view .LVU79
  99:Core/Src/sd.c ****   if (cnt>=0xFFFF) return 1;
 388              		.loc 1 99 3 is_stmt 0 discriminator 2 view .LVU80
 389 000c FF28     		cmp	r0, #255
 390 000e 03D0     		beq	.L31
  99:Core/Src/sd.c ****   if (cnt>=0xFFFF) return 1;
 391              		.loc 1 99 24 discriminator 1 view .LVU81
 392 0010 4FF6FF73 		movw	r3, #65535
 393 0014 9C42     		cmp	r4, r3
 394 0016 F5D1     		bne	.L32
 395              	.L31:
 100:Core/Src/sd.c ****   return res;
 396              		.loc 1 100 3 is_stmt 1 view .LVU82
 100:Core/Src/sd.c ****   return res;
 397              		.loc 1 100 6 is_stmt 0 view .LVU83
 398 0018 4FF6FF73 		movw	r3, #65535
 399 001c 9C42     		cmp	r4, r3
 400 001e 00D0     		beq	.L36
 401              	.LVL39:
 402              	.L33:
 102:Core/Src/sd.c **** /*
 403              		.loc 1 102 1 view .LVU84
 404 0020 10BD     		pop	{r4, pc}
 405              	.LVL40:
 406              	.L36:
 100:Core/Src/sd.c ****   return res;
 407              		.loc 1 100 27 view .LVU85
 408 0022 0120     		movs	r0, #1
 409              	.LVL41:
 100:Core/Src/sd.c ****   return res;
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 11


 410              		.loc 1 100 27 view .LVU86
 411 0024 FCE7     		b	.L33
 412              		.cfi_endproc
 413              	.LFE70:
 415              		.section	.text.SD_PowerOn,"ax",%progbits
 416              		.align	1
 417              		.global	SD_PowerOn
 418              		.syntax unified
 419              		.thumb
 420              		.thumb_func
 422              	SD_PowerOn:
 423              	.LFB72:
 141:Core/Src/sd.c **** //-----------------------------------------------
 142:Core/Src/sd.c **** void SD_PowerOn(void)
 143:Core/Src/sd.c **** {
 424              		.loc 1 143 1 is_stmt 1 view -0
 425              		.cfi_startproc
 426              		@ args = 0, pretend = 0, frame = 0
 427              		@ frame_needed = 0, uses_anonymous_args = 0
 428              		@ link register save eliminated.
 144:Core/Src/sd.c ****   Timer1 = 0;
 429              		.loc 1 144 3 view .LVU88
 430              		.loc 1 144 10 is_stmt 0 view .LVU89
 431 0000 044B     		ldr	r3, .L39
 432 0002 0022     		movs	r2, #0
 433 0004 1A80     		strh	r2, [r3]	@ movhi
 145:Core/Src/sd.c ****   while(Timer1<2) //cho 20mili giay, de on dinh dien ap
 434              		.loc 1 145 3 is_stmt 1 view .LVU90
 435              	.L38:
 146:Core/Src/sd.c ****     ;
 436              		.loc 1 146 5 discriminator 1 view .LVU91
 145:Core/Src/sd.c ****   while(Timer1<2) //cho 20mili giay, de on dinh dien ap
 437              		.loc 1 145 8 discriminator 1 view .LVU92
 145:Core/Src/sd.c ****   while(Timer1<2) //cho 20mili giay, de on dinh dien ap
 438              		.loc 1 145 15 is_stmt 0 discriminator 1 view .LVU93
 439 0006 034B     		ldr	r3, .L39
 440 0008 1B88     		ldrh	r3, [r3]
 441 000a 9BB2     		uxth	r3, r3
 145:Core/Src/sd.c ****   while(Timer1<2) //cho 20mili giay, de on dinh dien ap
 442              		.loc 1 145 8 discriminator 1 view .LVU94
 443 000c 012B     		cmp	r3, #1
 444 000e FAD9     		bls	.L38
 147:Core/Src/sd.c **** }
 445              		.loc 1 147 1 view .LVU95
 446 0010 7047     		bx	lr
 447              	.L40:
 448 0012 00BF     		.align	2
 449              	.L39:
 450 0014 00000000 		.word	Timer1
 451              		.cfi_endproc
 452              	.LFE72:
 454              		.section	.text.SD_Read_Block,"ax",%progbits
 455              		.align	1
 456              		.global	SD_Read_Block
 457              		.syntax unified
 458              		.thumb
 459              		.thumb_func
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 12


 461              	SD_Read_Block:
 462              	.LVL42:
 463              	.LFB73:
 148:Core/Src/sd.c **** //-----------------------------------------------
 149:Core/Src/sd.c **** uint8_t SD_Read_Block (uint8_t *buff, uint32_t lba)
 150:Core/Src/sd.c **** {
 464              		.loc 1 150 1 is_stmt 1 view -0
 465              		.cfi_startproc
 466              		@ args = 0, pretend = 0, frame = 0
 467              		@ frame_needed = 0, uses_anonymous_args = 0
 468              		.loc 1 150 1 is_stmt 0 view .LVU97
 469 0000 70B5     		push	{r4, r5, r6, lr}
 470              	.LCFI10:
 471              		.cfi_def_cfa_offset 16
 472              		.cfi_offset 4, -16
 473              		.cfi_offset 5, -12
 474              		.cfi_offset 6, -8
 475              		.cfi_offset 14, -4
 476 0002 0546     		mov	r5, r0
 151:Core/Src/sd.c ****   uint8_t result;
 477              		.loc 1 151 3 is_stmt 1 view .LVU98
 152:Core/Src/sd.c ****   uint16_t cnt;
 478              		.loc 1 152 3 view .LVU99
 153:Core/Src/sd.c **** 	result=SD_cmd (CMD17, lba); //CMD17 datasheet trang 50 -> 96
 479              		.loc 1 153 2 view .LVU100
 480              		.loc 1 153 9 is_stmt 0 view .LVU101
 481 0004 5120     		movs	r0, #81
 482              	.LVL43:
 483              		.loc 1 153 9 view .LVU102
 484 0006 FFF7FEFF 		bl	SD_cmd
 485              	.LVL44:
 154:Core/Src/sd.c **** 	if (result!=0x00) return 5; //Thoat, neu ket qua tra ve 0x00
 486              		.loc 1 154 2 is_stmt 1 view .LVU103
 487              		.loc 1 154 5 is_stmt 0 view .LVU104
 488 000a 08BB     		cbnz	r0, .L47
 489 000c 0646     		mov	r6, r0
 155:Core/Src/sd.c **** 	  SPI_Release();
 490              		.loc 1 155 4 is_stmt 1 view .LVU105
 491 000e FFF7FEFF 		bl	SPI_Release
 492              	.LVL45:
 156:Core/Src/sd.c ****   cnt=0;
 493              		.loc 1 156 3 view .LVU106
 494              		.loc 1 156 6 is_stmt 0 view .LVU107
 495 0012 0024     		movs	r4, #0
 496              	.LVL46:
 497              	.L44:
 157:Core/Src/sd.c ****   do{ //We are waiting for the beginning of the block
 498              		.loc 1 157 3 is_stmt 1 discriminator 2 view .LVU108
 158:Core/Src/sd.c ****     result = SPI_ReceiveByte();
 499              		.loc 1 158 5 discriminator 2 view .LVU109
 500              		.loc 1 158 14 is_stmt 0 discriminator 2 view .LVU110
 501 0014 FFF7FEFF 		bl	SPI_ReceiveByte
 502              	.LVL47:
 159:Core/Src/sd.c ****     cnt++;
 503              		.loc 1 159 5 is_stmt 1 discriminator 2 view .LVU111
 504              		.loc 1 159 8 is_stmt 0 discriminator 2 view .LVU112
 505 0018 0134     		adds	r4, r4, #1
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 13


 506              	.LVL48:
 507              		.loc 1 159 8 discriminator 2 view .LVU113
 508 001a A4B2     		uxth	r4, r4
 509              	.LVL49:
 160:Core/Src/sd.c ****   } while ( (result!=0xFE)&&(cnt<0xFFFF) );
 510              		.loc 1 160 11 is_stmt 1 discriminator 2 view .LVU114
 511              		.loc 1 160 3 is_stmt 0 discriminator 2 view .LVU115
 512 001c FE28     		cmp	r0, #254
 513 001e 03D0     		beq	.L43
 514              		.loc 1 160 27 discriminator 1 view .LVU116
 515 0020 4FF6FF73 		movw	r3, #65535
 516 0024 9C42     		cmp	r4, r3
 517 0026 F5D1     		bne	.L44
 518              	.L43:
 161:Core/Src/sd.c ****   if (cnt>=0xFFFF) return 5;
 519              		.loc 1 161 3 is_stmt 1 view .LVU117
 520              		.loc 1 161 6 is_stmt 0 view .LVU118
 521 0028 4FF6FF73 		movw	r3, #65535
 522 002c 9C42     		cmp	r4, r3
 523 002e 11D0     		beq	.L48
 162:Core/Src/sd.c ****   for (cnt=0;cnt<512;cnt++) buff[cnt]=SPI_ReceiveByte(); //get the bytes of the block from the bus 
 524              		.loc 1 162 11 view .LVU119
 525 0030 0024     		movs	r4, #0
 526              	.LVL50:
 527              		.loc 1 162 11 view .LVU120
 528 0032 04E0     		b	.L45
 529              	.LVL51:
 530              	.L46:
 531              		.loc 1 162 29 is_stmt 1 discriminator 3 view .LVU121
 532              		.loc 1 162 39 is_stmt 0 discriminator 3 view .LVU122
 533 0034 FFF7FEFF 		bl	SPI_ReceiveByte
 534              	.LVL52:
 535              		.loc 1 162 38 discriminator 3 view .LVU123
 536 0038 2855     		strb	r0, [r5, r4]
 537              		.loc 1 162 22 is_stmt 1 discriminator 3 view .LVU124
 538              		.loc 1 162 25 is_stmt 0 discriminator 3 view .LVU125
 539 003a 0134     		adds	r4, r4, #1
 540              	.LVL53:
 541              		.loc 1 162 25 discriminator 3 view .LVU126
 542 003c A4B2     		uxth	r4, r4
 543              	.LVL54:
 544              	.L45:
 545              		.loc 1 162 14 is_stmt 1 discriminator 1 view .LVU127
 546              		.loc 1 162 3 is_stmt 0 discriminator 1 view .LVU128
 547 003e B4F5007F 		cmp	r4, #512
 548 0042 F7D3     		bcc	.L46
 163:Core/Src/sd.c ****   SPI_Release(); 
 549              		.loc 1 163 3 is_stmt 1 view .LVU129
 550 0044 FFF7FEFF 		bl	SPI_Release
 551              	.LVL55:
 164:Core/Src/sd.c ****   SPI_Release();
 552              		.loc 1 164 3 view .LVU130
 553 0048 FFF7FEFF 		bl	SPI_Release
 554              	.LVL56:
 165:Core/Src/sd.c ****   return 0;
 555              		.loc 1 165 3 view .LVU131
 556              	.L42:
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 14


 166:Core/Src/sd.c **** }
 557              		.loc 1 166 1 is_stmt 0 view .LVU132
 558 004c 3046     		mov	r0, r6
 559 004e 70BD     		pop	{r4, r5, r6, pc}
 560              	.LVL57:
 561              	.L47:
 154:Core/Src/sd.c **** 	  SPI_Release();
 562              		.loc 1 154 27 view .LVU133
 563 0050 0526     		movs	r6, #5
 564 0052 FBE7     		b	.L42
 565              	.LVL58:
 566              	.L48:
 161:Core/Src/sd.c ****   for (cnt=0;cnt<512;cnt++) buff[cnt]=SPI_ReceiveByte(); //get the bytes of the block from the bus 
 567              		.loc 1 161 27 view .LVU134
 568 0054 0526     		movs	r6, #5
 569 0056 F9E7     		b	.L42
 570              		.cfi_endproc
 571              	.LFE73:
 573              		.section	.text.SD_Write_Block,"ax",%progbits
 574              		.align	1
 575              		.global	SD_Write_Block
 576              		.syntax unified
 577              		.thumb
 578              		.thumb_func
 580              	SD_Write_Block:
 581              	.LVL59:
 582              	.LFB74:
 167:Core/Src/sd.c **** //-----------------------------------------------
 168:Core/Src/sd.c **** uint8_t SD_Write_Block (uint8_t *buff, uint32_t lba)
 169:Core/Src/sd.c **** {
 583              		.loc 1 169 1 is_stmt 1 view -0
 584              		.cfi_startproc
 585              		@ args = 0, pretend = 0, frame = 0
 586              		@ frame_needed = 0, uses_anonymous_args = 0
 587              		.loc 1 169 1 is_stmt 0 view .LVU136
 588 0000 70B5     		push	{r4, r5, r6, lr}
 589              	.LCFI11:
 590              		.cfi_def_cfa_offset 16
 591              		.cfi_offset 4, -16
 592              		.cfi_offset 5, -12
 593              		.cfi_offset 6, -8
 594              		.cfi_offset 14, -4
 595 0002 0546     		mov	r5, r0
 170:Core/Src/sd.c ****   uint8_t result;
 596              		.loc 1 170 3 is_stmt 1 view .LVU137
 171:Core/Src/sd.c ****   uint16_t cnt;
 597              		.loc 1 171 3 view .LVU138
 172:Core/Src/sd.c ****   result=SD_cmd(CMD24,lba); //CMD24 Datasheet 51 and 97-98
 598              		.loc 1 172 3 view .LVU139
 599              		.loc 1 172 10 is_stmt 0 view .LVU140
 600 0004 5820     		movs	r0, #88
 601              	.LVL60:
 602              		.loc 1 172 10 view .LVU141
 603 0006 FFF7FEFF 		bl	SD_cmd
 604              	.LVL61:
 173:Core/Src/sd.c ****   if (result!=0x00) return 6; //Exit if the result is not 0x00
 605              		.loc 1 173 3 is_stmt 1 view .LVU142
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 15


 606              		.loc 1 173 6 is_stmt 0 view .LVU143
 607 000a 50BB     		cbnz	r0, .L56
 608 000c 0646     		mov	r6, r0
 174:Core/Src/sd.c ****   SPI_Release();
 609              		.loc 1 174 3 is_stmt 1 view .LVU144
 610 000e FFF7FEFF 		bl	SPI_Release
 611              	.LVL62:
 175:Core/Src/sd.c ****   SPI_SendByte (0xFE); //Beginning of the buffer (Start block token)
 612              		.loc 1 175 3 view .LVU145
 613 0012 FE20     		movs	r0, #254
 614 0014 FFF7FEFF 		bl	SPI_SendByte
 615              	.LVL63:
 176:Core/Src/sd.c ****   for (cnt=0;cnt<512;cnt++) SPI_SendByte(buff[cnt]); //data transfer
 616              		.loc 1 176 3 view .LVU146
 617              		.loc 1 176 11 is_stmt 0 view .LVU147
 618 0018 0024     		movs	r4, #0
 619              		.loc 1 176 3 view .LVU148
 620 001a 04E0     		b	.L52
 621              	.LVL64:
 622              	.L53:
 623              		.loc 1 176 29 is_stmt 1 discriminator 3 view .LVU149
 624 001c 285D     		ldrb	r0, [r5, r4]	@ zero_extendqisi2
 625 001e FFF7FEFF 		bl	SPI_SendByte
 626              	.LVL65:
 627              		.loc 1 176 22 discriminator 3 view .LVU150
 628              		.loc 1 176 25 is_stmt 0 discriminator 3 view .LVU151
 629 0022 0134     		adds	r4, r4, #1
 630              	.LVL66:
 631              		.loc 1 176 25 discriminator 3 view .LVU152
 632 0024 A4B2     		uxth	r4, r4
 633              	.LVL67:
 634              	.L52:
 635              		.loc 1 176 14 is_stmt 1 discriminator 1 view .LVU153
 636              		.loc 1 176 3 is_stmt 0 discriminator 1 view .LVU154
 637 0026 B4F5007F 		cmp	r4, #512
 638 002a F7D3     		bcc	.L53
 177:Core/Src/sd.c ****   SPI_Release();
 639              		.loc 1 177 3 is_stmt 1 view .LVU155
 640 002c FFF7FEFF 		bl	SPI_Release
 641              	.LVL68:
 178:Core/Src/sd.c ****   SPI_Release();
 642              		.loc 1 178 3 view .LVU156
 643 0030 FFF7FEFF 		bl	SPI_Release
 644              	.LVL69:
 179:Core/Src/sd.c ****   result=SPI_ReceiveByte();
 645              		.loc 1 179 3 view .LVU157
 646              		.loc 1 179 10 is_stmt 0 view .LVU158
 647 0034 FFF7FEFF 		bl	SPI_ReceiveByte
 648              	.LVL70:
 180:Core/Src/sd.c ****   if ((result&0x05)!=0x05) return 6; //Exit if the result is not 0x05 (Datamount pg 111)
 649              		.loc 1 180 3 is_stmt 1 view .LVU159
 650              		.loc 1 180 6 is_stmt 0 view .LVU160
 651 0038 00F00503 		and	r3, r0, #5
 652 003c 052B     		cmp	r3, #5
 653 003e 12D1     		bne	.L57
 181:Core/Src/sd.c ****   cnt=0;
 654              		.loc 1 181 6 view .LVU161
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 16


 655 0040 0024     		movs	r4, #0
 656              	.LVL71:
 657              	.L55:
 182:Core/Src/sd.c ****   do { //We are waiting for the end of the BUSY state
 658              		.loc 1 182 3 is_stmt 1 discriminator 2 view .LVU162
 183:Core/Src/sd.c ****     result=SPI_ReceiveByte();
 659              		.loc 1 183 5 discriminator 2 view .LVU163
 660              		.loc 1 183 12 is_stmt 0 discriminator 2 view .LVU164
 661 0042 FFF7FEFF 		bl	SPI_ReceiveByte
 662              	.LVL72:
 184:Core/Src/sd.c ****     cnt++;
 663              		.loc 1 184 5 is_stmt 1 discriminator 2 view .LVU165
 664              		.loc 1 184 8 is_stmt 0 discriminator 2 view .LVU166
 665 0046 0134     		adds	r4, r4, #1
 666              	.LVL73:
 667              		.loc 1 184 8 discriminator 2 view .LVU167
 668 0048 A4B2     		uxth	r4, r4
 669              	.LVL74:
 185:Core/Src/sd.c ****   } while ( (result!=0xFF)&&(cnt<0xFFFF) );
 670              		.loc 1 185 11 is_stmt 1 discriminator 2 view .LVU168
 671              		.loc 1 185 3 is_stmt 0 discriminator 2 view .LVU169
 672 004a FF28     		cmp	r0, #255
 673 004c 03D0     		beq	.L54
 674              		.loc 1 185 27 discriminator 1 view .LVU170
 675 004e 4FF6FF73 		movw	r3, #65535
 676 0052 9C42     		cmp	r4, r3
 677 0054 F5D1     		bne	.L55
 678              	.L54:
 186:Core/Src/sd.c ****   if (cnt>=0xFFFF) return 6;
 679              		.loc 1 186 3 is_stmt 1 view .LVU171
 680              		.loc 1 186 6 is_stmt 0 view .LVU172
 681 0056 4FF6FF73 		movw	r3, #65535
 682 005a 9C42     		cmp	r4, r3
 683 005c 05D0     		beq	.L60
 684              	.LVL75:
 685              	.L51:
 187:Core/Src/sd.c ****   return 0;
 188:Core/Src/sd.c **** }
 686              		.loc 1 188 1 view .LVU173
 687 005e 3046     		mov	r0, r6
 688              	.LVL76:
 689              		.loc 1 188 1 view .LVU174
 690 0060 70BD     		pop	{r4, r5, r6, pc}
 691              	.LVL77:
 692              	.L56:
 173:Core/Src/sd.c ****   SPI_Release();
 693              		.loc 1 173 28 view .LVU175
 694 0062 0626     		movs	r6, #6
 695 0064 FBE7     		b	.L51
 696              	.LVL78:
 697              	.L57:
 180:Core/Src/sd.c ****   cnt=0;
 698              		.loc 1 180 35 view .LVU176
 699 0066 0626     		movs	r6, #6
 700 0068 F9E7     		b	.L51
 701              	.L60:
 186:Core/Src/sd.c ****   return 0;
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 17


 702              		.loc 1 186 27 view .LVU177
 703 006a 0626     		movs	r6, #6
 704 006c F7E7     		b	.L51
 705              		.cfi_endproc
 706              	.LFE74:
 708              		.section	.rodata.sd_ini.str1.4,"aMS",%progbits,1
 709              		.align	2
 710              	.LC0:
 711 0000 4F43523A 		.ascii	"OCR: 0x%02X 0x%02X 0x%02X 0x%02X\015\012\000"
 711      20307825 
 711      30325820 
 711      30782530 
 711      32582030 
 712 0023 00       		.align	2
 713              	.LC1:
 714 0024 54797065 		.ascii	"Type SD: 0x%02X\015\012\000"
 714      2053443A 
 714      20307825 
 714      3032580D 
 714      0A00
 715              		.section	.text.sd_ini,"ax",%progbits
 716              		.align	1
 717              		.global	sd_ini
 718              		.syntax unified
 719              		.thumb
 720              		.thumb_func
 722              	sd_ini:
 723              	.LFB75:
 189:Core/Src/sd.c **** //-----------------------------------------------
 190:Core/Src/sd.c **** uint8_t sd_ini(void)
 191:Core/Src/sd.c **** {
 724              		.loc 1 191 1 is_stmt 1 view -0
 725              		.cfi_startproc
 726              		@ args = 0, pretend = 0, frame = 8
 727              		@ frame_needed = 0, uses_anonymous_args = 0
 728 0000 70B5     		push	{r4, r5, r6, lr}
 729              	.LCFI12:
 730              		.cfi_def_cfa_offset 16
 731              		.cfi_offset 4, -16
 732              		.cfi_offset 5, -12
 733              		.cfi_offset 6, -8
 734              		.cfi_offset 14, -4
 735 0002 84B0     		sub	sp, sp, #16
 736              	.LCFI13:
 737              		.cfi_def_cfa_offset 32
 192:Core/Src/sd.c **** 	uint8_t i, cmd;					//Command
 738              		.loc 1 192 2 view .LVU179
 193:Core/Src/sd.c ****   int16_t tmr;						//Virtual timer
 739              		.loc 1 193 3 view .LVU180
 194:Core/Src/sd.c ****   uint32_t temp;					//Bien tam
 740              		.loc 1 194 3 view .LVU181
 195:Core/Src/sd.c ****   LD_OFF;									//Tat led PC13
 741              		.loc 1 195 3 view .LVU182
 742 0004 0122     		movs	r2, #1
 743 0006 4FF40051 		mov	r1, #8192
 744 000a 6E48     		ldr	r0, .L92
 745 000c FFF7FEFF 		bl	HAL_GPIO_WritePin
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 18


 746              	.LVL79:
 747              		.loc 1 195 9 view .LVU183
 196:Core/Src/sd.c ****   sdinfo.type = 0;				//Kieu the
 748              		.loc 1 196 3 view .LVU184
 749              		.loc 1 196 15 is_stmt 0 view .LVU185
 750 0010 0024     		movs	r4, #0
 751 0012 6D4B     		ldr	r3, .L92+4
 752 0014 1C70     		strb	r4, [r3]
 197:Core/Src/sd.c **** 	//OCR Register
 198:Core/Src/sd.c **** 	uint8_t ocr[4];
 753              		.loc 1 198 2 is_stmt 1 view .LVU186
 199:Core/Src/sd.c **** 	temp = hspi1.Init.BaudRatePrescaler;
 754              		.loc 1 199 2 view .LVU187
 755              		.loc 1 199 7 is_stmt 0 view .LVU188
 756 0016 6D48     		ldr	r0, .L92+8
 757 0018 C569     		ldr	r5, [r0, #28]
 758              	.LVL80:
 200:Core/Src/sd.c **** 	//Chia toc do cua SPI thang 156.25 KBPS vi toc doc cua bus APH qua cao nen sd card khong the dong 
 201:Core/Src/sd.c **** 	hspi1.Init.BaudRatePrescaler = SPI_BAUDRATEPRESCALER_128; //156.25 kbps
 759              		.loc 1 201 2 is_stmt 1 view .LVU189
 760              		.loc 1 201 31 is_stmt 0 view .LVU190
 761 001a 3023     		movs	r3, #48
 762 001c C361     		str	r3, [r0, #28]
 202:Core/Src/sd.c **** 	HAL_SPI_Init(&hspi1);
 763              		.loc 1 202 2 is_stmt 1 view .LVU191
 764 001e FFF7FEFF 		bl	HAL_SPI_Init
 765              	.LVL81:
 203:Core/Src/sd.c **** 	SS_SD_DESELECT();
 766              		.loc 1 203 2 view .LVU192
 767 0022 0122     		movs	r2, #1
 768 0024 0821     		movs	r1, #8
 769 0026 6A48     		ldr	r0, .L92+12
 770 0028 FFF7FEFF 		bl	HAL_GPIO_WritePin
 771              	.LVL82:
 204:Core/Src/sd.c **** 	for(i=0;i<10;i++) //Can phai doi it nhat 74 xung de dong bo, o day minh set 80
 772              		.loc 1 204 2 view .LVU193
 773              		.loc 1 204 2 is_stmt 0 view .LVU194
 774 002c 03E0     		b	.L62
 775              	.LVL83:
 776              	.L63:
 205:Core/Src/sd.c **** 	SPI_Release();
 777              		.loc 1 205 2 is_stmt 1 discriminator 3 view .LVU195
 778 002e FFF7FEFF 		bl	SPI_Release
 779              	.LVL84:
 204:Core/Src/sd.c **** 	for(i=0;i<10;i++) //Can phai doi it nhat 74 xung de dong bo, o day minh set 80
 780              		.loc 1 204 15 discriminator 3 view .LVU196
 204:Core/Src/sd.c **** 	for(i=0;i<10;i++) //Can phai doi it nhat 74 xung de dong bo, o day minh set 80
 781              		.loc 1 204 16 is_stmt 0 discriminator 3 view .LVU197
 782 0032 0134     		adds	r4, r4, #1
 783              	.LVL85:
 204:Core/Src/sd.c **** 	for(i=0;i<10;i++) //Can phai doi it nhat 74 xung de dong bo, o day minh set 80
 784              		.loc 1 204 16 discriminator 3 view .LVU198
 785 0034 E4B2     		uxtb	r4, r4
 786              	.LVL86:
 787              	.L62:
 204:Core/Src/sd.c **** 	for(i=0;i<10;i++) //Can phai doi it nhat 74 xung de dong bo, o day minh set 80
 788              		.loc 1 204 10 is_stmt 1 discriminator 1 view .LVU199
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 19


 204:Core/Src/sd.c **** 	for(i=0;i<10;i++) //Can phai doi it nhat 74 xung de dong bo, o day minh set 80
 789              		.loc 1 204 2 is_stmt 0 discriminator 1 view .LVU200
 790 0036 092C     		cmp	r4, #9
 791 0038 F9D9     		bls	.L63
 206:Core/Src/sd.c **** 	hspi1.Init.BaudRatePrescaler = temp;
 792              		.loc 1 206 2 is_stmt 1 view .LVU201
 793              		.loc 1 206 31 is_stmt 0 view .LVU202
 794 003a 6448     		ldr	r0, .L92+8
 795 003c C561     		str	r5, [r0, #28]
 207:Core/Src/sd.c **** 	HAL_SPI_Init(&hspi1);
 796              		.loc 1 207 2 is_stmt 1 view .LVU203
 797 003e FFF7FEFF 		bl	HAL_SPI_Init
 798              	.LVL87:
 208:Core/Src/sd.c **** 	SS_SD_SELECT();
 799              		.loc 1 208 2 view .LVU204
 800 0042 0022     		movs	r2, #0
 801 0044 0821     		movs	r1, #8
 802 0046 6248     		ldr	r0, .L92+12
 803 0048 FFF7FEFF 		bl	HAL_GPIO_WritePin
 804              	.LVL88:
 209:Core/Src/sd.c ****   if (SD_cmd(CMD0, 0) == 1) // Enter Idle state
 805              		.loc 1 209 3 view .LVU205
 806              		.loc 1 209 7 is_stmt 0 view .LVU206
 807 004c 0021     		movs	r1, #0
 808 004e 4020     		movs	r0, #64
 809 0050 FFF7FEFF 		bl	SD_cmd
 810              	.LVL89:
 811              		.loc 1 209 6 view .LVU207
 812 0054 0128     		cmp	r0, #1
 813 0056 02D0     		beq	.L87
 210:Core/Src/sd.c ****   {
 211:Core/Src/sd.c **** 		SPI_Release();
 212:Core/Src/sd.c **** 		if (SD_cmd(CMD8, 0x1AA) == 1) // SD version2 (Card returns response without illegal command) Lenh
 213:Core/Src/sd.c **** 		{
 214:Core/Src/sd.c **** 			for (i = 0; i < 4; i++) ocr[i] = SPI_ReceiveByte();
 215:Core/Src/sd.c **** 			sprintf(str1,"OCR: 0x%02X 0x%02X 0x%02X 0x%02X\r\n",ocr[0],ocr[1],ocr[2],ocr[3]);
 216:Core/Src/sd.c **** 			HAL_UART_Transmit(&huart2,(uint8_t*)str1,strlen(str1),0x1000);
 217:Core/Src/sd.c **** 			// Get trailing return value of R7 resp 
 218:Core/Src/sd.c **** 			//Check nguong dien ap hoat dong sd card
 219:Core/Src/sd.c **** 			if (ocr[2] == 0x01 && ocr[3] == 0xAA) // The card can work at vdd range of 2.7-3.6V
 220:Core/Src/sd.c **** 			{
 221:Core/Src/sd.c **** 				  for (tmr = 12000; tmr && SD_cmd(ACMD41, 1UL << 30); tmr--)
 222:Core/Src/sd.c **** 						; // Wait for leaving idle state (ACMD41 with HCS bit)
 223:Core/Src/sd.c **** 					if (tmr && SD_cmd(CMD58, 0) == 0) { // Check CCS bit in the OCR
 224:Core/Src/sd.c **** 					for (i = 0; i < 4; i++) ocr[i] = SPI_ReceiveByte();
 225:Core/Src/sd.c **** 					sprintf(str1,"OCR: 0x%02X 0x%02X 0x%02X 0x%02X\r\n",ocr[0],ocr[1],ocr[2],ocr[3]);
 226:Core/Src/sd.c **** 					HAL_UART_Transmit(&huart2,(uint8_t*)str1,strlen(str1),0x1000);
 227:Core/Src/sd.c **** 						//Kiem tra neu 8bit OCR dau tien la Low voltage range thi SDv2 (0x04) + CT_BLOCK (0x08)
 228:Core/Src/sd.c **** 					sdinfo.type = (ocr[0] & 0x40) ? CT_SD2 | CT_BLOCK : CT_SD2; // SDv2 (HC or SC)
 229:Core/Src/sd.c **** 				}
 230:Core/Src/sd.c **** 			}
 231:Core/Src/sd.c **** 		}
 232:Core/Src/sd.c **** 		else //SD version1 or MMC version3 (illegal command) Lenh khong hop le
 233:Core/Src/sd.c **** 		{
 234:Core/Src/sd.c **** 			if (SD_cmd(ACMD41, 0) <= 1)
 235:Core/Src/sd.c **** 			{
 236:Core/Src/sd.c **** 				sdinfo.type = CT_SD1; cmd = ACMD41; // SDv1
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 20


 237:Core/Src/sd.c **** 			}
 238:Core/Src/sd.c **** 			else
 239:Core/Src/sd.c **** 			{
 240:Core/Src/sd.c **** 				sdinfo.type = CT_MMC; cmd = CMD1; // MMCv3
 241:Core/Src/sd.c **** 			}
 242:Core/Src/sd.c **** 			for (tmr = 25000; tmr && SD_cmd(cmd, 0); tmr--) ; // Wait for leaving idle state
 243:Core/Src/sd.c **** 			if (!tmr || SD_cmd(CMD16, 512) != 0) // Set R/W block length to 512
 244:Core/Src/sd.c **** 			sdinfo.type = 0;
 245:Core/Src/sd.c **** 		}
 246:Core/Src/sd.c ****   }
 247:Core/Src/sd.c ****   else
 248:Core/Src/sd.c ****   {
 249:Core/Src/sd.c ****     return 1;
 814              		.loc 1 249 12 view .LVU208
 815 0058 0120     		movs	r0, #1
 816              	.LVL90:
 817              	.L64:
 250:Core/Src/sd.c ****   }
 251:Core/Src/sd.c ****   sprintf(str1,"Type SD: 0x%02X\r\n",sdinfo.type);
 252:Core/Src/sd.c ****   HAL_UART_Transmit(&huart2,(uint8_t*)str1,strlen(str1),0x1000);	
 253:Core/Src/sd.c ****   return 0;
 254:Core/Src/sd.c **** }
 818              		.loc 1 254 1 view .LVU209
 819 005a 04B0     		add	sp, sp, #16
 820              	.LCFI14:
 821              		.cfi_remember_state
 822              		.cfi_def_cfa_offset 16
 823              		@ sp needed
 824 005c 70BD     		pop	{r4, r5, r6, pc}
 825              	.LVL91:
 826              	.L87:
 827              	.LCFI15:
 828              		.cfi_restore_state
 211:Core/Src/sd.c **** 		if (SD_cmd(CMD8, 0x1AA) == 1) // SD version2 (Card returns response without illegal command) Lenh
 829              		.loc 1 211 3 is_stmt 1 view .LVU210
 830 005e FFF7FEFF 		bl	SPI_Release
 831              	.LVL92:
 212:Core/Src/sd.c **** 		{
 832              		.loc 1 212 3 view .LVU211
 212:Core/Src/sd.c **** 		{
 833              		.loc 1 212 7 is_stmt 0 view .LVU212
 834 0062 4FF4D571 		mov	r1, #426
 835 0066 4820     		movs	r0, #72
 836 0068 FFF7FEFF 		bl	SD_cmd
 837              	.LVL93:
 212:Core/Src/sd.c **** 		{
 838              		.loc 1 212 6 view .LVU213
 839 006c 0128     		cmp	r0, #1
 840 006e 6ED1     		bne	.L88
 841              	.LBB2:
 214:Core/Src/sd.c **** 			sprintf(str1,"OCR: 0x%02X 0x%02X 0x%02X 0x%02X\r\n",ocr[0],ocr[1],ocr[2],ocr[3]);
 842              		.loc 1 214 11 view .LVU214
 843 0070 0024     		movs	r4, #0
 844              	.LVL94:
 214:Core/Src/sd.c **** 			sprintf(str1,"OCR: 0x%02X 0x%02X 0x%02X 0x%02X\r\n",ocr[0],ocr[1],ocr[2],ocr[3]);
 845              		.loc 1 214 11 view .LVU215
 846 0072 08E0     		b	.L65
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 21


 847              	.LVL95:
 848              	.L67:
 214:Core/Src/sd.c **** 			sprintf(str1,"OCR: 0x%02X 0x%02X 0x%02X 0x%02X\r\n",ocr[0],ocr[1],ocr[2],ocr[3]);
 849              		.loc 1 214 28 is_stmt 1 discriminator 3 view .LVU216
 214:Core/Src/sd.c **** 			sprintf(str1,"OCR: 0x%02X 0x%02X 0x%02X 0x%02X\r\n",ocr[0],ocr[1],ocr[2],ocr[3]);
 850              		.loc 1 214 37 is_stmt 0 discriminator 3 view .LVU217
 851 0074 FFF7FEFF 		bl	SPI_ReceiveByte
 852              	.LVL96:
 214:Core/Src/sd.c **** 			sprintf(str1,"OCR: 0x%02X 0x%02X 0x%02X 0x%02X\r\n",ocr[0],ocr[1],ocr[2],ocr[3]);
 853              		.loc 1 214 35 discriminator 3 view .LVU218
 854 0078 04F11003 		add	r3, r4, #16
 855 007c 6B44     		add	r3, sp, r3
 856 007e 03F8040C 		strb	r0, [r3, #-4]
 214:Core/Src/sd.c **** 			sprintf(str1,"OCR: 0x%02X 0x%02X 0x%02X 0x%02X\r\n",ocr[0],ocr[1],ocr[2],ocr[3]);
 857              		.loc 1 214 23 is_stmt 1 discriminator 3 view .LVU219
 214:Core/Src/sd.c **** 			sprintf(str1,"OCR: 0x%02X 0x%02X 0x%02X 0x%02X\r\n",ocr[0],ocr[1],ocr[2],ocr[3]);
 858              		.loc 1 214 24 is_stmt 0 discriminator 3 view .LVU220
 859 0082 0134     		adds	r4, r4, #1
 860              	.LVL97:
 214:Core/Src/sd.c **** 			sprintf(str1,"OCR: 0x%02X 0x%02X 0x%02X 0x%02X\r\n",ocr[0],ocr[1],ocr[2],ocr[3]);
 861              		.loc 1 214 24 discriminator 3 view .LVU221
 862 0084 E4B2     		uxtb	r4, r4
 863              	.LVL98:
 864              	.L65:
 214:Core/Src/sd.c **** 			sprintf(str1,"OCR: 0x%02X 0x%02X 0x%02X 0x%02X\r\n",ocr[0],ocr[1],ocr[2],ocr[3]);
 865              		.loc 1 214 16 is_stmt 1 discriminator 1 view .LVU222
 214:Core/Src/sd.c **** 			sprintf(str1,"OCR: 0x%02X 0x%02X 0x%02X 0x%02X\r\n",ocr[0],ocr[1],ocr[2],ocr[3]);
 866              		.loc 1 214 4 is_stmt 0 discriminator 1 view .LVU223
 867 0086 032C     		cmp	r4, #3
 868 0088 F4D9     		bls	.L67
 215:Core/Src/sd.c **** 			HAL_UART_Transmit(&huart2,(uint8_t*)str1,strlen(str1),0x1000);
 869              		.loc 1 215 4 is_stmt 1 view .LVU224
 215:Core/Src/sd.c **** 			HAL_UART_Transmit(&huart2,(uint8_t*)str1,strlen(str1),0x1000);
 870              		.loc 1 215 73 is_stmt 0 view .LVU225
 871 008a 9DF80E50 		ldrb	r5, [sp, #14]	@ zero_extendqisi2
 872              	.LVL99:
 215:Core/Src/sd.c **** 			HAL_UART_Transmit(&huart2,(uint8_t*)str1,strlen(str1),0x1000);
 873              		.loc 1 215 80 view .LVU226
 874 008e 9DF80F60 		ldrb	r6, [sp, #15]	@ zero_extendqisi2
 215:Core/Src/sd.c **** 			HAL_UART_Transmit(&huart2,(uint8_t*)str1,strlen(str1),0x1000);
 875              		.loc 1 215 4 view .LVU227
 876 0092 504C     		ldr	r4, .L92+16
 877              	.LVL100:
 215:Core/Src/sd.c **** 			HAL_UART_Transmit(&huart2,(uint8_t*)str1,strlen(str1),0x1000);
 878              		.loc 1 215 4 view .LVU228
 879 0094 0196     		str	r6, [sp, #4]
 880 0096 0095     		str	r5, [sp]
 881 0098 9DF80D30 		ldrb	r3, [sp, #13]	@ zero_extendqisi2
 882 009c 9DF80C20 		ldrb	r2, [sp, #12]	@ zero_extendqisi2
 883 00a0 4D49     		ldr	r1, .L92+20
 884 00a2 2046     		mov	r0, r4
 885 00a4 FFF7FEFF 		bl	sprintf
 886              	.LVL101:
 216:Core/Src/sd.c **** 			// Get trailing return value of R7 resp 
 887              		.loc 1 216 4 is_stmt 1 view .LVU229
 216:Core/Src/sd.c **** 			// Get trailing return value of R7 resp 
 888              		.loc 1 216 45 is_stmt 0 view .LVU230
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 22


 889 00a8 2046     		mov	r0, r4
 890 00aa FFF7FEFF 		bl	strlen
 891              	.LVL102:
 216:Core/Src/sd.c **** 			// Get trailing return value of R7 resp 
 892              		.loc 1 216 4 view .LVU231
 893 00ae 4FF48053 		mov	r3, #4096
 894 00b2 82B2     		uxth	r2, r0
 895 00b4 2146     		mov	r1, r4
 896 00b6 4948     		ldr	r0, .L92+24
 897 00b8 FFF7FEFF 		bl	HAL_UART_Transmit
 898              	.LVL103:
 219:Core/Src/sd.c **** 			{
 899              		.loc 1 219 4 is_stmt 1 view .LVU232
 219:Core/Src/sd.c **** 			{
 900              		.loc 1 219 7 is_stmt 0 view .LVU233
 901 00bc 012D     		cmp	r5, #1
 902 00be 65D1     		bne	.L68
 219:Core/Src/sd.c **** 			{
 903              		.loc 1 219 23 discriminator 1 view .LVU234
 904 00c0 AA2E     		cmp	r6, #170
 905 00c2 63D1     		bne	.L68
 221:Core/Src/sd.c **** 						; // Wait for leaving idle state (ACMD41 with HCS bit)
 906              		.loc 1 221 16 view .LVU235
 907 00c4 42F6E064 		movw	r4, #12000
 908 00c8 01E0     		b	.L69
 909              	.LVL104:
 910              	.L71:
 222:Core/Src/sd.c **** 					if (tmr && SD_cmd(CMD58, 0) == 0) { // Check CCS bit in the OCR
 911              		.loc 1 222 7 is_stmt 1 discriminator 4 view .LVU236
 221:Core/Src/sd.c **** 						; // Wait for leaving idle state (ACMD41 with HCS bit)
 912              		.loc 1 221 59 discriminator 4 view .LVU237
 221:Core/Src/sd.c **** 						; // Wait for leaving idle state (ACMD41 with HCS bit)
 913              		.loc 1 221 62 is_stmt 0 discriminator 4 view .LVU238
 914 00ca 013C     		subs	r4, r4, #1
 915              	.LVL105:
 221:Core/Src/sd.c **** 						; // Wait for leaving idle state (ACMD41 with HCS bit)
 916              		.loc 1 221 62 discriminator 4 view .LVU239
 917 00cc 24B2     		sxth	r4, r4
 918              	.LVL106:
 919              	.L69:
 221:Core/Src/sd.c **** 						; // Wait for leaving idle state (ACMD41 with HCS bit)
 920              		.loc 1 221 25 is_stmt 1 discriminator 1 view .LVU240
 221:Core/Src/sd.c **** 						; // Wait for leaving idle state (ACMD41 with HCS bit)
 921              		.loc 1 221 7 is_stmt 0 discriminator 1 view .LVU241
 922 00ce 34B1     		cbz	r4, .L70
 221:Core/Src/sd.c **** 						; // Wait for leaving idle state (ACMD41 with HCS bit)
 923              		.loc 1 221 32 discriminator 3 view .LVU242
 924 00d0 4FF08041 		mov	r1, #1073741824
 925 00d4 E920     		movs	r0, #233
 926 00d6 FFF7FEFF 		bl	SD_cmd
 927              	.LVL107:
 221:Core/Src/sd.c **** 						; // Wait for leaving idle state (ACMD41 with HCS bit)
 928              		.loc 1 221 29 discriminator 3 view .LVU243
 929 00da 0028     		cmp	r0, #0
 930 00dc F5D1     		bne	.L71
 931              	.L70:
 223:Core/Src/sd.c **** 					for (i = 0; i < 4; i++) ocr[i] = SPI_ReceiveByte();
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 23


 932              		.loc 1 223 6 is_stmt 1 view .LVU244
 223:Core/Src/sd.c **** 					for (i = 0; i < 4; i++) ocr[i] = SPI_ReceiveByte();
 933              		.loc 1 223 9 is_stmt 0 view .LVU245
 934 00de 002C     		cmp	r4, #0
 935 00e0 54D0     		beq	.L68
 223:Core/Src/sd.c **** 					for (i = 0; i < 4; i++) ocr[i] = SPI_ReceiveByte();
 936              		.loc 1 223 17 discriminator 1 view .LVU246
 937 00e2 0021     		movs	r1, #0
 938 00e4 7A20     		movs	r0, #122
 939 00e6 FFF7FEFF 		bl	SD_cmd
 940              	.LVL108:
 223:Core/Src/sd.c **** 					for (i = 0; i < 4; i++) ocr[i] = SPI_ReceiveByte();
 941              		.loc 1 223 14 discriminator 1 view .LVU247
 942 00ea 0446     		mov	r4, r0
 943              	.LVL109:
 223:Core/Src/sd.c **** 					for (i = 0; i < 4; i++) ocr[i] = SPI_ReceiveByte();
 944              		.loc 1 223 14 discriminator 1 view .LVU248
 945 00ec 0028     		cmp	r0, #0
 946 00ee 4DD1     		bne	.L68
 947              	.L72:
 948              	.LVL110:
 224:Core/Src/sd.c **** 					sprintf(str1,"OCR: 0x%02X 0x%02X 0x%02X 0x%02X\r\n",ocr[0],ocr[1],ocr[2],ocr[3]);
 949              		.loc 1 224 18 is_stmt 1 discriminator 1 view .LVU249
 224:Core/Src/sd.c **** 					sprintf(str1,"OCR: 0x%02X 0x%02X 0x%02X 0x%02X\r\n",ocr[0],ocr[1],ocr[2],ocr[3]);
 950              		.loc 1 224 6 is_stmt 0 discriminator 1 view .LVU250
 951 00f0 032C     		cmp	r4, #3
 952 00f2 09D8     		bhi	.L89
 224:Core/Src/sd.c **** 					sprintf(str1,"OCR: 0x%02X 0x%02X 0x%02X 0x%02X\r\n",ocr[0],ocr[1],ocr[2],ocr[3]);
 953              		.loc 1 224 30 is_stmt 1 discriminator 3 view .LVU251
 224:Core/Src/sd.c **** 					sprintf(str1,"OCR: 0x%02X 0x%02X 0x%02X 0x%02X\r\n",ocr[0],ocr[1],ocr[2],ocr[3]);
 954              		.loc 1 224 39 is_stmt 0 discriminator 3 view .LVU252
 955 00f4 FFF7FEFF 		bl	SPI_ReceiveByte
 956              	.LVL111:
 224:Core/Src/sd.c **** 					sprintf(str1,"OCR: 0x%02X 0x%02X 0x%02X 0x%02X\r\n",ocr[0],ocr[1],ocr[2],ocr[3]);
 957              		.loc 1 224 37 discriminator 3 view .LVU253
 958 00f8 04F11003 		add	r3, r4, #16
 959 00fc 6B44     		add	r3, sp, r3
 960 00fe 03F8040C 		strb	r0, [r3, #-4]
 224:Core/Src/sd.c **** 					sprintf(str1,"OCR: 0x%02X 0x%02X 0x%02X 0x%02X\r\n",ocr[0],ocr[1],ocr[2],ocr[3]);
 961              		.loc 1 224 25 is_stmt 1 discriminator 3 view .LVU254
 224:Core/Src/sd.c **** 					sprintf(str1,"OCR: 0x%02X 0x%02X 0x%02X 0x%02X\r\n",ocr[0],ocr[1],ocr[2],ocr[3]);
 962              		.loc 1 224 26 is_stmt 0 discriminator 3 view .LVU255
 963 0102 0134     		adds	r4, r4, #1
 964              	.LVL112:
 224:Core/Src/sd.c **** 					sprintf(str1,"OCR: 0x%02X 0x%02X 0x%02X 0x%02X\r\n",ocr[0],ocr[1],ocr[2],ocr[3]);
 965              		.loc 1 224 26 discriminator 3 view .LVU256
 966 0104 E4B2     		uxtb	r4, r4
 967              	.LVL113:
 224:Core/Src/sd.c **** 					sprintf(str1,"OCR: 0x%02X 0x%02X 0x%02X 0x%02X\r\n",ocr[0],ocr[1],ocr[2],ocr[3]);
 968              		.loc 1 224 26 discriminator 3 view .LVU257
 969 0106 F3E7     		b	.L72
 970              	.L89:
 225:Core/Src/sd.c **** 					HAL_UART_Transmit(&huart2,(uint8_t*)str1,strlen(str1),0x1000);
 971              		.loc 1 225 6 is_stmt 1 view .LVU258
 225:Core/Src/sd.c **** 					HAL_UART_Transmit(&huart2,(uint8_t*)str1,strlen(str1),0x1000);
 972              		.loc 1 225 61 is_stmt 0 view .LVU259
 973 0108 9DF80C50 		ldrb	r5, [sp, #12]	@ zero_extendqisi2
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 24


 225:Core/Src/sd.c **** 					HAL_UART_Transmit(&huart2,(uint8_t*)str1,strlen(str1),0x1000);
 974              		.loc 1 225 75 view .LVU260
 975 010c 9DF80E30 		ldrb	r3, [sp, #14]	@ zero_extendqisi2
 225:Core/Src/sd.c **** 					HAL_UART_Transmit(&huart2,(uint8_t*)str1,strlen(str1),0x1000);
 976              		.loc 1 225 82 view .LVU261
 977 0110 9DF80F20 		ldrb	r2, [sp, #15]	@ zero_extendqisi2
 225:Core/Src/sd.c **** 					HAL_UART_Transmit(&huart2,(uint8_t*)str1,strlen(str1),0x1000);
 978              		.loc 1 225 6 view .LVU262
 979 0114 2F4C     		ldr	r4, .L92+16
 980              	.LVL114:
 225:Core/Src/sd.c **** 					HAL_UART_Transmit(&huart2,(uint8_t*)str1,strlen(str1),0x1000);
 981              		.loc 1 225 6 view .LVU263
 982 0116 0192     		str	r2, [sp, #4]
 983 0118 0093     		str	r3, [sp]
 984 011a 9DF80D30 		ldrb	r3, [sp, #13]	@ zero_extendqisi2
 985 011e 2A46     		mov	r2, r5
 986 0120 2D49     		ldr	r1, .L92+20
 987 0122 2046     		mov	r0, r4
 988 0124 FFF7FEFF 		bl	sprintf
 989              	.LVL115:
 226:Core/Src/sd.c **** 						//Kiem tra neu 8bit OCR dau tien la Low voltage range thi SDv2 (0x04) + CT_BLOCK (0x08)
 990              		.loc 1 226 6 is_stmt 1 view .LVU264
 226:Core/Src/sd.c **** 						//Kiem tra neu 8bit OCR dau tien la Low voltage range thi SDv2 (0x04) + CT_BLOCK (0x08)
 991              		.loc 1 226 47 is_stmt 0 view .LVU265
 992 0128 2046     		mov	r0, r4
 993 012a FFF7FEFF 		bl	strlen
 994              	.LVL116:
 226:Core/Src/sd.c **** 						//Kiem tra neu 8bit OCR dau tien la Low voltage range thi SDv2 (0x04) + CT_BLOCK (0x08)
 995              		.loc 1 226 6 view .LVU266
 996 012e 4FF48053 		mov	r3, #4096
 997 0132 82B2     		uxth	r2, r0
 998 0134 2146     		mov	r1, r4
 999 0136 2948     		ldr	r0, .L92+24
 1000 0138 FFF7FEFF 		bl	HAL_UART_Transmit
 1001              	.LVL117:
 228:Core/Src/sd.c **** 				}
 1002              		.loc 1 228 6 is_stmt 1 view .LVU267
 228:Core/Src/sd.c **** 				}
 1003              		.loc 1 228 18 is_stmt 0 view .LVU268
 1004 013c 15F0400F 		tst	r5, #64
 1005 0140 03D0     		beq	.L84
 1006 0142 0C23     		movs	r3, #12
 1007              	.L74:
 228:Core/Src/sd.c **** 				}
 1008              		.loc 1 228 18 discriminator 4 view .LVU269
 1009 0144 204A     		ldr	r2, .L92+4
 1010 0146 1370     		strb	r3, [r2]
 1011 0148 20E0     		b	.L68
 1012              	.L84:
 228:Core/Src/sd.c **** 				}
 1013              		.loc 1 228 18 view .LVU270
 1014 014a 0423     		movs	r3, #4
 1015 014c FAE7     		b	.L74
 1016              	.LVL118:
 1017              	.L88:
 228:Core/Src/sd.c **** 				}
 1018              		.loc 1 228 18 view .LVU271
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 25


 1019              	.LBE2:
 234:Core/Src/sd.c **** 			{
 1020              		.loc 1 234 4 is_stmt 1 view .LVU272
 234:Core/Src/sd.c **** 			{
 1021              		.loc 1 234 8 is_stmt 0 view .LVU273
 1022 014e 0021     		movs	r1, #0
 1023 0150 E920     		movs	r0, #233
 1024 0152 FFF7FEFF 		bl	SD_cmd
 1025              	.LVL119:
 234:Core/Src/sd.c **** 			{
 1026              		.loc 1 234 7 view .LVU274
 1027 0156 0128     		cmp	r0, #1
 1028 0158 06D9     		bls	.L90
 240:Core/Src/sd.c **** 			}
 1029              		.loc 1 240 5 is_stmt 1 view .LVU275
 240:Core/Src/sd.c **** 			}
 1030              		.loc 1 240 17 is_stmt 0 view .LVU276
 1031 015a 1B4B     		ldr	r3, .L92+4
 1032 015c 0122     		movs	r2, #1
 1033 015e 1A70     		strb	r2, [r3]
 240:Core/Src/sd.c **** 			}
 1034              		.loc 1 240 27 is_stmt 1 view .LVU277
 1035              	.LVL120:
 240:Core/Src/sd.c **** 			}
 1036              		.loc 1 240 31 is_stmt 0 view .LVU278
 1037 0160 4125     		movs	r5, #65
 1038              	.LVL121:
 1039              	.L76:
 242:Core/Src/sd.c **** 			if (!tmr || SD_cmd(CMD16, 512) != 0) // Set R/W block length to 512
 1040              		.loc 1 242 4 is_stmt 1 view .LVU279
 242:Core/Src/sd.c **** 			if (!tmr || SD_cmd(CMD16, 512) != 0) // Set R/W block length to 512
 1041              		.loc 1 242 13 is_stmt 0 view .LVU280
 1042 0162 46F2A814 		movw	r4, #25000
 1043              	.LVL122:
 242:Core/Src/sd.c **** 			if (!tmr || SD_cmd(CMD16, 512) != 0) // Set R/W block length to 512
 1044              		.loc 1 242 4 view .LVU281
 1045 0166 06E0     		b	.L77
 1046              	.LVL123:
 1047              	.L90:
 236:Core/Src/sd.c **** 			}
 1048              		.loc 1 236 5 is_stmt 1 view .LVU282
 236:Core/Src/sd.c **** 			}
 1049              		.loc 1 236 17 is_stmt 0 view .LVU283
 1050 0168 174B     		ldr	r3, .L92+4
 1051 016a 0222     		movs	r2, #2
 1052 016c 1A70     		strb	r2, [r3]
 236:Core/Src/sd.c **** 			}
 1053              		.loc 1 236 27 is_stmt 1 view .LVU284
 1054              	.LVL124:
 236:Core/Src/sd.c **** 			}
 1055              		.loc 1 236 31 is_stmt 0 view .LVU285
 1056 016e E925     		movs	r5, #233
 1057              	.LVL125:
 236:Core/Src/sd.c **** 			}
 1058              		.loc 1 236 31 view .LVU286
 1059 0170 F7E7     		b	.L76
 1060              	.LVL126:
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 26


 1061              	.L79:
 242:Core/Src/sd.c **** 			if (!tmr || SD_cmd(CMD16, 512) != 0) // Set R/W block length to 512
 1062              		.loc 1 242 52 is_stmt 1 discriminator 4 view .LVU287
 242:Core/Src/sd.c **** 			if (!tmr || SD_cmd(CMD16, 512) != 0) // Set R/W block length to 512
 1063              		.loc 1 242 45 discriminator 4 view .LVU288
 242:Core/Src/sd.c **** 			if (!tmr || SD_cmd(CMD16, 512) != 0) // Set R/W block length to 512
 1064              		.loc 1 242 48 is_stmt 0 discriminator 4 view .LVU289
 1065 0172 013C     		subs	r4, r4, #1
 1066              	.LVL127:
 242:Core/Src/sd.c **** 			if (!tmr || SD_cmd(CMD16, 512) != 0) // Set R/W block length to 512
 1067              		.loc 1 242 48 discriminator 4 view .LVU290
 1068 0174 24B2     		sxth	r4, r4
 1069              	.LVL128:
 1070              	.L77:
 242:Core/Src/sd.c **** 			if (!tmr || SD_cmd(CMD16, 512) != 0) // Set R/W block length to 512
 1071              		.loc 1 242 22 is_stmt 1 discriminator 1 view .LVU291
 242:Core/Src/sd.c **** 			if (!tmr || SD_cmd(CMD16, 512) != 0) // Set R/W block length to 512
 1072              		.loc 1 242 4 is_stmt 0 discriminator 1 view .LVU292
 1073 0176 2CB1     		cbz	r4, .L78
 242:Core/Src/sd.c **** 			if (!tmr || SD_cmd(CMD16, 512) != 0) // Set R/W block length to 512
 1074              		.loc 1 242 29 discriminator 3 view .LVU293
 1075 0178 0021     		movs	r1, #0
 1076 017a 2846     		mov	r0, r5
 1077 017c FFF7FEFF 		bl	SD_cmd
 1078              	.LVL129:
 242:Core/Src/sd.c **** 			if (!tmr || SD_cmd(CMD16, 512) != 0) // Set R/W block length to 512
 1079              		.loc 1 242 26 discriminator 3 view .LVU294
 1080 0180 0028     		cmp	r0, #0
 1081 0182 F6D1     		bne	.L79
 1082              	.L78:
 243:Core/Src/sd.c **** 			sdinfo.type = 0;
 1083              		.loc 1 243 4 is_stmt 1 view .LVU295
 243:Core/Src/sd.c **** 			sdinfo.type = 0;
 1084              		.loc 1 243 7 is_stmt 0 view .LVU296
 1085 0184 ACB9     		cbnz	r4, .L91
 1086              	.L80:
 244:Core/Src/sd.c **** 		}
 1087              		.loc 1 244 4 is_stmt 1 view .LVU297
 244:Core/Src/sd.c **** 		}
 1088              		.loc 1 244 16 is_stmt 0 view .LVU298
 1089 0186 104B     		ldr	r3, .L92+4
 1090 0188 0022     		movs	r2, #0
 1091 018a 1A70     		strb	r2, [r3]
 1092              	.LVL130:
 1093              	.L68:
 251:Core/Src/sd.c ****   HAL_UART_Transmit(&huart2,(uint8_t*)str1,strlen(str1),0x1000);	
 1094              		.loc 1 251 3 is_stmt 1 view .LVU299
 251:Core/Src/sd.c ****   HAL_UART_Transmit(&huart2,(uint8_t*)str1,strlen(str1),0x1000);	
 1095              		.loc 1 251 44 is_stmt 0 view .LVU300
 1096 018c 0E4B     		ldr	r3, .L92+4
 1097 018e 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 251:Core/Src/sd.c ****   HAL_UART_Transmit(&huart2,(uint8_t*)str1,strlen(str1),0x1000);	
 1098              		.loc 1 251 3 view .LVU301
 1099 0190 104C     		ldr	r4, .L92+16
 1100 0192 1349     		ldr	r1, .L92+28
 1101 0194 2046     		mov	r0, r4
 1102 0196 FFF7FEFF 		bl	sprintf
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 27


 1103              	.LVL131:
 252:Core/Src/sd.c ****   return 0;
 1104              		.loc 1 252 3 is_stmt 1 view .LVU302
 252:Core/Src/sd.c ****   return 0;
 1105              		.loc 1 252 44 is_stmt 0 view .LVU303
 1106 019a 2046     		mov	r0, r4
 1107 019c FFF7FEFF 		bl	strlen
 1108              	.LVL132:
 252:Core/Src/sd.c ****   return 0;
 1109              		.loc 1 252 3 view .LVU304
 1110 01a0 4FF48053 		mov	r3, #4096
 1111 01a4 82B2     		uxth	r2, r0
 1112 01a6 2146     		mov	r1, r4
 1113 01a8 0C48     		ldr	r0, .L92+24
 1114 01aa FFF7FEFF 		bl	HAL_UART_Transmit
 1115              	.LVL133:
 253:Core/Src/sd.c **** }
 1116              		.loc 1 253 3 is_stmt 1 view .LVU305
 253:Core/Src/sd.c **** }
 1117              		.loc 1 253 10 is_stmt 0 view .LVU306
 1118 01ae 0020     		movs	r0, #0
 1119 01b0 53E7     		b	.L64
 1120              	.LVL134:
 1121              	.L91:
 243:Core/Src/sd.c **** 			sdinfo.type = 0;
 1122              		.loc 1 243 16 discriminator 1 view .LVU307
 1123 01b2 4FF40071 		mov	r1, #512
 1124 01b6 5020     		movs	r0, #80
 1125 01b8 FFF7FEFF 		bl	SD_cmd
 1126              	.LVL135:
 243:Core/Src/sd.c **** 			sdinfo.type = 0;
 1127              		.loc 1 243 13 discriminator 1 view .LVU308
 1128 01bc 0028     		cmp	r0, #0
 1129 01be E5D0     		beq	.L68
 1130 01c0 E1E7     		b	.L80
 1131              	.L93:
 1132 01c2 00BF     		.align	2
 1133              	.L92:
 1134 01c4 00100140 		.word	1073811456
 1135 01c8 00000000 		.word	.LANCHOR0
 1136 01cc 00000000 		.word	hspi1
 1137 01d0 00080140 		.word	1073809408
 1138 01d4 00000000 		.word	.LANCHOR1
 1139 01d8 00000000 		.word	.LC0
 1140 01dc 00000000 		.word	huart2
 1141 01e0 24000000 		.word	.LC1
 1142              		.cfi_endproc
 1143              	.LFE75:
 1145              		.section	.rodata.ReadLongFile.str1.4,"aMS",%progbits,1
 1146              		.align	2
 1147              	.LC2:
 1148 0000 6673697A 		.ascii	"fsize: %lu\015\012\000"
 1148      653A2025 
 1148      6C750D0A 
 1148      00
 1149              		.section	.text.ReadLongFile,"ax",%progbits
 1150              		.align	1
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 28


 1151              		.global	ReadLongFile
 1152              		.syntax unified
 1153              		.thumb
 1154              		.thumb_func
 1156              	ReadLongFile:
 1157              	.LFB76:
 255:Core/Src/sd.c **** //-----------------------------------------------
 256:Core/Src/sd.c **** FRESULT ReadLongFile(void)
 257:Core/Src/sd.c **** {
 1158              		.loc 1 257 1 is_stmt 1 view -0
 1159              		.cfi_startproc
 1160              		@ args = 0, pretend = 0, frame = 0
 1161              		@ frame_needed = 0, uses_anonymous_args = 0
 1162 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 1163              	.LCFI16:
 1164              		.cfi_def_cfa_offset 24
 1165              		.cfi_offset 4, -24
 1166              		.cfi_offset 5, -20
 1167              		.cfi_offset 6, -16
 1168              		.cfi_offset 7, -12
 1169              		.cfi_offset 8, -8
 1170              		.cfi_offset 14, -4
 258:Core/Src/sd.c ****   uint16_t i=0, i1=0;
 1171              		.loc 1 258 3 view .LVU310
 1172              	.LVL136:
 259:Core/Src/sd.c ****   uint32_t ind=0;
 1173              		.loc 1 259 3 view .LVU311
 260:Core/Src/sd.c ****   uint32_t f_size = MyFile.fsize;
 1174              		.loc 1 260 3 view .LVU312
 1175              		.loc 1 260 12 is_stmt 0 view .LVU313
 1176 0004 1E4B     		ldr	r3, .L102
 1177 0006 DD68     		ldr	r5, [r3, #12]
 1178              	.LVL137:
 261:Core/Src/sd.c ****   sprintf(str1,"fsize: %lu\r\n",(unsigned long)f_size);
 1179              		.loc 1 261 3 is_stmt 1 view .LVU314
 1180 0008 1E4C     		ldr	r4, .L102+4
 1181 000a 2A46     		mov	r2, r5
 1182 000c 1E49     		ldr	r1, .L102+8
 1183 000e 2046     		mov	r0, r4
 1184 0010 FFF7FEFF 		bl	sprintf
 1185              	.LVL138:
 262:Core/Src/sd.c ****   HAL_UART_Transmit(&huart2,(uint8_t*)str1,strlen(str1),0x1000);
 1186              		.loc 1 262 3 view .LVU315
 1187              		.loc 1 262 44 is_stmt 0 view .LVU316
 1188 0014 2046     		mov	r0, r4
 1189 0016 FFF7FEFF 		bl	strlen
 1190              	.LVL139:
 1191              		.loc 1 262 3 view .LVU317
 1192 001a 4FF48053 		mov	r3, #4096
 1193 001e 82B2     		uxth	r2, r0
 1194 0020 2146     		mov	r1, r4
 1195 0022 1A48     		ldr	r0, .L102+12
 1196 0024 FFF7FEFF 		bl	HAL_UART_Transmit
 1197              	.LVL140:
 263:Core/Src/sd.c ****   ind=0;
 1198              		.loc 1 263 3 is_stmt 1 view .LVU318
 1199              		.loc 1 263 6 is_stmt 0 view .LVU319
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 29


 1200 0028 0026     		movs	r6, #0
 1201 002a 12E0     		b	.L98
 1202              	.LVL141:
 1203              	.L99:
 264:Core/Src/sd.c ****   do
 265:Core/Src/sd.c ****   {
 266:Core/Src/sd.c ****     if(f_size<512)
 267:Core/Src/sd.c ****     {
 268:Core/Src/sd.c ****       i1=f_size;
 269:Core/Src/sd.c ****     }
 270:Core/Src/sd.c ****     else
 271:Core/Src/sd.c ****     {
 272:Core/Src/sd.c ****       i1=512;
 1204              		.loc 1 272 9 view .LVU320
 1205 002c 4FF40074 		mov	r4, #512
 1206 0030 13E0     		b	.L95
 1207              	.LVL142:
 1208              	.L97:
 273:Core/Src/sd.c ****     }
 274:Core/Src/sd.c ****     f_size-=i1;
 275:Core/Src/sd.c ****     f_lseek(&MyFile,ind);
 276:Core/Src/sd.c ****     f_read(&MyFile,SD.rdata,i1,(UINT *)&bytesread);
 277:Core/Src/sd.c ****     for(i=0;i<bytesread;i++)
 278:Core/Src/sd.c ****     {
 279:Core/Src/sd.c **** 			//SD.rdata mang 1000 phan tu
 280:Core/Src/sd.c ****       HAL_UART_Transmit(&huart2,SD.rdata+i,1,0x1000);
 1209              		.loc 1 280 7 is_stmt 1 discriminator 3 view .LVU321
 1210 0032 4FF48053 		mov	r3, #4096
 1211 0036 0122     		movs	r2, #1
 1212 0038 1549     		ldr	r1, .L102+16
 1213 003a 2144     		add	r1, r1, r4
 1214 003c 1348     		ldr	r0, .L102+12
 1215 003e FFF7FEFF 		bl	HAL_UART_Transmit
 1216              	.LVL143:
 277:Core/Src/sd.c ****     {
 1217              		.loc 1 277 25 discriminator 3 view .LVU322
 277:Core/Src/sd.c ****     {
 1218              		.loc 1 277 26 is_stmt 0 discriminator 3 view .LVU323
 1219 0042 0134     		adds	r4, r4, #1
 1220              	.LVL144:
 277:Core/Src/sd.c ****     {
 1221              		.loc 1 277 26 discriminator 3 view .LVU324
 1222 0044 A4B2     		uxth	r4, r4
 1223              	.LVL145:
 1224              	.L96:
 277:Core/Src/sd.c ****     {
 1225              		.loc 1 277 13 is_stmt 1 discriminator 1 view .LVU325
 277:Core/Src/sd.c ****     {
 1226              		.loc 1 277 14 is_stmt 0 discriminator 1 view .LVU326
 1227 0046 134B     		ldr	r3, .L102+20
 1228 0048 1B68     		ldr	r3, [r3]
 277:Core/Src/sd.c ****     {
 1229              		.loc 1 277 5 discriminator 1 view .LVU327
 1230 004a 9C42     		cmp	r4, r3
 1231 004c F1D3     		bcc	.L97
 281:Core/Src/sd.c ****     }
 282:Core/Src/sd.c ****     ind+=i1;
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 30


 1232              		.loc 1 282 5 is_stmt 1 view .LVU328
 1233              		.loc 1 282 8 is_stmt 0 view .LVU329
 1234 004e 3E44     		add	r6, r6, r7
 1235              	.LVL146:
 283:Core/Src/sd.c ****   }
 284:Core/Src/sd.c ****   while(f_size>0);
 1236              		.loc 1 284 8 is_stmt 1 view .LVU330
 1237              		.loc 1 284 3 is_stmt 0 view .LVU331
 1238 0050 9DB1     		cbz	r5, .L101
 1239              	.LVL147:
 1240              	.L98:
 264:Core/Src/sd.c ****   {
 1241              		.loc 1 264 3 is_stmt 1 view .LVU332
 266:Core/Src/sd.c ****     {
 1242              		.loc 1 266 5 view .LVU333
 266:Core/Src/sd.c ****     {
 1243              		.loc 1 266 7 is_stmt 0 view .LVU334
 1244 0052 B5F5007F 		cmp	r5, #512
 1245 0056 E9D2     		bcs	.L99
 268:Core/Src/sd.c ****     }
 1246              		.loc 1 268 7 is_stmt 1 view .LVU335
 268:Core/Src/sd.c ****     }
 1247              		.loc 1 268 9 is_stmt 0 view .LVU336
 1248 0058 ACB2     		uxth	r4, r5
 1249              	.LVL148:
 1250              	.L95:
 274:Core/Src/sd.c ****     f_lseek(&MyFile,ind);
 1251              		.loc 1 274 5 is_stmt 1 view .LVU337
 274:Core/Src/sd.c ****     f_lseek(&MyFile,ind);
 1252              		.loc 1 274 11 is_stmt 0 view .LVU338
 1253 005a 2746     		mov	r7, r4
 1254 005c 2D1B     		subs	r5, r5, r4
 1255              	.LVL149:
 275:Core/Src/sd.c ****     f_read(&MyFile,SD.rdata,i1,(UINT *)&bytesread);
 1256              		.loc 1 275 5 is_stmt 1 view .LVU339
 1257 005e DFF83880 		ldr	r8, .L102+24
 1258 0062 3146     		mov	r1, r6
 1259 0064 4046     		mov	r0, r8
 1260 0066 FFF7FEFF 		bl	f_lseek
 1261              	.LVL150:
 276:Core/Src/sd.c ****     for(i=0;i<bytesread;i++)
 1262              		.loc 1 276 5 view .LVU340
 1263 006a 0A4B     		ldr	r3, .L102+20
 1264 006c 2246     		mov	r2, r4
 1265 006e 0849     		ldr	r1, .L102+16
 1266 0070 4046     		mov	r0, r8
 1267 0072 FFF7FEFF 		bl	f_read
 1268              	.LVL151:
 277:Core/Src/sd.c ****     {
 1269              		.loc 1 277 5 view .LVU341
 277:Core/Src/sd.c ****     {
 1270              		.loc 1 277 10 is_stmt 0 view .LVU342
 1271 0076 0024     		movs	r4, #0
 1272              	.LVL152:
 277:Core/Src/sd.c ****     {
 1273              		.loc 1 277 5 view .LVU343
 1274 0078 E5E7     		b	.L96
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 31


 1275              	.LVL153:
 1276              	.L101:
 285:Core/Src/sd.c **** //  HAL_UART_Transmit(&huart2,(uint8_t*)"\r\n",2,0x1000);
 286:Core/Src/sd.c ****   return FR_OK;
 1277              		.loc 1 286 3 is_stmt 1 view .LVU344
 287:Core/Src/sd.c **** }
 1278              		.loc 1 287 1 is_stmt 0 view .LVU345
 1279 007a 0020     		movs	r0, #0
 1280 007c BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1281              	.LVL154:
 1282              	.L103:
 1283              		.loc 1 287 1 view .LVU346
 1284              		.align	2
 1285              	.L102:
 1286 0080 00100000 		.word	MyFile+4096
 1287 0084 00000000 		.word	.LANCHOR1
 1288 0088 00000000 		.word	.LC2
 1289 008c 00000000 		.word	huart2
 1290 0090 01000000 		.word	SD+1
 1291 0094 00000000 		.word	.LANCHOR2
 1292 0098 00000000 		.word	MyFile
 1293              		.cfi_endproc
 1294              	.LFE76:
 1296              		.section	.text.SD_Write_File,"ax",%progbits
 1297              		.align	1
 1298              		.global	SD_Write_File
 1299              		.syntax unified
 1300              		.thumb
 1301              		.thumb_func
 1303              	SD_Write_File:
 1304              	.LVL155:
 1305              	.LFB77:
 288:Core/Src/sd.c **** 
 289:Core/Src/sd.c **** 
 290:Core/Src/sd.c **** void SD_Write_File(const char* filename, const char* buffer, uint8_t size){
 1306              		.loc 1 290 75 is_stmt 1 view -0
 1307              		.cfi_startproc
 1308              		@ args = 0, pretend = 0, frame = 0
 1309              		@ frame_needed = 0, uses_anonymous_args = 0
 1310              		.loc 1 290 75 is_stmt 0 view .LVU348
 1311 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 1312              	.LCFI17:
 1313              		.cfi_def_cfa_offset 24
 1314              		.cfi_offset 4, -24
 1315              		.cfi_offset 5, -20
 1316              		.cfi_offset 6, -16
 1317              		.cfi_offset 7, -12
 1318              		.cfi_offset 8, -8
 1319              		.cfi_offset 14, -4
 1320 0004 0446     		mov	r4, r0
 1321 0006 0E46     		mov	r6, r1
 1322 0008 1546     		mov	r5, r2
 291:Core/Src/sd.c **** 		if(f_mount(&SDFatFs,(TCHAR const*)USER_Path,0)!=FR_OK)
 1323              		.loc 1 291 3 is_stmt 1 view .LVU349
 1324              		.loc 1 291 6 is_stmt 0 view .LVU350
 1325 000a 0022     		movs	r2, #0
 1326              	.LVL156:
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 32


 1327              		.loc 1 291 6 view .LVU351
 1328 000c 1849     		ldr	r1, .L111
 1329              	.LVL157:
 1330              		.loc 1 291 6 view .LVU352
 1331 000e 1948     		ldr	r0, .L111+4
 1332              	.LVL158:
 1333              		.loc 1 291 6 view .LVU353
 1334 0010 FFF7FEFF 		bl	f_mount
 1335              	.LVL159:
 1336              		.loc 1 291 5 view .LVU354
 1337 0014 18B1     		cbz	r0, .L105
 292:Core/Src/sd.c **** 		{
 293:Core/Src/sd.c **** 			Error_Handler();
 1338              		.loc 1 293 4 is_stmt 1 view .LVU355
 1339 0016 FFF7FEFF 		bl	Error_Handler
 1340              	.LVL160:
 1341              	.L104:
 294:Core/Src/sd.c **** 		}
 295:Core/Src/sd.c **** 		else
 296:Core/Src/sd.c **** 		{
 297:Core/Src/sd.c **** 			if(f_open(&MyFile, filename, FA_OPEN_ALWAYS|FA_WRITE)!=FR_OK)
 298:Core/Src/sd.c **** 			{
 299:Core/Src/sd.c **** 				Error_Handler();
 300:Core/Src/sd.c **** 			}
 301:Core/Src/sd.c **** 			else
 302:Core/Src/sd.c **** 			{
 303:Core/Src/sd.c **** 				res = f_lseek(&MyFile , MyFile.fsize);
 304:Core/Src/sd.c **** 				byteswritten = 0;
 305:Core/Src/sd.c **** 				res=f_write(&MyFile, buffer, size,(void*)&byteswritten);
 306:Core/Src/sd.c **** 				if((byteswritten==0)||(res!=FR_OK))
 307:Core/Src/sd.c **** 				{
 308:Core/Src/sd.c **** 					Error_Handler();
 309:Core/Src/sd.c **** 				}
 310:Core/Src/sd.c **** 				f_close(&MyFile);
 311:Core/Src/sd.c **** 			}
 312:Core/Src/sd.c **** 		}
 313:Core/Src/sd.c **** }
 1342              		.loc 1 313 1 is_stmt 0 view .LVU356
 1343 001a BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1344              	.LVL161:
 1345              	.L105:
 297:Core/Src/sd.c **** 			{
 1346              		.loc 1 297 4 is_stmt 1 view .LVU357
 297:Core/Src/sd.c **** 			{
 1347              		.loc 1 297 7 is_stmt 0 view .LVU358
 1348 001e 1222     		movs	r2, #18
 1349 0020 2146     		mov	r1, r4
 1350 0022 1548     		ldr	r0, .L111+8
 1351 0024 FFF7FEFF 		bl	f_open
 1352              	.LVL162:
 297:Core/Src/sd.c **** 			{
 1353              		.loc 1 297 6 view .LVU359
 1354 0028 10B1     		cbz	r0, .L107
 299:Core/Src/sd.c **** 			}
 1355              		.loc 1 299 5 is_stmt 1 view .LVU360
 1356 002a FFF7FEFF 		bl	Error_Handler
 1357              	.LVL163:
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 33


 1358 002e F4E7     		b	.L104
 1359              	.L107:
 303:Core/Src/sd.c **** 				byteswritten = 0;
 1360              		.loc 1 303 5 view .LVU361
 303:Core/Src/sd.c **** 				byteswritten = 0;
 1361              		.loc 1 303 11 is_stmt 0 view .LVU362
 1362 0030 114F     		ldr	r7, .L111+8
 1363 0032 07F58053 		add	r3, r7, #4096
 1364 0036 D968     		ldr	r1, [r3, #12]
 1365 0038 3846     		mov	r0, r7
 1366 003a FFF7FEFF 		bl	f_lseek
 1367              	.LVL164:
 303:Core/Src/sd.c **** 				byteswritten = 0;
 1368              		.loc 1 303 9 view .LVU363
 1369 003e DFF83C80 		ldr	r8, .L111+12
 1370 0042 88F80000 		strb	r0, [r8]
 304:Core/Src/sd.c **** 				res=f_write(&MyFile, buffer, size,(void*)&byteswritten);
 1371              		.loc 1 304 5 is_stmt 1 view .LVU364
 304:Core/Src/sd.c **** 				res=f_write(&MyFile, buffer, size,(void*)&byteswritten);
 1372              		.loc 1 304 18 is_stmt 0 view .LVU365
 1373 0046 0E4C     		ldr	r4, .L111+16
 1374              	.LVL165:
 304:Core/Src/sd.c **** 				res=f_write(&MyFile, buffer, size,(void*)&byteswritten);
 1375              		.loc 1 304 18 view .LVU366
 1376 0048 0023     		movs	r3, #0
 1377 004a 2360     		str	r3, [r4]
 305:Core/Src/sd.c **** 				if((byteswritten==0)||(res!=FR_OK))
 1378              		.loc 1 305 5 is_stmt 1 view .LVU367
 305:Core/Src/sd.c **** 				if((byteswritten==0)||(res!=FR_OK))
 1379              		.loc 1 305 9 is_stmt 0 view .LVU368
 1380 004c 2346     		mov	r3, r4
 1381 004e 2A46     		mov	r2, r5
 1382 0050 3146     		mov	r1, r6
 1383 0052 3846     		mov	r0, r7
 1384 0054 FFF7FEFF 		bl	f_write
 1385              	.LVL166:
 305:Core/Src/sd.c **** 				if((byteswritten==0)||(res!=FR_OK))
 1386              		.loc 1 305 8 view .LVU369
 1387 0058 88F80000 		strb	r0, [r8]
 306:Core/Src/sd.c **** 				{
 1388              		.loc 1 306 5 is_stmt 1 view .LVU370
 306:Core/Src/sd.c **** 				{
 1389              		.loc 1 306 21 is_stmt 0 view .LVU371
 1390 005c 2368     		ldr	r3, [r4]
 306:Core/Src/sd.c **** 				{
 1391              		.loc 1 306 7 view .LVU372
 1392 005e 03B1     		cbz	r3, .L108
 306:Core/Src/sd.c **** 				{
 1393              		.loc 1 306 25 discriminator 1 view .LVU373
 1394 0060 08B1     		cbz	r0, .L109
 1395              	.L108:
 308:Core/Src/sd.c **** 				}
 1396              		.loc 1 308 6 is_stmt 1 view .LVU374
 1397 0062 FFF7FEFF 		bl	Error_Handler
 1398              	.LVL167:
 1399              	.L109:
 310:Core/Src/sd.c **** 			}
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 34


 1400              		.loc 1 310 5 view .LVU375
 1401 0066 0448     		ldr	r0, .L111+8
 1402 0068 FFF7FEFF 		bl	f_close
 1403              	.LVL168:
 1404              		.loc 1 313 1 is_stmt 0 view .LVU376
 1405 006c D5E7     		b	.L104
 1406              	.L112:
 1407 006e 00BF     		.align	2
 1408              	.L111:
 1409 0070 00000000 		.word	USER_Path
 1410 0074 00000000 		.word	SDFatFs
 1411 0078 00000000 		.word	MyFile
 1412 007c 00000000 		.word	.LANCHOR3
 1413 0080 00000000 		.word	.LANCHOR4
 1414              		.cfi_endproc
 1415              	.LFE77:
 1417              		.section	.text.SD_Read_File,"ax",%progbits
 1418              		.align	1
 1419              		.global	SD_Read_File
 1420              		.syntax unified
 1421              		.thumb
 1422              		.thumb_func
 1424              	SD_Read_File:
 1425              	.LVL169:
 1426              	.LFB78:
 314:Core/Src/sd.c **** uint8_t* SD_Read_File(const char* filename){
 1427              		.loc 1 314 44 is_stmt 1 view -0
 1428              		.cfi_startproc
 1429              		@ args = 0, pretend = 0, frame = 0
 1430              		@ frame_needed = 0, uses_anonymous_args = 0
 1431              		.loc 1 314 44 is_stmt 0 view .LVU378
 1432 0000 10B5     		push	{r4, lr}
 1433              	.LCFI18:
 1434              		.cfi_def_cfa_offset 8
 1435              		.cfi_offset 4, -8
 1436              		.cfi_offset 14, -4
 1437 0002 0446     		mov	r4, r0
 315:Core/Src/sd.c **** 	if(f_mount(&SDFatFs,(TCHAR const*)USER_Path,0)!=FR_OK)
 1438              		.loc 1 315 2 is_stmt 1 view .LVU379
 1439              		.loc 1 315 5 is_stmt 0 view .LVU380
 1440 0004 0022     		movs	r2, #0
 1441 0006 0C49     		ldr	r1, .L118
 1442 0008 0C48     		ldr	r0, .L118+4
 1443              	.LVL170:
 1444              		.loc 1 315 5 view .LVU381
 1445 000a FFF7FEFF 		bl	f_mount
 1446              	.LVL171:
 1447              		.loc 1 315 4 view .LVU382
 1448 000e 18B1     		cbz	r0, .L114
 316:Core/Src/sd.c **** 		{ 
 317:Core/Src/sd.c **** 			Error_Handler();
 1449              		.loc 1 317 4 is_stmt 1 view .LVU383
 1450 0010 FFF7FEFF 		bl	Error_Handler
 1451              	.LVL172:
 1452              	.L115:
 318:Core/Src/sd.c **** 		}
 319:Core/Src/sd.c **** 		else
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 35


 320:Core/Src/sd.c **** 		{
 321:Core/Src/sd.c **** 			if(f_open(&MyFile,filename,FA_READ|FA_OPEN_EXISTING)!=FR_OK)
 322:Core/Src/sd.c **** 			{
 323:Core/Src/sd.c **** 				Error_Handler();
 324:Core/Src/sd.c **** 			}
 325:Core/Src/sd.c **** 			else
 326:Core/Src/sd.c **** 			{
 327:Core/Src/sd.c **** 				ReadLongFile();
 328:Core/Src/sd.c **** 				f_close(&MyFile);
 329:Core/Src/sd.c **** 			}
 330:Core/Src/sd.c **** 		 }
 331:Core/Src/sd.c **** 	return SD.rdata;
 1453              		.loc 1 331 2 view .LVU384
 332:Core/Src/sd.c **** }
 1454              		.loc 1 332 1 is_stmt 0 view .LVU385
 1455 0014 0A48     		ldr	r0, .L118+8
 1456 0016 10BD     		pop	{r4, pc}
 1457              	.LVL173:
 1458              	.L114:
 321:Core/Src/sd.c **** 			{
 1459              		.loc 1 321 4 is_stmt 1 view .LVU386
 321:Core/Src/sd.c **** 			{
 1460              		.loc 1 321 7 is_stmt 0 view .LVU387
 1461 0018 0122     		movs	r2, #1
 1462 001a 2146     		mov	r1, r4
 1463 001c 0948     		ldr	r0, .L118+12
 1464 001e FFF7FEFF 		bl	f_open
 1465              	.LVL174:
 321:Core/Src/sd.c **** 			{
 1466              		.loc 1 321 6 view .LVU388
 1467 0022 10B1     		cbz	r0, .L116
 323:Core/Src/sd.c **** 			}
 1468              		.loc 1 323 5 is_stmt 1 view .LVU389
 1469 0024 FFF7FEFF 		bl	Error_Handler
 1470              	.LVL175:
 1471 0028 F4E7     		b	.L115
 1472              	.L116:
 327:Core/Src/sd.c **** 				f_close(&MyFile);
 1473              		.loc 1 327 5 view .LVU390
 1474 002a FFF7FEFF 		bl	ReadLongFile
 1475              	.LVL176:
 328:Core/Src/sd.c **** 			}
 1476              		.loc 1 328 5 view .LVU391
 1477 002e 0548     		ldr	r0, .L118+12
 1478 0030 FFF7FEFF 		bl	f_close
 1479              	.LVL177:
 1480 0034 EEE7     		b	.L115
 1481              	.L119:
 1482 0036 00BF     		.align	2
 1483              	.L118:
 1484 0038 00000000 		.word	USER_Path
 1485 003c 00000000 		.word	SDFatFs
 1486 0040 01000000 		.word	SD+1
 1487 0044 00000000 		.word	MyFile
 1488              		.cfi_endproc
 1489              	.LFE78:
 1491              		.section	.rodata.SD_List_File.str1.4,"aMS",%progbits,1
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 36


 1492              		.align	2
 1493              	.LC3:
 1494 0000 2F00     		.ascii	"/\000"
 1495 0002 0000     		.align	2
 1496              	.LC4:
 1497 0004 20205B44 		.ascii	"  [DIR]\000"
 1497      49525D00 
 1498              		.align	2
 1499              	.LC5:
 1500 000c 0D0A00   		.ascii	"\015\012\000"
 1501              		.section	.text.SD_List_File,"ax",%progbits
 1502              		.align	1
 1503              		.global	SD_List_File
 1504              		.syntax unified
 1505              		.thumb
 1506              		.thumb_func
 1508              	SD_List_File:
 1509              	.LFB79:
 333:Core/Src/sd.c **** 
 334:Core/Src/sd.c **** void SD_List_File(void){
 1510              		.loc 1 334 24 view -0
 1511              		.cfi_startproc
 1512              		@ args = 0, pretend = 0, frame = 0
 1513              		@ frame_needed = 0, uses_anonymous_args = 0
 1514 0000 10B5     		push	{r4, lr}
 1515              	.LCFI19:
 1516              		.cfi_def_cfa_offset 8
 1517              		.cfi_offset 4, -8
 1518              		.cfi_offset 14, -4
 335:Core/Src/sd.c **** 	if(f_mount(&SDFatFs,(TCHAR const*)USER_Path,0)!=FR_OK)
 1519              		.loc 1 335 2 view .LVU393
 1520              		.loc 1 335 5 is_stmt 0 view .LVU394
 1521 0002 0022     		movs	r2, #0
 1522 0004 2A49     		ldr	r1, .L130
 1523 0006 2B48     		ldr	r0, .L130+4
 1524 0008 FFF7FEFF 		bl	f_mount
 1525              	.LVL178:
 1526              		.loc 1 335 4 view .LVU395
 1527 000c 10B1     		cbz	r0, .L121
 336:Core/Src/sd.c **** 	{
 337:Core/Src/sd.c **** 		Error_Handler();
 1528              		.loc 1 337 3 is_stmt 1 view .LVU396
 1529 000e FFF7FEFF 		bl	Error_Handler
 1530              	.LVL179:
 1531              	.L120:
 338:Core/Src/sd.c **** 	}
 339:Core/Src/sd.c **** 	else
 340:Core/Src/sd.c **** 	{
 341:Core/Src/sd.c **** 		fileInfo.lfname = (char*)sect;
 342:Core/Src/sd.c **** 		fileInfo.lfsize = sizeof(sect);
 343:Core/Src/sd.c **** 		result = f_opendir(&dir, "/");
 344:Core/Src/sd.c **** 		//Liet ke danh sach tep tin co trong sd card
 345:Core/Src/sd.c **** 		if (result == FR_OK)
 346:Core/Src/sd.c **** 		{
 347:Core/Src/sd.c **** 			while(1)
 348:Core/Src/sd.c **** 			{
 349:Core/Src/sd.c **** 				result = f_readdir(&dir, &fileInfo);
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 37


 350:Core/Src/sd.c **** 				if (result==FR_OK && fileInfo.fname[0])
 351:Core/Src/sd.c **** 				{
 352:Core/Src/sd.c **** 					fn = fileInfo.lfname; // Pointer to the LFN buffer
 353:Core/Src/sd.c **** 					//khi truyen buffer vao HAL_UART thi truyen vao dia chi dau tien cua mang se liet ke het danh 
 354:Core/Src/sd.c **** 					if(strlen(fn)) HAL_UART_Transmit(&huart2,(uint8_t*)fn,strlen(fn),0x1000);
 355:Core/Src/sd.c **** 					else HAL_UART_Transmit(&huart2,(uint8_t*)fileInfo.fname,strlen((char*)fileInfo.fname),0x1000);
 356:Core/Src/sd.c **** 					if(fileInfo.fattrib&AM_DIR)
 357:Core/Src/sd.c **** 					{
 358:Core/Src/sd.c **** 						HAL_UART_Transmit(&huart2,(uint8_t*)"  [DIR]",7,0x1000);
 359:Core/Src/sd.c **** 					}					
 360:Core/Src/sd.c **** 				}
 361:Core/Src/sd.c **** 				else break;
 362:Core/Src/sd.c **** 				HAL_UART_Transmit(&huart2,(uint8_t*)"\r\n",2,0x1000);
 363:Core/Src/sd.c **** 			}
 364:Core/Src/sd.c **** 			f_closedir(&dir);
 365:Core/Src/sd.c **** 		}
 366:Core/Src/sd.c **** 	}
 367:Core/Src/sd.c **** }
 1532              		.loc 1 367 1 is_stmt 0 view .LVU397
 1533 0012 10BD     		pop	{r4, pc}
 1534              	.L121:
 341:Core/Src/sd.c **** 		fileInfo.lfsize = sizeof(sect);
 1535              		.loc 1 341 3 is_stmt 1 view .LVU398
 341:Core/Src/sd.c **** 		fileInfo.lfsize = sizeof(sect);
 1536              		.loc 1 341 19 is_stmt 0 view .LVU399
 1537 0014 284B     		ldr	r3, .L130+8
 1538 0016 294A     		ldr	r2, .L130+12
 1539 0018 9A61     		str	r2, [r3, #24]
 342:Core/Src/sd.c **** 		result = f_opendir(&dir, "/");
 1540              		.loc 1 342 3 is_stmt 1 view .LVU400
 342:Core/Src/sd.c **** 		result = f_opendir(&dir, "/");
 1541              		.loc 1 342 19 is_stmt 0 view .LVU401
 1542 001a 4FF40072 		mov	r2, #512
 1543 001e DA61     		str	r2, [r3, #28]
 343:Core/Src/sd.c **** 		//Liet ke danh sach tep tin co trong sd card
 1544              		.loc 1 343 3 is_stmt 1 view .LVU402
 343:Core/Src/sd.c **** 		//Liet ke danh sach tep tin co trong sd card
 1545              		.loc 1 343 12 is_stmt 0 view .LVU403
 1546 0020 2749     		ldr	r1, .L130+16
 1547 0022 2848     		ldr	r0, .L130+20
 1548 0024 FFF7FEFF 		bl	f_opendir
 1549              	.LVL180:
 343:Core/Src/sd.c **** 		//Liet ke danh sach tep tin co trong sd card
 1550              		.loc 1 343 10 view .LVU404
 1551 0028 274B     		ldr	r3, .L130+24
 1552 002a 1870     		strb	r0, [r3]
 345:Core/Src/sd.c **** 		{
 1553              		.loc 1 345 3 is_stmt 1 view .LVU405
 345:Core/Src/sd.c **** 		{
 1554              		.loc 1 345 6 is_stmt 0 view .LVU406
 1555 002c 0028     		cmp	r0, #0
 1556 002e F0D1     		bne	.L120
 1557 0030 16E0     		b	.L127
 1558              	.L124:
 355:Core/Src/sd.c **** 					if(fileInfo.fattrib&AM_DIR)
 1559              		.loc 1 355 11 is_stmt 1 view .LVU407
 355:Core/Src/sd.c **** 					if(fileInfo.fattrib&AM_DIR)
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 38


 1560              		.loc 1 355 62 is_stmt 0 view .LVU408
 1561 0032 264C     		ldr	r4, .L130+28
 1562 0034 2046     		mov	r0, r4
 1563 0036 FFF7FEFF 		bl	strlen
 1564              	.LVL181:
 355:Core/Src/sd.c **** 					if(fileInfo.fattrib&AM_DIR)
 1565              		.loc 1 355 11 view .LVU409
 1566 003a 4FF48053 		mov	r3, #4096
 1567 003e 82B2     		uxth	r2, r0
 1568 0040 2146     		mov	r1, r4
 1569 0042 2348     		ldr	r0, .L130+32
 1570 0044 FFF7FEFF 		bl	HAL_UART_Transmit
 1571              	.LVL182:
 1572              	.L125:
 356:Core/Src/sd.c **** 					{
 1573              		.loc 1 356 6 is_stmt 1 view .LVU410
 356:Core/Src/sd.c **** 					{
 1574              		.loc 1 356 17 is_stmt 0 view .LVU411
 1575 0048 1B4B     		ldr	r3, .L130+8
 1576 004a 1B7A     		ldrb	r3, [r3, #8]	@ zero_extendqisi2
 356:Core/Src/sd.c **** 					{
 1577              		.loc 1 356 8 view .LVU412
 1578 004c 13F0100F 		tst	r3, #16
 1579 0050 22D1     		bne	.L129
 1580              	.L126:
 362:Core/Src/sd.c **** 			}
 1581              		.loc 1 362 5 is_stmt 1 view .LVU413
 1582 0052 4FF48053 		mov	r3, #4096
 1583 0056 0222     		movs	r2, #2
 1584 0058 1E49     		ldr	r1, .L130+36
 1585 005a 1D48     		ldr	r0, .L130+32
 1586 005c FFF7FEFF 		bl	HAL_UART_Transmit
 1587              	.LVL183:
 347:Core/Src/sd.c **** 			{
 1588              		.loc 1 347 9 view .LVU414
 1589              	.L127:
 347:Core/Src/sd.c **** 			{
 1590              		.loc 1 347 4 view .LVU415
 349:Core/Src/sd.c **** 				if (result==FR_OK && fileInfo.fname[0])
 1591              		.loc 1 349 5 view .LVU416
 349:Core/Src/sd.c **** 				if (result==FR_OK && fileInfo.fname[0])
 1592              		.loc 1 349 14 is_stmt 0 view .LVU417
 1593 0060 1549     		ldr	r1, .L130+8
 1594 0062 1848     		ldr	r0, .L130+20
 1595 0064 FFF7FEFF 		bl	f_readdir
 1596              	.LVL184:
 349:Core/Src/sd.c **** 				if (result==FR_OK && fileInfo.fname[0])
 1597              		.loc 1 349 12 view .LVU418
 1598 0068 174B     		ldr	r3, .L130+24
 1599 006a 1870     		strb	r0, [r3]
 350:Core/Src/sd.c **** 				{
 1600              		.loc 1 350 5 is_stmt 1 view .LVU419
 350:Core/Src/sd.c **** 				{
 1601              		.loc 1 350 8 is_stmt 0 view .LVU420
 1602 006c E0B9     		cbnz	r0, .L123
 350:Core/Src/sd.c **** 				{
 1603              		.loc 1 350 40 discriminator 1 view .LVU421
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 39


 1604 006e 124B     		ldr	r3, .L130+8
 1605 0070 5B7A     		ldrb	r3, [r3, #9]	@ zero_extendqisi2
 350:Core/Src/sd.c **** 				{
 1606              		.loc 1 350 23 discriminator 1 view .LVU422
 1607 0072 CBB1     		cbz	r3, .L123
 352:Core/Src/sd.c **** 					//khi truyen buffer vao HAL_UART thi truyen vao dia chi dau tien cua mang se liet ke het danh 
 1608              		.loc 1 352 6 is_stmt 1 view .LVU423
 352:Core/Src/sd.c **** 					//khi truyen buffer vao HAL_UART thi truyen vao dia chi dau tien cua mang se liet ke het danh 
 1609              		.loc 1 352 19 is_stmt 0 view .LVU424
 1610 0074 104B     		ldr	r3, .L130+8
 1611 0076 9C69     		ldr	r4, [r3, #24]
 352:Core/Src/sd.c **** 					//khi truyen buffer vao HAL_UART thi truyen vao dia chi dau tien cua mang se liet ke het danh 
 1612              		.loc 1 352 9 view .LVU425
 1613 0078 174B     		ldr	r3, .L130+40
 1614 007a 1C60     		str	r4, [r3]
 354:Core/Src/sd.c **** 					else HAL_UART_Transmit(&huart2,(uint8_t*)fileInfo.fname,strlen((char*)fileInfo.fname),0x1000);
 1615              		.loc 1 354 6 is_stmt 1 view .LVU426
 354:Core/Src/sd.c **** 					else HAL_UART_Transmit(&huart2,(uint8_t*)fileInfo.fname,strlen((char*)fileInfo.fname),0x1000);
 1616              		.loc 1 354 9 is_stmt 0 view .LVU427
 1617 007c 2378     		ldrb	r3, [r4]	@ zero_extendqisi2
 354:Core/Src/sd.c **** 					else HAL_UART_Transmit(&huart2,(uint8_t*)fileInfo.fname,strlen((char*)fileInfo.fname),0x1000);
 1618              		.loc 1 354 8 view .LVU428
 1619 007e 002B     		cmp	r3, #0
 1620 0080 D7D0     		beq	.L124
 354:Core/Src/sd.c **** 					else HAL_UART_Transmit(&huart2,(uint8_t*)fileInfo.fname,strlen((char*)fileInfo.fname),0x1000);
 1621              		.loc 1 354 21 is_stmt 1 discriminator 1 view .LVU429
 354:Core/Src/sd.c **** 					else HAL_UART_Transmit(&huart2,(uint8_t*)fileInfo.fname,strlen((char*)fileInfo.fname),0x1000);
 1622              		.loc 1 354 60 is_stmt 0 discriminator 1 view .LVU430
 1623 0082 2046     		mov	r0, r4
 1624 0084 FFF7FEFF 		bl	strlen
 1625              	.LVL185:
 354:Core/Src/sd.c **** 					else HAL_UART_Transmit(&huart2,(uint8_t*)fileInfo.fname,strlen((char*)fileInfo.fname),0x1000);
 1626              		.loc 1 354 21 discriminator 1 view .LVU431
 1627 0088 4FF48053 		mov	r3, #4096
 1628 008c 82B2     		uxth	r2, r0
 1629 008e 2146     		mov	r1, r4
 1630 0090 0F48     		ldr	r0, .L130+32
 1631 0092 FFF7FEFF 		bl	HAL_UART_Transmit
 1632              	.LVL186:
 1633 0096 D7E7     		b	.L125
 1634              	.L129:
 358:Core/Src/sd.c **** 					}					
 1635              		.loc 1 358 7 is_stmt 1 view .LVU432
 1636 0098 4FF48053 		mov	r3, #4096
 1637 009c 0722     		movs	r2, #7
 1638 009e 0F49     		ldr	r1, .L130+44
 1639 00a0 0B48     		ldr	r0, .L130+32
 1640 00a2 FFF7FEFF 		bl	HAL_UART_Transmit
 1641              	.LVL187:
 1642 00a6 D4E7     		b	.L126
 1643              	.L123:
 364:Core/Src/sd.c **** 		}
 1644              		.loc 1 364 4 view .LVU433
 1645 00a8 0648     		ldr	r0, .L130+20
 1646 00aa FFF7FEFF 		bl	f_closedir
 1647              	.LVL188:
 1648              		.loc 1 367 1 is_stmt 0 view .LVU434
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 40


 1649 00ae B0E7     		b	.L120
 1650              	.L131:
 1651              		.align	2
 1652              	.L130:
 1653 00b0 00000000 		.word	USER_Path
 1654 00b4 00000000 		.word	SDFatFs
 1655 00b8 00000000 		.word	.LANCHOR5
 1656 00bc 00000000 		.word	.LANCHOR6
 1657 00c0 00000000 		.word	.LC3
 1658 00c4 00000000 		.word	dir
 1659 00c8 00000000 		.word	.LANCHOR7
 1660 00cc 09000000 		.word	.LANCHOR5+9
 1661 00d0 00000000 		.word	huart2
 1662 00d4 0C000000 		.word	.LC5
 1663 00d8 00000000 		.word	.LANCHOR8
 1664 00dc 04000000 		.word	.LC4
 1665              		.cfi_endproc
 1666              	.LFE79:
 1668              		.section	.rodata.SD_Amount_Space.str1.4,"aMS",%progbits,1
 1669              		.align	2
 1670              	.LC6:
 1671 0000 6672655F 		.ascii	"fre_clust: %lu\015\012\000"
 1671      636C7573 
 1671      743A2025 
 1671      6C750D0A 
 1671      00
 1672 0011 000000   		.align	2
 1673              	.LC7:
 1674 0014 6E5F6661 		.ascii	"n_fatent: %lu\015\012\000"
 1674      74656E74 
 1674      3A20256C 
 1674      750D0A00 
 1675              		.align	2
 1676              	.LC8:
 1677 0024 66735F63 		.ascii	"fs_csize: %d\015\012\000"
 1677      73697A65 
 1677      3A202564 
 1677      0D0A00
 1678 0033 00       		.align	2
 1679              	.LC9:
 1680 0034 746F745F 		.ascii	"tot_sect: %lu\015\012\000"
 1680      73656374 
 1680      3A20256C 
 1680      750D0A00 
 1681              		.align	2
 1682              	.LC10:
 1683 0044 6672655F 		.ascii	"fre_sect: %lu\015\012\000"
 1683      73656374 
 1683      3A20256C 
 1683      750D0A00 
 1684              		.align	2
 1685              	.LC11:
 1686 0054 256C7520 		.ascii	"%lu KB tong dung luong sd.\015\012%lu KB dung luong"
 1686      4B422074 
 1686      6F6E6720 
 1686      64756E67 
 1686      206C756F 
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 41


 1687 0081 20636F6E 		.ascii	" con lai.\015\012\000"
 1687      206C6169 
 1687      2E0D0A00 
 1688              		.section	.text.SD_Amount_Space,"ax",%progbits
 1689              		.align	1
 1690              		.global	SD_Amount_Space
 1691              		.syntax unified
 1692              		.thumb
 1693              		.thumb_func
 1695              	SD_Amount_Space:
 1696              	.LFB80:
 368:Core/Src/sd.c **** unsigned long SD_Amount_Space(void){
 1697              		.loc 1 368 36 is_stmt 1 view -0
 1698              		.cfi_startproc
 1699              		@ args = 0, pretend = 0, frame = 0
 1700              		@ frame_needed = 0, uses_anonymous_args = 0
 1701 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 1702              	.LCFI20:
 1703              		.cfi_def_cfa_offset 24
 1704              		.cfi_offset 4, -24
 1705              		.cfi_offset 5, -20
 1706              		.cfi_offset 6, -16
 1707              		.cfi_offset 7, -12
 1708              		.cfi_offset 8, -8
 1709              		.cfi_offset 14, -4
 369:Core/Src/sd.c **** 	f_getfree("/", &fre_clust, &fs); /* Get Number of Free Clusters                                   
 1710              		.loc 1 369 2 view .LVU436
 1711 0004 424E     		ldr	r6, .L134
 1712 0006 434F     		ldr	r7, .L134+4
 1713 0008 3246     		mov	r2, r6
 1714 000a 3946     		mov	r1, r7
 1715 000c 4248     		ldr	r0, .L134+8
 1716 000e FFF7FEFF 		bl	f_getfree
 1717              	.LVL189:
 370:Core/Src/sd.c **** 	sprintf(str1,"fre_clust: %lu\r\n",fre_clust);
 1718              		.loc 1 370 2 view .LVU437
 1719 0012 424C     		ldr	r4, .L134+12
 1720 0014 3A68     		ldr	r2, [r7]
 1721 0016 4249     		ldr	r1, .L134+16
 1722 0018 2046     		mov	r0, r4
 1723 001a FFF7FEFF 		bl	sprintf
 1724              	.LVL190:
 371:Core/Src/sd.c **** 	HAL_UART_Transmit(&huart2,(uint8_t*)str1,strlen(str1),0x1000);
 1725              		.loc 1 371 2 view .LVU438
 1726              		.loc 1 371 43 is_stmt 0 view .LVU439
 1727 001e 2046     		mov	r0, r4
 1728 0020 FFF7FEFF 		bl	strlen
 1729              	.LVL191:
 1730              		.loc 1 371 2 view .LVU440
 1731 0024 3F4D     		ldr	r5, .L134+20
 1732 0026 4FF48053 		mov	r3, #4096
 1733 002a 82B2     		uxth	r2, r0
 1734 002c 2146     		mov	r1, r4
 1735 002e 2846     		mov	r0, r5
 1736 0030 FFF7FEFF 		bl	HAL_UART_Transmit
 1737              	.LVL192:
 372:Core/Src/sd.c **** 	sprintf(str1,"n_fatent: %lu\r\n",fs->n_fatent);
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 42


 1738              		.loc 1 372 2 is_stmt 1 view .LVU441
 1739              		.loc 1 372 37 is_stmt 0 view .LVU442
 1740 0034 3368     		ldr	r3, [r6]
 1741              		.loc 1 372 2 view .LVU443
 1742 0036 03F58053 		add	r3, r3, #4096
 1743 003a 5A69     		ldr	r2, [r3, #20]
 1744 003c 3A49     		ldr	r1, .L134+24
 1745 003e 2046     		mov	r0, r4
 1746 0040 FFF7FEFF 		bl	sprintf
 1747              	.LVL193:
 373:Core/Src/sd.c **** 	HAL_UART_Transmit(&huart2,(uint8_t*)str1,strlen(str1),0x1000);
 1748              		.loc 1 373 2 is_stmt 1 view .LVU444
 1749              		.loc 1 373 43 is_stmt 0 view .LVU445
 1750 0044 2046     		mov	r0, r4
 1751 0046 FFF7FEFF 		bl	strlen
 1752              	.LVL194:
 1753              		.loc 1 373 2 view .LVU446
 1754 004a 4FF48053 		mov	r3, #4096
 1755 004e 82B2     		uxth	r2, r0
 1756 0050 2146     		mov	r1, r4
 1757 0052 2846     		mov	r0, r5
 1758 0054 FFF7FEFF 		bl	HAL_UART_Transmit
 1759              	.LVL195:
 374:Core/Src/sd.c **** 	sprintf(str1,"fs_csize: %d\r\n",fs->csize);
 1760              		.loc 1 374 2 is_stmt 1 view .LVU447
 1761              		.loc 1 374 36 is_stmt 0 view .LVU448
 1762 0058 3368     		ldr	r3, [r6]
 1763 005a 03F58053 		add	r3, r3, #4096
 1764              		.loc 1 374 2 view .LVU449
 1765 005e 9A78     		ldrb	r2, [r3, #2]	@ zero_extendqisi2
 1766 0060 3249     		ldr	r1, .L134+28
 1767 0062 2046     		mov	r0, r4
 1768 0064 FFF7FEFF 		bl	sprintf
 1769              	.LVL196:
 375:Core/Src/sd.c **** 	HAL_UART_Transmit(&huart2,(uint8_t*)str1,strlen(str1),0x1000);
 1770              		.loc 1 375 2 is_stmt 1 view .LVU450
 1771              		.loc 1 375 43 is_stmt 0 view .LVU451
 1772 0068 2046     		mov	r0, r4
 1773 006a FFF7FEFF 		bl	strlen
 1774              	.LVL197:
 1775              		.loc 1 375 2 view .LVU452
 1776 006e 4FF48053 		mov	r3, #4096
 1777 0072 82B2     		uxth	r2, r0
 1778 0074 2146     		mov	r1, r4
 1779 0076 2846     		mov	r0, r5
 1780 0078 FFF7FEFF 		bl	HAL_UART_Transmit
 1781              	.LVL198:
 376:Core/Src/sd.c **** 	tot_sect = (fs->n_fatent - 2) * fs->csize; /* Number of FAT entries, = number of clusters + 2 */
 1782              		.loc 1 376 2 is_stmt 1 view .LVU453
 1783              		.loc 1 376 16 is_stmt 0 view .LVU454
 1784 007c 3368     		ldr	r3, [r6]
 1785 007e 03F58053 		add	r3, r3, #4096
 1786 0082 5A69     		ldr	r2, [r3, #20]
 1787              		.loc 1 376 27 view .LVU455
 1788 0084 023A     		subs	r2, r2, #2
 1789              		.loc 1 376 36 view .LVU456
 1790 0086 9B78     		ldrb	r3, [r3, #2]	@ zero_extendqisi2
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 43


 1791              		.loc 1 376 32 view .LVU457
 1792 0088 03FB02F2 		mul	r2, r3, r2
 1793              		.loc 1 376 11 view .LVU458
 1794 008c DFF8A080 		ldr	r8, .L134+32
 1795 0090 C8F80020 		str	r2, [r8]
 377:Core/Src/sd.c **** 	sprintf(str1,"tot_sect: %lu\r\n",tot_sect);
 1796              		.loc 1 377 2 is_stmt 1 view .LVU459
 1797 0094 2749     		ldr	r1, .L134+36
 1798 0096 2046     		mov	r0, r4
 1799 0098 FFF7FEFF 		bl	sprintf
 1800              	.LVL199:
 378:Core/Src/sd.c **** 	HAL_UART_Transmit(&huart2,(uint8_t*)str1,strlen(str1),0x1000);
 1801              		.loc 1 378 2 view .LVU460
 1802              		.loc 1 378 43 is_stmt 0 view .LVU461
 1803 009c 2046     		mov	r0, r4
 1804 009e FFF7FEFF 		bl	strlen
 1805              	.LVL200:
 1806              		.loc 1 378 2 view .LVU462
 1807 00a2 4FF48053 		mov	r3, #4096
 1808 00a6 82B2     		uxth	r2, r0
 1809 00a8 2146     		mov	r1, r4
 1810 00aa 2846     		mov	r0, r5
 1811 00ac FFF7FEFF 		bl	HAL_UART_Transmit
 1812              	.LVL201:
 379:Core/Src/sd.c **** 	fre_sect = fre_clust * fs->csize;
 1813              		.loc 1 379 2 is_stmt 1 view .LVU463
 1814              		.loc 1 379 27 is_stmt 0 view .LVU464
 1815 00b0 3368     		ldr	r3, [r6]
 1816 00b2 03F58053 		add	r3, r3, #4096
 1817 00b6 9A78     		ldrb	r2, [r3, #2]	@ zero_extendqisi2
 1818              		.loc 1 379 23 view .LVU465
 1819 00b8 3B68     		ldr	r3, [r7]
 1820 00ba 03FB02F2 		mul	r2, r3, r2
 1821              		.loc 1 379 11 view .LVU466
 1822 00be 1E4E     		ldr	r6, .L134+40
 1823 00c0 3260     		str	r2, [r6]
 380:Core/Src/sd.c **** 	sprintf(str1,"fre_sect: %lu\r\n",fre_sect);
 1824              		.loc 1 380 2 is_stmt 1 view .LVU467
 1825 00c2 1E49     		ldr	r1, .L134+44
 1826 00c4 2046     		mov	r0, r4
 1827 00c6 FFF7FEFF 		bl	sprintf
 1828              	.LVL202:
 381:Core/Src/sd.c **** 	HAL_UART_Transmit(&huart2,(uint8_t*)str1,strlen(str1),0x1000);
 1829              		.loc 1 381 2 view .LVU468
 1830              		.loc 1 381 43 is_stmt 0 view .LVU469
 1831 00ca 2046     		mov	r0, r4
 1832 00cc FFF7FEFF 		bl	strlen
 1833              	.LVL203:
 1834              		.loc 1 381 2 view .LVU470
 1835 00d0 4FF48053 		mov	r3, #4096
 1836 00d4 82B2     		uxth	r2, r0
 1837 00d6 2146     		mov	r1, r4
 1838 00d8 2846     		mov	r0, r5
 1839 00da FFF7FEFF 		bl	HAL_UART_Transmit
 1840              	.LVL204:
 382:Core/Src/sd.c **** 	sprintf(str1, "%lu KB tong dung luong sd.\r\n%lu KB dung luong con lai.\r\n",
 1841              		.loc 1 382 2 is_stmt 1 view .LVU471
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 44


 1842 00de 3368     		ldr	r3, [r6]
 1843 00e0 D8F80020 		ldr	r2, [r8]
 1844 00e4 5B08     		lsrs	r3, r3, #1
 1845 00e6 5208     		lsrs	r2, r2, #1
 1846 00e8 1549     		ldr	r1, .L134+48
 1847 00ea 2046     		mov	r0, r4
 1848 00ec FFF7FEFF 		bl	sprintf
 1849              	.LVL205:
 383:Core/Src/sd.c **** 	tot_sect/2, fre_sect/2);
 384:Core/Src/sd.c **** 	HAL_UART_Transmit(&huart2,(uint8_t*)str1,strlen(str1),0x1000);
 1850              		.loc 1 384 2 view .LVU472
 1851              		.loc 1 384 43 is_stmt 0 view .LVU473
 1852 00f0 2046     		mov	r0, r4
 1853 00f2 FFF7FEFF 		bl	strlen
 1854              	.LVL206:
 1855              		.loc 1 384 2 view .LVU474
 1856 00f6 4FF48053 		mov	r3, #4096
 1857 00fa 82B2     		uxth	r2, r0
 1858 00fc 2146     		mov	r1, r4
 1859 00fe 2846     		mov	r0, r5
 1860 0100 FFF7FEFF 		bl	HAL_UART_Transmit
 1861              	.LVL207:
 385:Core/Src/sd.c **** 	FATFS_UnLinkDriver(USER_Path);
 1862              		.loc 1 385 2 is_stmt 1 view .LVU475
 1863 0104 0F48     		ldr	r0, .L134+52
 1864 0106 FFF7FEFF 		bl	FATFS_UnLinkDriver
 1865              	.LVL208:
 386:Core/Src/sd.c **** 	return fre_sect;
 1866              		.loc 1 386 2 view .LVU476
 387:Core/Src/sd.c **** }
 1867              		.loc 1 387 1 is_stmt 0 view .LVU477
 1868 010a 3068     		ldr	r0, [r6]
 1869 010c BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1870              	.L135:
 1871              		.align	2
 1872              	.L134:
 1873 0110 00000000 		.word	.LANCHOR9
 1874 0114 00000000 		.word	.LANCHOR10
 1875 0118 00000000 		.word	.LC3
 1876 011c 00000000 		.word	.LANCHOR1
 1877 0120 00000000 		.word	.LC6
 1878 0124 00000000 		.word	huart2
 1879 0128 14000000 		.word	.LC7
 1880 012c 24000000 		.word	.LC8
 1881 0130 00000000 		.word	.LANCHOR11
 1882 0134 34000000 		.word	.LC9
 1883 0138 00000000 		.word	.LANCHOR12
 1884 013c 44000000 		.word	.LC10
 1885 0140 54000000 		.word	.LC11
 1886 0144 00000000 		.word	USER_Path
 1887              		.cfi_endproc
 1888              	.LFE80:
 1890              		.section	.text._ReadLongFile,"ax",%progbits
 1891              		.align	1
 1892              		.global	_ReadLongFile
 1893              		.syntax unified
 1894              		.thumb
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 45


 1895              		.thumb_func
 1897              	_ReadLongFile:
 1898              	.LVL209:
 1899              	.LFB81:
 388:Core/Src/sd.c **** //--------------------------------------------------
 389:Core/Src/sd.c **** FRESULT _ReadLongFile(uint16_t numbyte,uint16_t index)
 390:Core/Src/sd.c **** {
 1900              		.loc 1 390 1 is_stmt 1 view -0
 1901              		.cfi_startproc
 1902              		@ args = 0, pretend = 0, frame = 0
 1903              		@ frame_needed = 0, uses_anonymous_args = 0
 1904              		.loc 1 390 1 is_stmt 0 view .LVU479
 1905 0000 38B5     		push	{r3, r4, r5, lr}
 1906              	.LCFI21:
 1907              		.cfi_def_cfa_offset 16
 1908              		.cfi_offset 3, -16
 1909              		.cfi_offset 4, -12
 1910              		.cfi_offset 5, -8
 1911              		.cfi_offset 14, -4
 1912 0002 0446     		mov	r4, r0
 391:Core/Src/sd.c **** 	f_lseek(&MyFile,index);
 1913              		.loc 1 391 2 is_stmt 1 view .LVU480
 1914 0004 054D     		ldr	r5, .L138
 1915 0006 2846     		mov	r0, r5
 1916              	.LVL210:
 1917              		.loc 1 391 2 is_stmt 0 view .LVU481
 1918 0008 FFF7FEFF 		bl	f_lseek
 1919              	.LVL211:
 392:Core/Src/sd.c **** 	f_read(&MyFile,SD.rdata,numbyte,(UINT *)&bytesread);
 1920              		.loc 1 392 2 is_stmt 1 view .LVU482
 1921 000c 044B     		ldr	r3, .L138+4
 1922 000e 2246     		mov	r2, r4
 1923 0010 0449     		ldr	r1, .L138+8
 1924 0012 2846     		mov	r0, r5
 1925 0014 FFF7FEFF 		bl	f_read
 1926              	.LVL212:
 393:Core/Src/sd.c ****   return FR_OK;
 1927              		.loc 1 393 3 view .LVU483
 394:Core/Src/sd.c **** }
 1928              		.loc 1 394 1 is_stmt 0 view .LVU484
 1929 0018 0020     		movs	r0, #0
 1930 001a 38BD     		pop	{r3, r4, r5, pc}
 1931              	.L139:
 1932              		.align	2
 1933              	.L138:
 1934 001c 00000000 		.word	MyFile
 1935 0020 00000000 		.word	.LANCHOR2
 1936 0024 01000000 		.word	SD+1
 1937              		.cfi_endproc
 1938              	.LFE81:
 1940              		.section	.text._SD_Read_File,"ax",%progbits
 1941              		.align	1
 1942              		.global	_SD_Read_File
 1943              		.syntax unified
 1944              		.thumb
 1945              		.thumb_func
 1947              	_SD_Read_File:
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 46


 1948              	.LVL213:
 1949              	.LFB82:
 395:Core/Src/sd.c **** 
 396:Core/Src/sd.c **** uint8_t* _SD_Read_File(const char* filename,uint16_t numbyte,uint16_t index){
 1950              		.loc 1 396 77 is_stmt 1 view -0
 1951              		.cfi_startproc
 1952              		@ args = 0, pretend = 0, frame = 0
 1953              		@ frame_needed = 0, uses_anonymous_args = 0
 1954              		.loc 1 396 77 is_stmt 0 view .LVU486
 1955 0000 70B5     		push	{r4, r5, r6, lr}
 1956              	.LCFI22:
 1957              		.cfi_def_cfa_offset 16
 1958              		.cfi_offset 4, -16
 1959              		.cfi_offset 5, -12
 1960              		.cfi_offset 6, -8
 1961              		.cfi_offset 14, -4
 1962 0002 0446     		mov	r4, r0
 1963 0004 0D46     		mov	r5, r1
 1964 0006 1646     		mov	r6, r2
 397:Core/Src/sd.c **** 	if(f_mount(&SDFatFs,(TCHAR const*)USER_Path,0)!=FR_OK)
 1965              		.loc 1 397 2 is_stmt 1 view .LVU487
 1966              		.loc 1 397 5 is_stmt 0 view .LVU488
 1967 0008 0022     		movs	r2, #0
 1968              	.LVL214:
 1969              		.loc 1 397 5 view .LVU489
 1970 000a 0D49     		ldr	r1, .L145
 1971              	.LVL215:
 1972              		.loc 1 397 5 view .LVU490
 1973 000c 0D48     		ldr	r0, .L145+4
 1974              	.LVL216:
 1975              		.loc 1 397 5 view .LVU491
 1976 000e FFF7FEFF 		bl	f_mount
 1977              	.LVL217:
 1978              		.loc 1 397 4 view .LVU492
 1979 0012 18B1     		cbz	r0, .L141
 398:Core/Src/sd.c **** 		{ 
 399:Core/Src/sd.c **** 			Error_Handler();
 1980              		.loc 1 399 4 is_stmt 1 view .LVU493
 1981 0014 FFF7FEFF 		bl	Error_Handler
 1982              	.LVL218:
 1983              	.L142:
 400:Core/Src/sd.c **** 		}
 401:Core/Src/sd.c **** 		else
 402:Core/Src/sd.c **** 		{
 403:Core/Src/sd.c **** 			if(f_open(&MyFile,filename,FA_READ|FA_OPEN_EXISTING)!=FR_OK)
 404:Core/Src/sd.c **** 			{
 405:Core/Src/sd.c **** 				Error_Handler();
 406:Core/Src/sd.c **** 			}
 407:Core/Src/sd.c **** 			else
 408:Core/Src/sd.c **** 			{
 409:Core/Src/sd.c **** 				_ReadLongFile(numbyte,index);
 410:Core/Src/sd.c **** 				f_close(&MyFile);
 411:Core/Src/sd.c **** 			}
 412:Core/Src/sd.c **** 		 }
 413:Core/Src/sd.c **** 	return SD.rdata;
 1984              		.loc 1 413 2 view .LVU494
 414:Core/Src/sd.c **** }
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 47


 1985              		.loc 1 414 1 is_stmt 0 view .LVU495
 1986 0018 0B48     		ldr	r0, .L145+8
 1987 001a 70BD     		pop	{r4, r5, r6, pc}
 1988              	.LVL219:
 1989              	.L141:
 403:Core/Src/sd.c **** 			{
 1990              		.loc 1 403 4 is_stmt 1 view .LVU496
 403:Core/Src/sd.c **** 			{
 1991              		.loc 1 403 7 is_stmt 0 view .LVU497
 1992 001c 0122     		movs	r2, #1
 1993 001e 2146     		mov	r1, r4
 1994 0020 0A48     		ldr	r0, .L145+12
 1995 0022 FFF7FEFF 		bl	f_open
 1996              	.LVL220:
 403:Core/Src/sd.c **** 			{
 1997              		.loc 1 403 6 view .LVU498
 1998 0026 10B1     		cbz	r0, .L143
 405:Core/Src/sd.c **** 			}
 1999              		.loc 1 405 5 is_stmt 1 view .LVU499
 2000 0028 FFF7FEFF 		bl	Error_Handler
 2001              	.LVL221:
 2002 002c F4E7     		b	.L142
 2003              	.L143:
 409:Core/Src/sd.c **** 				f_close(&MyFile);
 2004              		.loc 1 409 5 view .LVU500
 2005 002e 3146     		mov	r1, r6
 2006 0030 2846     		mov	r0, r5
 2007 0032 FFF7FEFF 		bl	_ReadLongFile
 2008              	.LVL222:
 410:Core/Src/sd.c **** 			}
 2009              		.loc 1 410 5 view .LVU501
 2010 0036 0548     		ldr	r0, .L145+12
 2011 0038 FFF7FEFF 		bl	f_close
 2012              	.LVL223:
 2013 003c ECE7     		b	.L142
 2014              	.L146:
 2015 003e 00BF     		.align	2
 2016              	.L145:
 2017 0040 00000000 		.word	USER_Path
 2018 0044 00000000 		.word	SDFatFs
 2019 0048 01000000 		.word	SD+1
 2020 004c 00000000 		.word	MyFile
 2021              		.cfi_endproc
 2022              	.LFE82:
 2024              		.section	.text.SD_creatSubDir,"ax",%progbits
 2025              		.align	1
 2026              		.global	SD_creatSubDir
 2027              		.syntax unified
 2028              		.thumb
 2029              		.thumb_func
 2031              	SD_creatSubDir:
 2032              	.LVL224:
 2033              	.LFB83:
 415:Core/Src/sd.c **** //-------------------------------------------------- Ham tao thu muc con 
 416:Core/Src/sd.c **** void SD_creatSubDir(char* filename)
 417:Core/Src/sd.c **** {
 2034              		.loc 1 417 1 view -0
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 48


 2035              		.cfi_startproc
 2036              		@ args = 0, pretend = 0, frame = 0
 2037              		@ frame_needed = 0, uses_anonymous_args = 0
 2038              		.loc 1 417 1 is_stmt 0 view .LVU503
 2039 0000 10B5     		push	{r4, lr}
 2040              	.LCFI23:
 2041              		.cfi_def_cfa_offset 8
 2042              		.cfi_offset 4, -8
 2043              		.cfi_offset 14, -4
 2044 0002 0446     		mov	r4, r0
 418:Core/Src/sd.c **** 	if(f_mount(&SDFatFs,(TCHAR const*)USER_Path,0)!=FR_OK)
 2045              		.loc 1 418 2 is_stmt 1 view .LVU504
 2046              		.loc 1 418 5 is_stmt 0 view .LVU505
 2047 0004 0022     		movs	r2, #0
 2048 0006 0F49     		ldr	r1, .L152
 2049 0008 0F48     		ldr	r0, .L152+4
 2050              	.LVL225:
 2051              		.loc 1 418 5 view .LVU506
 2052 000a FFF7FEFF 		bl	f_mount
 2053              	.LVL226:
 2054              		.loc 1 418 4 view .LVU507
 2055 000e 10B1     		cbz	r0, .L148
 419:Core/Src/sd.c **** 	{
 420:Core/Src/sd.c **** 		Error_Handler();
 2056              		.loc 1 420 3 is_stmt 1 view .LVU508
 2057 0010 FFF7FEFF 		bl	Error_Handler
 2058              	.LVL227:
 2059              	.L147:
 421:Core/Src/sd.c **** 	}
 422:Core/Src/sd.c **** 	else
 423:Core/Src/sd.c **** 	{
 424:Core/Src/sd.c **** 		res = f_stat(filename,&fileInfo);
 425:Core/Src/sd.c **** 		switch(res)
 426:Core/Src/sd.c **** 		{
 427:Core/Src/sd.c **** 			case FR_OK:
 428:Core/Src/sd.c **** 				break;
 429:Core/Src/sd.c **** 			case FR_NO_FILE:
 430:Core/Src/sd.c **** 				res = f_mkdir(filename);
 431:Core/Src/sd.c **** 				if(res != FR_OK) Error_Handler();
 432:Core/Src/sd.c **** 				break;
 433:Core/Src/sd.c **** 			default:
 434:Core/Src/sd.c **** 				Error_Handler();
 435:Core/Src/sd.c **** 		}
 436:Core/Src/sd.c **** 	}
 437:Core/Src/sd.c **** }
 2060              		.loc 1 437 1 is_stmt 0 view .LVU509
 2061 0014 10BD     		pop	{r4, pc}
 2062              	.LVL228:
 2063              	.L148:
 424:Core/Src/sd.c **** 		switch(res)
 2064              		.loc 1 424 3 is_stmt 1 view .LVU510
 424:Core/Src/sd.c **** 		switch(res)
 2065              		.loc 1 424 9 is_stmt 0 view .LVU511
 2066 0016 0D49     		ldr	r1, .L152+8
 2067 0018 2046     		mov	r0, r4
 2068 001a FFF7FEFF 		bl	f_stat
 2069              	.LVL229:
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 49


 424:Core/Src/sd.c **** 		switch(res)
 2070              		.loc 1 424 7 view .LVU512
 2071 001e 0C4B     		ldr	r3, .L152+12
 2072 0020 1870     		strb	r0, [r3]
 425:Core/Src/sd.c **** 		{
 2073              		.loc 1 425 3 is_stmt 1 view .LVU513
 2074 0022 0028     		cmp	r0, #0
 2075 0024 F6D0     		beq	.L147
 2076 0026 0428     		cmp	r0, #4
 2077 0028 09D1     		bne	.L150
 430:Core/Src/sd.c **** 				if(res != FR_OK) Error_Handler();
 2078              		.loc 1 430 5 view .LVU514
 430:Core/Src/sd.c **** 				if(res != FR_OK) Error_Handler();
 2079              		.loc 1 430 11 is_stmt 0 view .LVU515
 2080 002a 2046     		mov	r0, r4
 2081 002c FFF7FEFF 		bl	f_mkdir
 2082              	.LVL230:
 430:Core/Src/sd.c **** 				if(res != FR_OK) Error_Handler();
 2083              		.loc 1 430 9 view .LVU516
 2084 0030 074B     		ldr	r3, .L152+12
 2085 0032 1870     		strb	r0, [r3]
 431:Core/Src/sd.c **** 				break;
 2086              		.loc 1 431 5 is_stmt 1 view .LVU517
 431:Core/Src/sd.c **** 				break;
 2087              		.loc 1 431 7 is_stmt 0 view .LVU518
 2088 0034 0028     		cmp	r0, #0
 2089 0036 EDD0     		beq	.L147
 431:Core/Src/sd.c **** 				break;
 2090              		.loc 1 431 22 is_stmt 1 discriminator 1 view .LVU519
 2091 0038 FFF7FEFF 		bl	Error_Handler
 2092              	.LVL231:
 2093 003c EAE7     		b	.L147
 2094              	.L150:
 434:Core/Src/sd.c **** 		}
 2095              		.loc 1 434 5 view .LVU520
 2096 003e FFF7FEFF 		bl	Error_Handler
 2097              	.LVL232:
 2098              		.loc 1 437 1 is_stmt 0 view .LVU521
 2099 0042 E7E7     		b	.L147
 2100              	.L153:
 2101              		.align	2
 2102              	.L152:
 2103 0044 00000000 		.word	USER_Path
 2104 0048 00000000 		.word	SDFatFs
 2105 004c 00000000 		.word	.LANCHOR5
 2106 0050 00000000 		.word	.LANCHOR3
 2107              		.cfi_endproc
 2108              	.LFE83:
 2110              		.section	.rodata.SD_deleteFile.str1.4,"aMS",%progbits,1
 2111              		.align	2
 2112              	.LC12:
 2113 0000 44656C65 		.ascii	"Delete successed\000"
 2113      74652073 
 2113      75636365 
 2113      73736564 
 2113      00
 2114 0011 000000   		.align	2
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 50


 2115              	.LC13:
 2116 0014 25730D0A 		.ascii	"%s\015\012\000"
 2116      00
 2117 0019 000000   		.align	2
 2118              	.LC14:
 2119 001c 46696C65 		.ascii	"File is not exist\000"
 2119      20697320 
 2119      6E6F7420 
 2119      65786973 
 2119      7400
 2120              		.section	.text.SD_deleteFile,"ax",%progbits
 2121              		.align	1
 2122              		.global	SD_deleteFile
 2123              		.syntax unified
 2124              		.thumb
 2125              		.thumb_func
 2127              	SD_deleteFile:
 2128              	.LVL233:
 2129              	.LFB84:
 438:Core/Src/sd.c **** //-------------------------------------------------- Ham xoa file
 439:Core/Src/sd.c **** void SD_deleteFile(char* filename)
 440:Core/Src/sd.c **** {
 2130              		.loc 1 440 1 is_stmt 1 view -0
 2131              		.cfi_startproc
 2132              		@ args = 0, pretend = 0, frame = 0
 2133              		@ frame_needed = 0, uses_anonymous_args = 0
 2134              		.loc 1 440 1 is_stmt 0 view .LVU523
 2135 0000 10B5     		push	{r4, lr}
 2136              	.LCFI24:
 2137              		.cfi_def_cfa_offset 8
 2138              		.cfi_offset 4, -8
 2139              		.cfi_offset 14, -4
 2140 0002 0446     		mov	r4, r0
 441:Core/Src/sd.c **** 	res = f_stat(filename,&fileInfo);
 2141              		.loc 1 441 2 is_stmt 1 view .LVU524
 2142              		.loc 1 441 8 is_stmt 0 view .LVU525
 2143 0004 1849     		ldr	r1, .L159
 2144 0006 FFF7FEFF 		bl	f_stat
 2145              	.LVL234:
 2146              		.loc 1 441 6 view .LVU526
 2147 000a 184B     		ldr	r3, .L159+4
 2148 000c 1870     		strb	r0, [r3]
 442:Core/Src/sd.c **** 	if(res == FR_OK)
 2149              		.loc 1 442 2 is_stmt 1 view .LVU527
 2150              		.loc 1 442 4 is_stmt 0 view .LVU528
 2151 000e C8B9     		cbnz	r0, .L155
 443:Core/Src/sd.c **** 	{
 444:Core/Src/sd.c **** 		res = f_unlink(filename);
 2152              		.loc 1 444 3 is_stmt 1 view .LVU529
 2153              		.loc 1 444 9 is_stmt 0 view .LVU530
 2154 0010 2046     		mov	r0, r4
 2155 0012 FFF7FEFF 		bl	f_unlink
 2156              	.LVL235:
 2157              		.loc 1 444 7 view .LVU531
 2158 0016 154B     		ldr	r3, .L159+4
 2159 0018 1870     		strb	r0, [r3]
 445:Core/Src/sd.c **** 		if(res == FR_OK)
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 51


 2160              		.loc 1 445 3 is_stmt 1 view .LVU532
 2161              		.loc 1 445 5 is_stmt 0 view .LVU533
 2162 001a 80B9     		cbnz	r0, .L156
 2163              	.LBB3:
 446:Core/Src/sd.c **** 		{
 447:Core/Src/sd.c **** 			sprintf(str1,"%s\r\n","Delete successed");
 2164              		.loc 1 447 4 is_stmt 1 view .LVU534
 2165 001c 144C     		ldr	r4, .L159+8
 2166              	.LVL236:
 2167              		.loc 1 447 4 is_stmt 0 view .LVU535
 2168 001e 154A     		ldr	r2, .L159+12
 2169 0020 1549     		ldr	r1, .L159+16
 2170 0022 2046     		mov	r0, r4
 2171 0024 FFF7FEFF 		bl	sprintf
 2172              	.LVL237:
 448:Core/Src/sd.c **** 			HAL_UART_Transmit(&huart2,(uint8_t*)str1,strlen(str1),0x1000);
 2173              		.loc 1 448 4 is_stmt 1 view .LVU536
 2174              		.loc 1 448 45 is_stmt 0 view .LVU537
 2175 0028 2046     		mov	r0, r4
 2176 002a FFF7FEFF 		bl	strlen
 2177              	.LVL238:
 2178              		.loc 1 448 4 view .LVU538
 2179 002e 4FF48053 		mov	r3, #4096
 2180 0032 82B2     		uxth	r2, r0
 2181 0034 2146     		mov	r1, r4
 2182 0036 1148     		ldr	r0, .L159+20
 2183 0038 FFF7FEFF 		bl	HAL_UART_Transmit
 2184              	.LVL239:
 2185              	.LBE3:
 2186 003c 12E0     		b	.L154
 2187              	.LVL240:
 2188              	.L156:
 449:Core/Src/sd.c **** 		}
 450:Core/Src/sd.c **** 		else
 451:Core/Src/sd.c **** 		{
 452:Core/Src/sd.c **** 			Error_Handler();
 2189              		.loc 1 452 4 is_stmt 1 view .LVU539
 2190 003e FFF7FEFF 		bl	Error_Handler
 2191              	.LVL241:
 2192 0042 0FE0     		b	.L154
 2193              	.L155:
 2194              	.LBB4:
 453:Core/Src/sd.c **** 		}
 454:Core/Src/sd.c **** 	}
 455:Core/Src/sd.c **** 	else
 456:Core/Src/sd.c **** 	{
 457:Core/Src/sd.c **** 		sprintf(str1,"%s\r\n","File is not exist");
 2195              		.loc 1 457 3 view .LVU540
 2196 0044 0A4C     		ldr	r4, .L159+8
 2197              	.LVL242:
 2198              		.loc 1 457 3 is_stmt 0 view .LVU541
 2199 0046 0E4A     		ldr	r2, .L159+24
 2200 0048 0B49     		ldr	r1, .L159+16
 2201 004a 2046     		mov	r0, r4
 2202 004c FFF7FEFF 		bl	sprintf
 2203              	.LVL243:
 458:Core/Src/sd.c **** 		HAL_UART_Transmit(&huart2,(uint8_t*)str1,strlen(str1),0x1000);
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 52


 2204              		.loc 1 458 3 is_stmt 1 view .LVU542
 2205              		.loc 1 458 44 is_stmt 0 view .LVU543
 2206 0050 2046     		mov	r0, r4
 2207 0052 FFF7FEFF 		bl	strlen
 2208              	.LVL244:
 2209              		.loc 1 458 3 view .LVU544
 2210 0056 4FF48053 		mov	r3, #4096
 2211 005a 82B2     		uxth	r2, r0
 2212 005c 2146     		mov	r1, r4
 2213 005e 0748     		ldr	r0, .L159+20
 2214 0060 FFF7FEFF 		bl	HAL_UART_Transmit
 2215              	.LVL245:
 2216              	.L154:
 2217              	.LBE4:
 459:Core/Src/sd.c **** 	}
 460:Core/Src/sd.c **** }
 2218              		.loc 1 460 1 view .LVU545
 2219 0064 10BD     		pop	{r4, pc}
 2220              	.L160:
 2221 0066 00BF     		.align	2
 2222              	.L159:
 2223 0068 00000000 		.word	.LANCHOR5
 2224 006c 00000000 		.word	.LANCHOR3
 2225 0070 00000000 		.word	.LANCHOR1
 2226 0074 00000000 		.word	.LC12
 2227 0078 14000000 		.word	.LC13
 2228 007c 00000000 		.word	huart2
 2229 0080 1C000000 		.word	.LC14
 2230              		.cfi_endproc
 2231              	.LFE84:
 2233              		.section	.text.delete_node,"ax",%progbits
 2234              		.align	1
 2235              		.global	delete_node
 2236              		.syntax unified
 2237              		.thumb
 2238              		.thumb_func
 2240              	delete_node:
 2241              	.LVL246:
 2242              	.LFB85:
 461:Core/Src/sd.c **** /*------------------------------------------------------------/
 462:Core/Src/sd.c **** / Delete a sub-directory even if it contains any file
 463:Core/Src/sd.c **** /-------------------------------------------------------------/
 464:Core/Src/sd.c **** */
 465:Core/Src/sd.c **** FRESULT delete_node (
 466:Core/Src/sd.c ****     TCHAR* path,    /* Path name buffer with the sub-directory to delete */
 467:Core/Src/sd.c ****     UINT sz_buff,   /* Size of path name buffer (items) */
 468:Core/Src/sd.c ****     FILINFO* fno    /* Name read buffer */
 469:Core/Src/sd.c **** )
 470:Core/Src/sd.c **** {
 2243              		.loc 1 470 1 is_stmt 1 view -0
 2244              		.cfi_startproc
 2245              		@ args = 0, pretend = 0, frame = 4136
 2246              		@ frame_needed = 0, uses_anonymous_args = 0
 2247              		.loc 1 470 1 is_stmt 0 view .LVU547
 2248 0000 2DE9F043 		push	{r4, r5, r6, r7, r8, r9, lr}
 2249              	.LCFI25:
 2250              		.cfi_def_cfa_offset 28
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 53


 2251              		.cfi_offset 4, -28
 2252              		.cfi_offset 5, -24
 2253              		.cfi_offset 6, -20
 2254              		.cfi_offset 7, -16
 2255              		.cfi_offset 8, -12
 2256              		.cfi_offset 9, -8
 2257              		.cfi_offset 14, -4
 2258 0004 ADF5815D 		sub	sp, sp, #4128
 2259              	.LCFI26:
 2260              		.cfi_def_cfa_offset 4156
 2261 0008 83B0     		sub	sp, sp, #12
 2262              	.LCFI27:
 2263              		.cfi_def_cfa_offset 4168
 2264 000a 0546     		mov	r5, r0
 2265 000c 0F46     		mov	r7, r1
 2266 000e 1646     		mov	r6, r2
 471:Core/Src/sd.c ****     UINT i, j;
 2267              		.loc 1 471 5 is_stmt 1 view .LVU548
 472:Core/Src/sd.c ****     FRESULT fr;
 2268              		.loc 1 472 5 view .LVU549
 473:Core/Src/sd.c ****     DIR dir;
 2269              		.loc 1 473 5 view .LVU550
 474:Core/Src/sd.c **** 
 475:Core/Src/sd.c **** 
 476:Core/Src/sd.c ****     fr = f_opendir(&dir, path); /* Open the directory */
 2270              		.loc 1 476 5 view .LVU551
 2271              		.loc 1 476 10 is_stmt 0 view .LVU552
 2272 0010 0146     		mov	r1, r0
 2273              	.LVL247:
 2274              		.loc 1 476 10 view .LVU553
 2275 0012 6846     		mov	r0, sp
 2276              	.LVL248:
 2277              		.loc 1 476 10 view .LVU554
 2278 0014 FFF7FEFF 		bl	f_opendir
 2279              	.LVL249:
 477:Core/Src/sd.c ****     if (fr != FR_OK) return fr;
 2280              		.loc 1 477 5 is_stmt 1 view .LVU555
 2281              		.loc 1 477 8 is_stmt 0 view .LVU556
 2282 0018 8146     		mov	r9, r0
 2283 001a 0028     		cmp	r0, #0
 2284 001c 3CD1     		bne	.L162
 478:Core/Src/sd.c **** 
 479:Core/Src/sd.c ****     for (i = 0; path[i]; i++) ; /* Get current path length */
 2285              		.loc 1 479 12 view .LVU557
 2286 001e 0024     		movs	r4, #0
 2287 0020 00E0     		b	.L163
 2288              	.LVL250:
 2289              	.L164:
 2290              		.loc 1 479 31 is_stmt 1 discriminator 3 view .LVU558
 2291              		.loc 1 479 26 discriminator 3 view .LVU559
 2292              		.loc 1 479 27 is_stmt 0 discriminator 3 view .LVU560
 2293 0022 0134     		adds	r4, r4, #1
 2294              	.LVL251:
 2295              	.L163:
 2296              		.loc 1 479 17 is_stmt 1 discriminator 1 view .LVU561
 2297              		.loc 1 479 21 is_stmt 0 discriminator 1 view .LVU562
 2298 0024 05EB0408 		add	r8, r5, r4
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 54


 2299 0028 2B5D     		ldrb	r3, [r5, r4]	@ zero_extendqisi2
 2300              		.loc 1 479 5 discriminator 1 view .LVU563
 2301 002a 002B     		cmp	r3, #0
 2302 002c F9D1     		bne	.L164
 480:Core/Src/sd.c ****     path[i++] = _T('/');
 2303              		.loc 1 480 5 is_stmt 1 view .LVU564
 2304              		.loc 1 480 11 is_stmt 0 view .LVU565
 2305 002e 0134     		adds	r4, r4, #1
 2306              	.LVL252:
 2307              		.loc 1 480 15 view .LVU566
 2308 0030 2F23     		movs	r3, #47
 2309 0032 88F80030 		strb	r3, [r8]
 2310 0036 0CE0     		b	.L170
 2311              	.LVL253:
 2312              	.L166:
 481:Core/Src/sd.c **** 
 482:Core/Src/sd.c ****     for (;;) {
 483:Core/Src/sd.c ****         fr = f_readdir(&dir, fno);  /* Get a directory item */
 484:Core/Src/sd.c ****         if (fr != FR_OK || !fno->fname[0]) break;   /* End of directory? */
 485:Core/Src/sd.c ****         j = 0;
 486:Core/Src/sd.c ****         do {    /* Make a path name */
 487:Core/Src/sd.c ****             if (i + j >= sz_buff) { /* Buffer over flow? */
 488:Core/Src/sd.c ****                 fr = 100; break;    /* Fails with 100 when buffer overflow */
 489:Core/Src/sd.c ****             }
 490:Core/Src/sd.c ****             path[i + j] = fno->fname[j];
 491:Core/Src/sd.c ****         } while (fno->fname[j++]);
 492:Core/Src/sd.c ****         if (fno->fattrib & AM_DIR) {    /* Item is a directory */
 2313              		.loc 1 492 9 is_stmt 1 view .LVU567
 2314              		.loc 1 492 16 is_stmt 0 view .LVU568
 2315 0038 337A     		ldrb	r3, [r6, #8]	@ zero_extendqisi2
 2316              	.LVL254:
 2317              		.loc 1 492 12 view .LVU569
 2318 003a 13F0100F 		tst	r3, #16
 2319 003e 1DD0     		beq	.L168
 493:Core/Src/sd.c ****             fr = delete_node(path, sz_buff, fno);
 2320              		.loc 1 493 13 is_stmt 1 view .LVU570
 2321              		.loc 1 493 18 is_stmt 0 view .LVU571
 2322 0040 3246     		mov	r2, r6
 2323 0042 3946     		mov	r1, r7
 2324 0044 2846     		mov	r0, r5
 2325 0046 FFF7FEFF 		bl	delete_node
 2326              	.LVL255:
 2327 004a 8146     		mov	r9, r0
 2328              	.LVL256:
 2329              	.L169:
 494:Core/Src/sd.c ****         } else {                        /* Item is a file */
 495:Core/Src/sd.c ****             fr = f_unlink(path);
 496:Core/Src/sd.c ****         }
 497:Core/Src/sd.c ****         if (fr != FR_OK) break;
 2330              		.loc 1 497 9 is_stmt 1 view .LVU572
 2331              		.loc 1 497 12 is_stmt 0 view .LVU573
 2332 004c B9F1000F 		cmp	r9, #0
 2333 0050 19D1     		bne	.L165
 2334              	.LVL257:
 2335              	.L170:
 482:Core/Src/sd.c ****         fr = f_readdir(&dir, fno);  /* Get a directory item */
 2336              		.loc 1 482 5 is_stmt 1 view .LVU574
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 55


 483:Core/Src/sd.c ****         if (fr != FR_OK || !fno->fname[0]) break;   /* End of directory? */
 2337              		.loc 1 483 9 view .LVU575
 483:Core/Src/sd.c ****         if (fr != FR_OK || !fno->fname[0]) break;   /* End of directory? */
 2338              		.loc 1 483 14 is_stmt 0 view .LVU576
 2339 0052 3146     		mov	r1, r6
 2340 0054 6846     		mov	r0, sp
 2341 0056 FFF7FEFF 		bl	f_readdir
 2342              	.LVL258:
 484:Core/Src/sd.c ****         j = 0;
 2343              		.loc 1 484 9 is_stmt 1 view .LVU577
 484:Core/Src/sd.c ****         j = 0;
 2344              		.loc 1 484 12 is_stmt 0 view .LVU578
 2345 005a 8146     		mov	r9, r0
 2346 005c 98B9     		cbnz	r0, .L165
 484:Core/Src/sd.c ****         j = 0;
 2347              		.loc 1 484 39 discriminator 1 view .LVU579
 2348 005e 737A     		ldrb	r3, [r6, #9]	@ zero_extendqisi2
 484:Core/Src/sd.c ****         j = 0;
 2349              		.loc 1 484 25 discriminator 1 view .LVU580
 2350 0060 8BB1     		cbz	r3, .L165
 485:Core/Src/sd.c ****         do {    /* Make a path name */
 2351              		.loc 1 485 11 view .LVU581
 2352 0062 0023     		movs	r3, #0
 2353              	.L167:
 2354              	.LVL259:
 486:Core/Src/sd.c ****             if (i + j >= sz_buff) { /* Buffer over flow? */
 2355              		.loc 1 486 9 is_stmt 1 view .LVU582
 487:Core/Src/sd.c ****                 fr = 100; break;    /* Fails with 100 when buffer overflow */
 2356              		.loc 1 487 13 view .LVU583
 487:Core/Src/sd.c ****                 fr = 100; break;    /* Fails with 100 when buffer overflow */
 2357              		.loc 1 487 19 is_stmt 0 view .LVU584
 2358 0064 03EB040C 		add	ip, r3, r4
 487:Core/Src/sd.c ****                 fr = 100; break;    /* Fails with 100 when buffer overflow */
 2359              		.loc 1 487 16 view .LVU585
 2360 0068 BC45     		cmp	ip, r7
 2361 006a E5D2     		bcs	.L166
 490:Core/Src/sd.c ****         } while (fno->fname[j++]);
 2362              		.loc 1 490 13 is_stmt 1 view .LVU586
 490:Core/Src/sd.c ****         } while (fno->fname[j++]);
 2363              		.loc 1 490 37 is_stmt 0 view .LVU587
 2364 006c F218     		adds	r2, r6, r3
 2365 006e 527A     		ldrb	r2, [r2, #9]	@ zero_extendqisi2
 490:Core/Src/sd.c ****         } while (fno->fname[j++]);
 2366              		.loc 1 490 25 view .LVU588
 2367 0070 05F80C20 		strb	r2, [r5, ip]
 491:Core/Src/sd.c ****         if (fno->fattrib & AM_DIR) {    /* Item is a directory */
 2368              		.loc 1 491 17 is_stmt 1 view .LVU589
 491:Core/Src/sd.c ****         if (fno->fattrib & AM_DIR) {    /* Item is a directory */
 2369              		.loc 1 491 30 is_stmt 0 view .LVU590
 2370 0074 0133     		adds	r3, r3, #1
 2371              	.LVL260:
 491:Core/Src/sd.c ****         if (fno->fattrib & AM_DIR) {    /* Item is a directory */
 2372              		.loc 1 491 9 view .LVU591
 2373 0076 002A     		cmp	r2, #0
 2374 0078 F4D1     		bne	.L167
 2375 007a DDE7     		b	.L166
 2376              	.LVL261:
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 56


 2377              	.L168:
 495:Core/Src/sd.c ****         }
 2378              		.loc 1 495 13 is_stmt 1 view .LVU592
 495:Core/Src/sd.c ****         }
 2379              		.loc 1 495 18 is_stmt 0 view .LVU593
 2380 007c 2846     		mov	r0, r5
 2381 007e FFF7FEFF 		bl	f_unlink
 2382              	.LVL262:
 2383 0082 8146     		mov	r9, r0
 2384              	.LVL263:
 495:Core/Src/sd.c ****         }
 2385              		.loc 1 495 18 view .LVU594
 2386 0084 E2E7     		b	.L169
 2387              	.LVL264:
 2388              	.L165:
 498:Core/Src/sd.c ****     }
 499:Core/Src/sd.c **** 
 500:Core/Src/sd.c ****     path[--i] = 0;  /* Restore the path name */
 2389              		.loc 1 500 5 is_stmt 1 view .LVU595
 2390              		.loc 1 500 15 is_stmt 0 view .LVU596
 2391 0086 0023     		movs	r3, #0
 2392 0088 88F80030 		strb	r3, [r8]
 501:Core/Src/sd.c ****     f_closedir(&dir);
 2393              		.loc 1 501 5 is_stmt 1 view .LVU597
 2394 008c 6846     		mov	r0, sp
 2395 008e FFF7FEFF 		bl	f_closedir
 2396              	.LVL265:
 502:Core/Src/sd.c **** 
 503:Core/Src/sd.c ****     if (fr == FR_OK) fr = f_unlink(path);  /* Delete the empty directory */
 2397              		.loc 1 503 5 view .LVU598
 2398              		.loc 1 503 8 is_stmt 0 view .LVU599
 2399 0092 B9F1000F 		cmp	r9, #0
 2400 0096 05D0     		beq	.L172
 2401              	.LVL266:
 2402              	.L162:
 504:Core/Src/sd.c ****     return fr;
 505:Core/Src/sd.c **** }
 2403              		.loc 1 505 1 view .LVU600
 2404 0098 4846     		mov	r0, r9
 2405 009a 0DF5815D 		add	sp, sp, #4128
 2406 009e 03B0     		add	sp, sp, #12
 2407              	.LCFI28:
 2408              		.cfi_remember_state
 2409              		.cfi_def_cfa_offset 28
 2410              		@ sp needed
 2411 00a0 BDE8F083 		pop	{r4, r5, r6, r7, r8, r9, pc}
 2412              	.LVL267:
 2413              	.L172:
 2414              	.LCFI29:
 2415              		.cfi_restore_state
 503:Core/Src/sd.c ****     return fr;
 2416              		.loc 1 503 22 is_stmt 1 discriminator 1 view .LVU601
 503:Core/Src/sd.c ****     return fr;
 2417              		.loc 1 503 27 is_stmt 0 discriminator 1 view .LVU602
 2418 00a4 2846     		mov	r0, r5
 2419 00a6 FFF7FEFF 		bl	f_unlink
 2420              	.LVL268:
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 57


 2421 00aa 8146     		mov	r9, r0
 2422              	.LVL269:
 503:Core/Src/sd.c ****     return fr;
 2423              		.loc 1 503 27 discriminator 1 view .LVU603
 2424 00ac F4E7     		b	.L162
 2425              		.cfi_endproc
 2426              	.LFE85:
 2428              		.section	.text.getFileSize,"ax",%progbits
 2429              		.align	1
 2430              		.global	getFileSize
 2431              		.syntax unified
 2432              		.thumb
 2433              		.thumb_func
 2435              	getFileSize:
 2436              	.LVL270:
 2437              	.LFB87:
 506:Core/Src/sd.c **** //-------------------------------------------------- Ham xoa thu muc 
 507:Core/Src/sd.c **** void SD_deleteFolder(char* foldername)
 508:Core/Src/sd.c **** {
 509:Core/Src/sd.c **** 	TCHAR buff[256];
 510:Core/Src/sd.c **** 	if(f_mount(&SDFatFs,(TCHAR const*)USER_Path,0)!=FR_OK)
 511:Core/Src/sd.c **** 	{
 512:Core/Src/sd.c **** 		Error_Handler();
 513:Core/Src/sd.c **** 	}
 514:Core/Src/sd.c **** 	else
 515:Core/Src/sd.c **** 	{
 516:Core/Src/sd.c **** 		char path[50] = {0};
 517:Core/Src/sd.c **** 		strcpy(path,"0:");
 518:Core/Src/sd.c **** 		strcat(path,foldername);
 519:Core/Src/sd.c **** 		res = f_opendir(&dir, path);
 520:Core/Src/sd.c **** 		if (res != FR_OK)
 521:Core/Src/sd.c **** 		{
 522:Core/Src/sd.c **** 			Error_Handler();
 523:Core/Src/sd.c **** 		}
 524:Core/Src/sd.c **** 		else
 525:Core/Src/sd.c **** 		{
 526:Core/Src/sd.c **** 			res = delete_node(path,sizeof(buff),&fileInfo);
 527:Core/Src/sd.c **** 			/* Check the result */
 528:Core/Src/sd.c **** 			if(res == FR_OK)
 529:Core/Src/sd.c **** 			{
 530:Core/Src/sd.c **** 				display("The directory and its contents have successfully been deleted\r\n");
 531:Core/Src/sd.c **** 			}
 532:Core/Src/sd.c **** 			else
 533:Core/Src/sd.c **** 			{
 534:Core/Src/sd.c **** 				display("Failed to delete the directory\r\n");
 535:Core/Src/sd.c **** 			}
 536:Core/Src/sd.c **** 		}
 537:Core/Src/sd.c **** 	}
 538:Core/Src/sd.c **** }
 539:Core/Src/sd.c **** //--------------------------------------------------
 540:Core/Src/sd.c **** int32_t getFileSize(char* filename)
 541:Core/Src/sd.c **** {
 2438              		.loc 1 541 1 is_stmt 1 view -0
 2439              		.cfi_startproc
 2440              		@ args = 0, pretend = 0, frame = 0
 2441              		@ frame_needed = 0, uses_anonymous_args = 0
 2442              		.loc 1 541 1 is_stmt 0 view .LVU605
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 58


 2443 0000 10B5     		push	{r4, lr}
 2444              	.LCFI30:
 2445              		.cfi_def_cfa_offset 8
 2446              		.cfi_offset 4, -8
 2447              		.cfi_offset 14, -4
 2448 0002 0446     		mov	r4, r0
 542:Core/Src/sd.c **** 	int32_t f_size = -1;
 2449              		.loc 1 542 2 is_stmt 1 view .LVU606
 2450              	.LVL271:
 543:Core/Src/sd.c **** 	if(f_mount(&SDFatFs,(TCHAR const*)USER_Path,0)!=FR_OK)
 2451              		.loc 1 543 2 view .LVU607
 2452              		.loc 1 543 5 is_stmt 0 view .LVU608
 2453 0004 0022     		movs	r2, #0
 2454 0006 0E49     		ldr	r1, .L180
 2455 0008 0E48     		ldr	r0, .L180+4
 2456              	.LVL272:
 2457              		.loc 1 543 5 view .LVU609
 2458 000a FFF7FEFF 		bl	f_mount
 2459              	.LVL273:
 2460              		.loc 1 543 4 view .LVU610
 2461 000e 68B9     		cbnz	r0, .L178
 544:Core/Src/sd.c **** 	{ 
 545:Core/Src/sd.c **** 		Error_Handler();
 546:Core/Src/sd.c **** 	}
 547:Core/Src/sd.c **** 	else
 548:Core/Src/sd.c **** 	{
 549:Core/Src/sd.c **** 		if(f_open(&MyFile,filename,FA_READ|FA_OPEN_EXISTING)!=FR_OK)
 2462              		.loc 1 549 3 is_stmt 1 view .LVU611
 2463              		.loc 1 549 6 is_stmt 0 view .LVU612
 2464 0010 0122     		movs	r2, #1
 2465 0012 2146     		mov	r1, r4
 2466 0014 0C48     		ldr	r0, .L180+8
 2467 0016 FFF7FEFF 		bl	f_open
 2468              	.LVL274:
 2469              		.loc 1 549 5 view .LVU613
 2470 001a 60B9     		cbnz	r0, .L179
 550:Core/Src/sd.c **** 		{
 551:Core/Src/sd.c **** 			Error_Handler();
 552:Core/Src/sd.c **** 		}
 553:Core/Src/sd.c **** 		else
 554:Core/Src/sd.c **** 		{
 555:Core/Src/sd.c **** 			f_size = MyFile.fsize;
 2471              		.loc 1 555 4 is_stmt 1 view .LVU614
 2472              		.loc 1 555 19 is_stmt 0 view .LVU615
 2473 001c 0A48     		ldr	r0, .L180+8
 2474 001e 00F58053 		add	r3, r0, #4096
 2475 0022 DC68     		ldr	r4, [r3, #12]
 2476              	.LVL275:
 556:Core/Src/sd.c **** 			f_close(&MyFile);
 2477              		.loc 1 556 4 is_stmt 1 view .LVU616
 2478 0024 FFF7FEFF 		bl	f_close
 2479              	.LVL276:
 557:Core/Src/sd.c **** 		}
 558:Core/Src/sd.c **** 	 }
 559:Core/Src/sd.c **** 	return f_size;
 2480              		.loc 1 559 2 view .LVU617
 2481              	.L173:
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 59


 560:Core/Src/sd.c **** }
 2482              		.loc 1 560 1 is_stmt 0 view .LVU618
 2483 0028 2046     		mov	r0, r4
 2484 002a 10BD     		pop	{r4, pc}
 2485              	.LVL277:
 2486              	.L178:
 545:Core/Src/sd.c **** 	}
 2487              		.loc 1 545 3 is_stmt 1 view .LVU619
 2488 002c FFF7FEFF 		bl	Error_Handler
 2489              	.LVL278:
 542:Core/Src/sd.c **** 	if(f_mount(&SDFatFs,(TCHAR const*)USER_Path,0)!=FR_OK)
 2490              		.loc 1 542 10 is_stmt 0 view .LVU620
 2491 0030 4FF0FF34 		mov	r4, #-1
 2492              	.LVL279:
 542:Core/Src/sd.c **** 	if(f_mount(&SDFatFs,(TCHAR const*)USER_Path,0)!=FR_OK)
 2493              		.loc 1 542 10 view .LVU621
 2494 0034 F8E7     		b	.L173
 2495              	.LVL280:
 2496              	.L179:
 551:Core/Src/sd.c **** 		}
 2497              		.loc 1 551 4 is_stmt 1 view .LVU622
 2498 0036 FFF7FEFF 		bl	Error_Handler
 2499              	.LVL281:
 542:Core/Src/sd.c **** 	if(f_mount(&SDFatFs,(TCHAR const*)USER_Path,0)!=FR_OK)
 2500              		.loc 1 542 10 is_stmt 0 view .LVU623
 2501 003a 4FF0FF34 		mov	r4, #-1
 2502              	.LVL282:
 542:Core/Src/sd.c **** 	if(f_mount(&SDFatFs,(TCHAR const*)USER_Path,0)!=FR_OK)
 2503              		.loc 1 542 10 view .LVU624
 2504 003e F3E7     		b	.L173
 2505              	.L181:
 2506              		.align	2
 2507              	.L180:
 2508 0040 00000000 		.word	USER_Path
 2509 0044 00000000 		.word	SDFatFs
 2510 0048 00000000 		.word	MyFile
 2511              		.cfi_endproc
 2512              	.LFE87:
 2514              		.section	.text.display,"ax",%progbits
 2515              		.align	1
 2516              		.global	display
 2517              		.syntax unified
 2518              		.thumb
 2519              		.thumb_func
 2521              	display:
 2522              	.LVL283:
 2523              	.LFB88:
 561:Core/Src/sd.c **** //--------------------------------------------------
 562:Core/Src/sd.c **** void display(char* data)
 563:Core/Src/sd.c **** {
 2524              		.loc 1 563 1 is_stmt 1 view -0
 2525              		.cfi_startproc
 2526              		@ args = 0, pretend = 0, frame = 0
 2527              		@ frame_needed = 0, uses_anonymous_args = 0
 2528              		.loc 1 563 1 is_stmt 0 view .LVU626
 2529 0000 10B5     		push	{r4, lr}
 2530              	.LCFI31:
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 60


 2531              		.cfi_def_cfa_offset 8
 2532              		.cfi_offset 4, -8
 2533              		.cfi_offset 14, -4
 2534 0002 0446     		mov	r4, r0
 564:Core/Src/sd.c **** 	HAL_UART_Transmit(&huart2, (uint8_t *)data, (uint16_t)strlen(data), 1000);
 2535              		.loc 1 564 2 is_stmt 1 view .LVU627
 2536              		.loc 1 564 56 is_stmt 0 view .LVU628
 2537 0004 FFF7FEFF 		bl	strlen
 2538              	.LVL284:
 2539              		.loc 1 564 2 view .LVU629
 2540 0008 4FF47A73 		mov	r3, #1000
 2541 000c 82B2     		uxth	r2, r0
 2542 000e 2146     		mov	r1, r4
 2543 0010 0148     		ldr	r0, .L184
 2544 0012 FFF7FEFF 		bl	HAL_UART_Transmit
 2545              	.LVL285:
 565:Core/Src/sd.c **** }
 2546              		.loc 1 565 1 view .LVU630
 2547 0016 10BD     		pop	{r4, pc}
 2548              	.LVL286:
 2549              	.L185:
 2550              		.loc 1 565 1 view .LVU631
 2551              		.align	2
 2552              	.L184:
 2553 0018 00000000 		.word	huart2
 2554              		.cfi_endproc
 2555              	.LFE88:
 2557              		.section	.rodata.SD_deleteFolder.str1.4,"aMS",%progbits,1
 2558              		.align	2
 2559              	.LC15:
 2560 0000 303A00   		.ascii	"0:\000"
 2561 0003 00       		.align	2
 2562              	.LC16:
 2563 0004 54686520 		.ascii	"The directory and its contents have successfully be"
 2563      64697265 
 2563      63746F72 
 2563      7920616E 
 2563      64206974 
 2564 0037 656E2064 		.ascii	"en deleted\015\012\000"
 2564      656C6574 
 2564      65640D0A 
 2564      00
 2565              		.align	2
 2566              	.LC17:
 2567 0044 4661696C 		.ascii	"Failed to delete the directory\015\012\000"
 2567      65642074 
 2567      6F206465 
 2567      6C657465 
 2567      20746865 
 2568              		.section	.text.SD_deleteFolder,"ax",%progbits
 2569              		.align	1
 2570              		.global	SD_deleteFolder
 2571              		.syntax unified
 2572              		.thumb
 2573              		.thumb_func
 2575              	SD_deleteFolder:
 2576              	.LVL287:
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 61


 2577              	.LFB86:
 508:Core/Src/sd.c **** 	TCHAR buff[256];
 2578              		.loc 1 508 1 is_stmt 1 view -0
 2579              		.cfi_startproc
 2580              		@ args = 0, pretend = 0, frame = 56
 2581              		@ frame_needed = 0, uses_anonymous_args = 0
 508:Core/Src/sd.c **** 	TCHAR buff[256];
 2582              		.loc 1 508 1 is_stmt 0 view .LVU633
 2583 0000 10B5     		push	{r4, lr}
 2584              	.LCFI32:
 2585              		.cfi_def_cfa_offset 8
 2586              		.cfi_offset 4, -8
 2587              		.cfi_offset 14, -4
 2588 0002 8EB0     		sub	sp, sp, #56
 2589              	.LCFI33:
 2590              		.cfi_def_cfa_offset 64
 2591 0004 0446     		mov	r4, r0
 509:Core/Src/sd.c **** 	if(f_mount(&SDFatFs,(TCHAR const*)USER_Path,0)!=FR_OK)
 2592              		.loc 1 509 2 is_stmt 1 view .LVU634
 510:Core/Src/sd.c **** 	{
 2593              		.loc 1 510 2 view .LVU635
 510:Core/Src/sd.c **** 	{
 2594              		.loc 1 510 5 is_stmt 0 view .LVU636
 2595 0006 0022     		movs	r2, #0
 2596 0008 1A49     		ldr	r1, .L193
 2597 000a 1B48     		ldr	r0, .L193+4
 2598              	.LVL288:
 510:Core/Src/sd.c **** 	{
 2599              		.loc 1 510 5 view .LVU637
 2600 000c FFF7FEFF 		bl	f_mount
 2601              	.LVL289:
 510:Core/Src/sd.c **** 	{
 2602              		.loc 1 510 4 view .LVU638
 2603 0010 18B1     		cbz	r0, .L187
 512:Core/Src/sd.c **** 	}
 2604              		.loc 1 512 3 is_stmt 1 view .LVU639
 2605 0012 FFF7FEFF 		bl	Error_Handler
 2606              	.LVL290:
 2607              	.L186:
 538:Core/Src/sd.c **** //--------------------------------------------------
 2608              		.loc 1 538 1 is_stmt 0 view .LVU640
 2609 0016 0EB0     		add	sp, sp, #56
 2610              	.LCFI34:
 2611              		.cfi_remember_state
 2612              		.cfi_def_cfa_offset 8
 2613              		@ sp needed
 2614 0018 10BD     		pop	{r4, pc}
 2615              	.LVL291:
 2616              	.L187:
 2617              	.LCFI35:
 2618              		.cfi_restore_state
 2619              	.LBB5:
 516:Core/Src/sd.c **** 		strcpy(path,"0:");
 2620              		.loc 1 516 3 is_stmt 1 view .LVU641
 516:Core/Src/sd.c **** 		strcpy(path,"0:");
 2621              		.loc 1 516 8 is_stmt 0 view .LVU642
 2622 001a 0021     		movs	r1, #0
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 62


 2623 001c 0191     		str	r1, [sp, #4]
 2624 001e 2E22     		movs	r2, #46
 2625 0020 02A8     		add	r0, sp, #8
 2626 0022 FFF7FEFF 		bl	memset
 2627              	.LVL292:
 517:Core/Src/sd.c **** 		strcat(path,foldername);
 2628              		.loc 1 517 3 is_stmt 1 view .LVU643
 2629 0026 154B     		ldr	r3, .L193+8
 2630 0028 1B68     		ldr	r3, [r3]
 2631 002a ADF80430 		strh	r3, [sp, #4]	@ movhi
 2632 002e 1B0C     		lsrs	r3, r3, #16
 2633 0030 8DF80630 		strb	r3, [sp, #6]
 518:Core/Src/sd.c **** 		res = f_opendir(&dir, path);
 2634              		.loc 1 518 3 view .LVU644
 2635 0034 2146     		mov	r1, r4
 2636 0036 01A8     		add	r0, sp, #4
 2637 0038 FFF7FEFF 		bl	strcat
 2638              	.LVL293:
 519:Core/Src/sd.c **** 		if (res != FR_OK)
 2639              		.loc 1 519 3 view .LVU645
 519:Core/Src/sd.c **** 		if (res != FR_OK)
 2640              		.loc 1 519 9 is_stmt 0 view .LVU646
 2641 003c 01A9     		add	r1, sp, #4
 2642 003e 1048     		ldr	r0, .L193+12
 2643 0040 FFF7FEFF 		bl	f_opendir
 2644              	.LVL294:
 519:Core/Src/sd.c **** 		if (res != FR_OK)
 2645              		.loc 1 519 7 view .LVU647
 2646 0044 0F4B     		ldr	r3, .L193+16
 2647 0046 1870     		strb	r0, [r3]
 520:Core/Src/sd.c **** 		{
 2648              		.loc 1 520 3 is_stmt 1 view .LVU648
 520:Core/Src/sd.c **** 		{
 2649              		.loc 1 520 6 is_stmt 0 view .LVU649
 2650 0048 10B1     		cbz	r0, .L189
 522:Core/Src/sd.c **** 		}
 2651              		.loc 1 522 4 is_stmt 1 view .LVU650
 2652 004a FFF7FEFF 		bl	Error_Handler
 2653              	.LVL295:
 2654 004e E2E7     		b	.L186
 2655              	.L189:
 526:Core/Src/sd.c **** 			/* Check the result */
 2656              		.loc 1 526 4 view .LVU651
 526:Core/Src/sd.c **** 			/* Check the result */
 2657              		.loc 1 526 10 is_stmt 0 view .LVU652
 2658 0050 0D4A     		ldr	r2, .L193+20
 2659 0052 4FF48071 		mov	r1, #256
 2660 0056 01A8     		add	r0, sp, #4
 2661 0058 FFF7FEFF 		bl	delete_node
 2662              	.LVL296:
 526:Core/Src/sd.c **** 			/* Check the result */
 2663              		.loc 1 526 8 view .LVU653
 2664 005c 094B     		ldr	r3, .L193+16
 2665 005e 1870     		strb	r0, [r3]
 528:Core/Src/sd.c **** 			{
 2666              		.loc 1 528 4 is_stmt 1 view .LVU654
 528:Core/Src/sd.c **** 			{
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 63


 2667              		.loc 1 528 6 is_stmt 0 view .LVU655
 2668 0060 18B9     		cbnz	r0, .L191
 530:Core/Src/sd.c **** 			}
 2669              		.loc 1 530 5 is_stmt 1 view .LVU656
 2670 0062 0A48     		ldr	r0, .L193+24
 2671 0064 FFF7FEFF 		bl	display
 2672              	.LVL297:
 2673 0068 D5E7     		b	.L186
 2674              	.L191:
 534:Core/Src/sd.c **** 			}
 2675              		.loc 1 534 5 view .LVU657
 2676 006a 0948     		ldr	r0, .L193+28
 2677 006c FFF7FEFF 		bl	display
 2678              	.LVL298:
 2679              	.LBE5:
 538:Core/Src/sd.c **** //--------------------------------------------------
 2680              		.loc 1 538 1 is_stmt 0 view .LVU658
 2681 0070 D1E7     		b	.L186
 2682              	.L194:
 2683 0072 00BF     		.align	2
 2684              	.L193:
 2685 0074 00000000 		.word	USER_Path
 2686 0078 00000000 		.word	SDFatFs
 2687 007c 00000000 		.word	.LC15
 2688 0080 00000000 		.word	dir
 2689 0084 00000000 		.word	.LANCHOR3
 2690 0088 00000000 		.word	.LANCHOR5
 2691 008c 04000000 		.word	.LC16
 2692 0090 44000000 		.word	.LC17
 2693              		.cfi_endproc
 2694              	.LFE86:
 2696              		.section	.text.SD_deleteAllFile,"ax",%progbits
 2697              		.align	1
 2698              		.global	SD_deleteAllFile
 2699              		.syntax unified
 2700              		.thumb
 2701              		.thumb_func
 2703              	SD_deleteAllFile:
 2704              	.LFB89:
 566:Core/Src/sd.c **** //---------------------------------------------------
 567:Core/Src/sd.c **** void SD_deleteAllFile(void){
 2705              		.loc 1 567 28 is_stmt 1 view -0
 2706              		.cfi_startproc
 2707              		@ args = 0, pretend = 0, frame = 0
 2708              		@ frame_needed = 0, uses_anonymous_args = 0
 2709 0000 08B5     		push	{r3, lr}
 2710              	.LCFI36:
 2711              		.cfi_def_cfa_offset 8
 2712              		.cfi_offset 3, -8
 2713              		.cfi_offset 14, -4
 568:Core/Src/sd.c **** 	if(f_mount(&SDFatFs,(TCHAR const*)USER_Path,0)!=FR_OK)
 2714              		.loc 1 568 2 view .LVU660
 2715              		.loc 1 568 5 is_stmt 0 view .LVU661
 2716 0002 0022     		movs	r2, #0
 2717 0004 1849     		ldr	r1, .L203
 2718 0006 1948     		ldr	r0, .L203+4
 2719 0008 FFF7FEFF 		bl	f_mount
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 64


 2720              	.LVL299:
 2721              		.loc 1 568 4 view .LVU662
 2722 000c 10B1     		cbz	r0, .L196
 569:Core/Src/sd.c **** 	{
 570:Core/Src/sd.c **** 		Error_Handler();
 2723              		.loc 1 570 3 is_stmt 1 view .LVU663
 2724 000e FFF7FEFF 		bl	Error_Handler
 2725              	.LVL300:
 2726              	.L195:
 571:Core/Src/sd.c **** 	}
 572:Core/Src/sd.c **** 	else
 573:Core/Src/sd.c **** 	{
 574:Core/Src/sd.c **** 		fileInfo.lfname = (char*)sect;
 575:Core/Src/sd.c **** 		fileInfo.lfsize = sizeof(sect);
 576:Core/Src/sd.c **** 		result = f_opendir(&dir, "/");
 577:Core/Src/sd.c **** 		//Liet ke danh sach tep tin co trong sd card
 578:Core/Src/sd.c **** 		if (result == FR_OK)
 579:Core/Src/sd.c **** 		{
 580:Core/Src/sd.c **** 			while(1)
 581:Core/Src/sd.c **** 			{
 582:Core/Src/sd.c **** 				result = f_readdir(&dir, &fileInfo);
 583:Core/Src/sd.c **** 				if (result==FR_OK && fileInfo.fname[0])
 584:Core/Src/sd.c **** 				{
 585:Core/Src/sd.c **** 					fn = fileInfo.lfname; // Pointer to the LFN buffer
 586:Core/Src/sd.c **** 					if(fileInfo.fattrib&AM_DIR)
 587:Core/Src/sd.c **** 					{
 588:Core/Src/sd.c **** 						SD_deleteFolder(fn);
 589:Core/Src/sd.c **** 					}
 590:Core/Src/sd.c **** 					else
 591:Core/Src/sd.c **** 					{
 592:Core/Src/sd.c **** 						SD_deleteFile(fn);
 593:Core/Src/sd.c **** 					}		
 594:Core/Src/sd.c **** 				}
 595:Core/Src/sd.c **** 				else break;
 596:Core/Src/sd.c **** 			}
 597:Core/Src/sd.c **** 			f_closedir(&dir);
 598:Core/Src/sd.c **** 		}
 599:Core/Src/sd.c **** 	}
 600:Core/Src/sd.c **** }
 2727              		.loc 1 600 1 is_stmt 0 view .LVU664
 2728 0012 08BD     		pop	{r3, pc}
 2729              	.L196:
 574:Core/Src/sd.c **** 		fileInfo.lfsize = sizeof(sect);
 2730              		.loc 1 574 3 is_stmt 1 view .LVU665
 574:Core/Src/sd.c **** 		fileInfo.lfsize = sizeof(sect);
 2731              		.loc 1 574 19 is_stmt 0 view .LVU666
 2732 0014 164B     		ldr	r3, .L203+8
 2733 0016 174A     		ldr	r2, .L203+12
 2734 0018 9A61     		str	r2, [r3, #24]
 575:Core/Src/sd.c **** 		result = f_opendir(&dir, "/");
 2735              		.loc 1 575 3 is_stmt 1 view .LVU667
 575:Core/Src/sd.c **** 		result = f_opendir(&dir, "/");
 2736              		.loc 1 575 19 is_stmt 0 view .LVU668
 2737 001a 4FF40072 		mov	r2, #512
 2738 001e DA61     		str	r2, [r3, #28]
 576:Core/Src/sd.c **** 		//Liet ke danh sach tep tin co trong sd card
 2739              		.loc 1 576 3 is_stmt 1 view .LVU669
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 65


 576:Core/Src/sd.c **** 		//Liet ke danh sach tep tin co trong sd card
 2740              		.loc 1 576 12 is_stmt 0 view .LVU670
 2741 0020 1549     		ldr	r1, .L203+16
 2742 0022 1648     		ldr	r0, .L203+20
 2743 0024 FFF7FEFF 		bl	f_opendir
 2744              	.LVL301:
 576:Core/Src/sd.c **** 		//Liet ke danh sach tep tin co trong sd card
 2745              		.loc 1 576 10 view .LVU671
 2746 0028 154B     		ldr	r3, .L203+24
 2747 002a 1870     		strb	r0, [r3]
 578:Core/Src/sd.c **** 		{
 2748              		.loc 1 578 3 is_stmt 1 view .LVU672
 578:Core/Src/sd.c **** 		{
 2749              		.loc 1 578 6 is_stmt 0 view .LVU673
 2750 002c 0028     		cmp	r0, #0
 2751 002e F0D1     		bne	.L195
 2752 0030 01E0     		b	.L198
 2753              	.L200:
 592:Core/Src/sd.c **** 					}		
 2754              		.loc 1 592 7 is_stmt 1 view .LVU674
 2755 0032 FFF7FEFF 		bl	SD_deleteFile
 2756              	.LVL302:
 2757              	.L198:
 580:Core/Src/sd.c **** 			{
 2758              		.loc 1 580 4 view .LVU675
 582:Core/Src/sd.c **** 				if (result==FR_OK && fileInfo.fname[0])
 2759              		.loc 1 582 5 view .LVU676
 582:Core/Src/sd.c **** 				if (result==FR_OK && fileInfo.fname[0])
 2760              		.loc 1 582 14 is_stmt 0 view .LVU677
 2761 0036 0E49     		ldr	r1, .L203+8
 2762 0038 1048     		ldr	r0, .L203+20
 2763 003a FFF7FEFF 		bl	f_readdir
 2764              	.LVL303:
 582:Core/Src/sd.c **** 				if (result==FR_OK && fileInfo.fname[0])
 2765              		.loc 1 582 12 view .LVU678
 2766 003e 104B     		ldr	r3, .L203+24
 2767 0040 1870     		strb	r0, [r3]
 583:Core/Src/sd.c **** 				{
 2768              		.loc 1 583 5 is_stmt 1 view .LVU679
 583:Core/Src/sd.c **** 				{
 2769              		.loc 1 583 8 is_stmt 0 view .LVU680
 2770 0042 68B9     		cbnz	r0, .L199
 583:Core/Src/sd.c **** 				{
 2771              		.loc 1 583 40 discriminator 1 view .LVU681
 2772 0044 0A4B     		ldr	r3, .L203+8
 2773 0046 5B7A     		ldrb	r3, [r3, #9]	@ zero_extendqisi2
 583:Core/Src/sd.c **** 				{
 2774              		.loc 1 583 23 discriminator 1 view .LVU682
 2775 0048 53B1     		cbz	r3, .L199
 585:Core/Src/sd.c **** 					if(fileInfo.fattrib&AM_DIR)
 2776              		.loc 1 585 6 is_stmt 1 view .LVU683
 585:Core/Src/sd.c **** 					if(fileInfo.fattrib&AM_DIR)
 2777              		.loc 1 585 19 is_stmt 0 view .LVU684
 2778 004a 094B     		ldr	r3, .L203+8
 2779 004c 9869     		ldr	r0, [r3, #24]
 585:Core/Src/sd.c **** 					if(fileInfo.fattrib&AM_DIR)
 2780              		.loc 1 585 9 view .LVU685
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 66


 2781 004e 0D4A     		ldr	r2, .L203+28
 2782 0050 1060     		str	r0, [r2]
 586:Core/Src/sd.c **** 					{
 2783              		.loc 1 586 6 is_stmt 1 view .LVU686
 586:Core/Src/sd.c **** 					{
 2784              		.loc 1 586 17 is_stmt 0 view .LVU687
 2785 0052 1B7A     		ldrb	r3, [r3, #8]	@ zero_extendqisi2
 586:Core/Src/sd.c **** 					{
 2786              		.loc 1 586 8 view .LVU688
 2787 0054 13F0100F 		tst	r3, #16
 2788 0058 EBD0     		beq	.L200
 588:Core/Src/sd.c **** 					}
 2789              		.loc 1 588 7 is_stmt 1 view .LVU689
 2790 005a FFF7FEFF 		bl	SD_deleteFolder
 2791              	.LVL304:
 2792 005e EAE7     		b	.L198
 2793              	.L199:
 597:Core/Src/sd.c **** 		}
 2794              		.loc 1 597 4 view .LVU690
 2795 0060 0648     		ldr	r0, .L203+20
 2796 0062 FFF7FEFF 		bl	f_closedir
 2797              	.LVL305:
 2798              		.loc 1 600 1 is_stmt 0 view .LVU691
 2799 0066 D4E7     		b	.L195
 2800              	.L204:
 2801              		.align	2
 2802              	.L203:
 2803 0068 00000000 		.word	USER_Path
 2804 006c 00000000 		.word	SDFatFs
 2805 0070 00000000 		.word	.LANCHOR5
 2806 0074 00000000 		.word	.LANCHOR6
 2807 0078 00000000 		.word	.LC3
 2808 007c 00000000 		.word	dir
 2809 0080 00000000 		.word	.LANCHOR7
 2810 0084 00000000 		.word	.LANCHOR8
 2811              		.cfi_endproc
 2812              	.LFE89:
 2814              		.global	tot_sect
 2815              		.global	fre_sect
 2816              		.global	fre_clust
 2817              		.global	dir
 2818              		.global	fn
 2819              		.global	fileInfo
 2820              		.global	res
 2821              		.global	i
 2822              		.global	result
 2823              		.global	bytesread
 2824              		.global	byteswritten
 2825              		.global	sect
 2826              		.global	str1
 2827              		.global	MyFile
 2828              		.global	fs
 2829              		.global	SDFatFs
 2830              		.global	sdinfo
 2831              		.section	.bss.MyFile,"aw",%nobits
 2832              		.align	2
 2835              	MyFile:
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 67


 2836 0000 00000000 		.space	4140
 2836      00000000 
 2836      00000000 
 2836      00000000 
 2836      00000000 
 2837              		.section	.bss.SDFatFs,"aw",%nobits
 2838              		.align	2
 2841              	SDFatFs:
 2842 0000 00000000 		.space	4144
 2842      00000000 
 2842      00000000 
 2842      00000000 
 2842      00000000 
 2843              		.section	.bss.bytesread,"aw",%nobits
 2844              		.align	2
 2845              		.set	.LANCHOR2,. + 0
 2848              	bytesread:
 2849 0000 00000000 		.space	4
 2850              		.section	.bss.byteswritten,"aw",%nobits
 2851              		.align	2
 2852              		.set	.LANCHOR4,. + 0
 2855              	byteswritten:
 2856 0000 00000000 		.space	4
 2857              		.section	.bss.dir,"aw",%nobits
 2858              		.align	2
 2861              	dir:
 2862 0000 00000000 		.space	4136
 2862      00000000 
 2862      00000000 
 2862      00000000 
 2862      00000000 
 2863              		.section	.bss.fileInfo,"aw",%nobits
 2864              		.align	2
 2865              		.set	.LANCHOR5,. + 0
 2868              	fileInfo:
 2869 0000 00000000 		.space	32
 2869      00000000 
 2869      00000000 
 2869      00000000 
 2869      00000000 
 2870              		.section	.bss.fn,"aw",%nobits
 2871              		.align	2
 2872              		.set	.LANCHOR8,. + 0
 2875              	fn:
 2876 0000 00000000 		.space	4
 2877              		.section	.bss.fre_clust,"aw",%nobits
 2878              		.align	2
 2879              		.set	.LANCHOR10,. + 0
 2882              	fre_clust:
 2883 0000 00000000 		.space	4
 2884              		.section	.bss.fre_sect,"aw",%nobits
 2885              		.align	2
 2886              		.set	.LANCHOR12,. + 0
 2889              	fre_sect:
 2890 0000 00000000 		.space	4
 2891              		.section	.bss.fs,"aw",%nobits
 2892              		.align	2
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 68


 2893              		.set	.LANCHOR9,. + 0
 2896              	fs:
 2897 0000 00000000 		.space	4
 2898              		.section	.bss.i,"aw",%nobits
 2899              		.align	1
 2902              	i:
 2903 0000 0000     		.space	2
 2904              		.section	.bss.res,"aw",%nobits
 2905              		.set	.LANCHOR3,. + 0
 2908              	res:
 2909 0000 00       		.space	1
 2910              		.section	.bss.result,"aw",%nobits
 2911              		.set	.LANCHOR7,. + 0
 2914              	result:
 2915 0000 00       		.space	1
 2916              		.section	.bss.sdinfo,"aw",%nobits
 2917              		.align	2
 2918              		.set	.LANCHOR0,. + 0
 2921              	sdinfo:
 2922 0000 00       		.space	1
 2923              		.section	.bss.sect,"aw",%nobits
 2924              		.align	2
 2925              		.set	.LANCHOR6,. + 0
 2928              	sect:
 2929 0000 00000000 		.space	512
 2929      00000000 
 2929      00000000 
 2929      00000000 
 2929      00000000 
 2930              		.section	.bss.str1,"aw",%nobits
 2931              		.align	2
 2932              		.set	.LANCHOR1,. + 0
 2935              	str1:
 2936 0000 00000000 		.space	60
 2936      00000000 
 2936      00000000 
 2936      00000000 
 2936      00000000 
 2937              		.section	.bss.tot_sect,"aw",%nobits
 2938              		.align	2
 2939              		.set	.LANCHOR11,. + 0
 2942              	tot_sect:
 2943 0000 00000000 		.space	4
 2944              		.text
 2945              	.Letext0:
 2946              		.file 2 "d:\\10 2021.10\\arm-none-eabi\\include\\machine\\_default_types.h"
 2947              		.file 3 "d:\\10 2021.10\\arm-none-eabi\\include\\sys\\_stdint.h"
 2948              		.file 4 "Drivers/CMSIS/Device/ST/STM32F1xx/Include/stm32f103xe.h"
 2949              		.file 5 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_hal_def.h"
 2950              		.file 6 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_hal_gpio.h"
 2951              		.file 7 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_hal_dma.h"
 2952              		.file 8 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_hal_spi.h"
 2953              		.file 9 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_hal_uart.h"
 2954              		.file 10 "Middlewares/Third_Party/FatFs/src/integer.h"
 2955              		.file 11 "Middlewares/Third_Party/FatFs/src/ff.h"
 2956              		.file 12 "Core/Inc/sd.h"
 2957              		.file 13 "<built-in>"
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 69


 2958              		.file 14 "Core/Inc/main.h"
 2959              		.file 15 "d:\\10 2021.10\\arm-none-eabi\\include\\string.h"
 2960              		.file 16 "Middlewares/Third_Party/FatFs/src/ff_gen_drv.h"
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 70


DEFINED SYMBOLS
                            *ABS*:00000000 sd.c
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:18     .text.Error:00000000 $t
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:23     .text.Error:00000000 Error
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:47     .text.Error:00000010 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:52     .text.SPIx_WriteRead:00000000 $t
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:58     .text.SPIx_WriteRead:00000000 SPIx_WriteRead
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:112    .text.SPIx_WriteRead:00000038 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:117    .text.SPI_SendByte:00000000 $t
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:123    .text.SPI_SendByte:00000000 SPI_SendByte
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:145    .text.SPI_ReceiveByte:00000000 $t
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:151    .text.SPI_ReceiveByte:00000000 SPI_ReceiveByte
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:174    .text.SD_cmd:00000000 $t
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:179    .text.SD_cmd:00000000 SD_cmd
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:318    .text.SD_cmd:0000008c $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:323    .text.SPI_Release:00000000 $t
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:329    .text.SPI_Release:00000000 SPI_Release
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:350    .text.SPI_wait_ready:00000000 $t
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:356    .text.SPI_wait_ready:00000000 SPI_wait_ready
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:416    .text.SD_PowerOn:00000000 $t
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:422    .text.SD_PowerOn:00000000 SD_PowerOn
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:450    .text.SD_PowerOn:00000014 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:455    .text.SD_Read_Block:00000000 $t
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:461    .text.SD_Read_Block:00000000 SD_Read_Block
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:574    .text.SD_Write_Block:00000000 $t
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:580    .text.SD_Write_Block:00000000 SD_Write_Block
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:709    .rodata.sd_ini.str1.4:00000000 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:716    .text.sd_ini:00000000 $t
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:722    .text.sd_ini:00000000 sd_ini
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:1134   .text.sd_ini:000001c4 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:1146   .rodata.ReadLongFile.str1.4:00000000 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:1150   .text.ReadLongFile:00000000 $t
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:1156   .text.ReadLongFile:00000000 ReadLongFile
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:1286   .text.ReadLongFile:00000080 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2835   .bss.MyFile:00000000 MyFile
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:1297   .text.SD_Write_File:00000000 $t
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:1303   .text.SD_Write_File:00000000 SD_Write_File
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:1409   .text.SD_Write_File:00000070 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2841   .bss.SDFatFs:00000000 SDFatFs
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:1418   .text.SD_Read_File:00000000 $t
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:1424   .text.SD_Read_File:00000000 SD_Read_File
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:1484   .text.SD_Read_File:00000038 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:1492   .rodata.SD_List_File.str1.4:00000000 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:1502   .text.SD_List_File:00000000 $t
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:1508   .text.SD_List_File:00000000 SD_List_File
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:1653   .text.SD_List_File:000000b0 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2861   .bss.dir:00000000 dir
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:1669   .rodata.SD_Amount_Space.str1.4:00000000 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:1689   .text.SD_Amount_Space:00000000 $t
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:1695   .text.SD_Amount_Space:00000000 SD_Amount_Space
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:1873   .text.SD_Amount_Space:00000110 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:1891   .text._ReadLongFile:00000000 $t
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:1897   .text._ReadLongFile:00000000 _ReadLongFile
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:1934   .text._ReadLongFile:0000001c $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:1941   .text._SD_Read_File:00000000 $t
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:1947   .text._SD_Read_File:00000000 _SD_Read_File
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2017   .text._SD_Read_File:00000040 $d
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 71


C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2025   .text.SD_creatSubDir:00000000 $t
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2031   .text.SD_creatSubDir:00000000 SD_creatSubDir
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2103   .text.SD_creatSubDir:00000044 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2111   .rodata.SD_deleteFile.str1.4:00000000 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2121   .text.SD_deleteFile:00000000 $t
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2127   .text.SD_deleteFile:00000000 SD_deleteFile
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2223   .text.SD_deleteFile:00000068 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2234   .text.delete_node:00000000 $t
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2240   .text.delete_node:00000000 delete_node
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2429   .text.getFileSize:00000000 $t
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2435   .text.getFileSize:00000000 getFileSize
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2508   .text.getFileSize:00000040 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2515   .text.display:00000000 $t
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2521   .text.display:00000000 display
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2553   .text.display:00000018 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2558   .rodata.SD_deleteFolder.str1.4:00000000 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2569   .text.SD_deleteFolder:00000000 $t
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2575   .text.SD_deleteFolder:00000000 SD_deleteFolder
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2685   .text.SD_deleteFolder:00000074 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2697   .text.SD_deleteAllFile:00000000 $t
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2703   .text.SD_deleteAllFile:00000000 SD_deleteAllFile
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2803   .text.SD_deleteAllFile:00000068 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2942   .bss.tot_sect:00000000 tot_sect
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2889   .bss.fre_sect:00000000 fre_sect
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2882   .bss.fre_clust:00000000 fre_clust
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2875   .bss.fn:00000000 fn
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2868   .bss.fileInfo:00000000 fileInfo
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2908   .bss.res:00000000 res
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2902   .bss.i:00000000 i
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2914   .bss.result:00000000 result
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2848   .bss.bytesread:00000000 bytesread
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2855   .bss.byteswritten:00000000 byteswritten
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2928   .bss.sect:00000000 sect
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2935   .bss.str1:00000000 str1
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2896   .bss.fs:00000000 fs
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2921   .bss.sdinfo:00000000 sdinfo
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2832   .bss.MyFile:00000000 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2838   .bss.SDFatFs:00000000 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2844   .bss.bytesread:00000000 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2851   .bss.byteswritten:00000000 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2858   .bss.dir:00000000 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2864   .bss.fileInfo:00000000 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2871   .bss.fn:00000000 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2878   .bss.fre_clust:00000000 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2885   .bss.fre_sect:00000000 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2892   .bss.fs:00000000 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2899   .bss.i:00000000 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2909   .bss.res:00000000 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2915   .bss.result:00000000 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2917   .bss.sdinfo:00000000 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2924   .bss.sect:00000000 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2931   .bss.str1:00000000 $d
C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s:2938   .bss.tot_sect:00000000 $d

UNDEFINED SYMBOLS
HAL_GPIO_WritePin
HAL_SPI_TransmitReceive
ARM GAS  C:\Users\Admin\AppData\Local\Temp\cccoKkMt.s 			page 72


hspi1
Timer1
HAL_SPI_Init
sprintf
strlen
HAL_UART_Transmit
huart2
f_lseek
f_read
SD
f_mount
Error_Handler
f_open
f_write
f_close
USER_Path
f_opendir
f_readdir
f_closedir
f_getfree
FATFS_UnLinkDriver
f_stat
f_mkdir
f_unlink
memset
strcat
